(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    733413,      17011]
NotebookOptionsPosition[    666115,      15918]
NotebookOutlinePosition[    666506,      15934]
CellTagsIndexPosition[    666463,      15931]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["UniversalQComplier Examples File", "Chapter",
 CellChangeTimes->{{3.757504529905611*^9, 
  3.757504543941271*^9}},ExpressionUUID->"9063663a-367d-44c8-af38-\
2a5fd81be394"],

Cell[CellGroupData[{

Cell["Basic Gate types", "Subsection",
 CellChangeTimes->{{3.759143803408662*^9, 
  3.759143821525689*^9}},ExpressionUUID->"88dceb0a-7dc2-427b-9785-\
7fbeb71309c5"],

Cell["\<\
This package decomposes arbitrary gates into a sequence of CNOTs and single \
qubit rotations. The latter are expressed using the convention that an \
rotation by angle t about the x-axis of the Bloch sphere is\
\>", "Text",
 CellChangeTimes->{{3.757504829038189*^9, 3.757504869429008*^9}, {
  3.757513275714047*^9, 
  3.757513321267272*^9}},ExpressionUUID->"d6619dca-8d9f-461a-b855-\
1dcd3a5197cc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RxM", "[", 
   RowBox[{"t", ",", "1"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.757504871907605*^9, 3.757504909245626*^9}, {
  3.757504958970851*^9, 3.757504964803595*^9}, {3.757513244526589*^9, 
  3.757513265185267*^9}, {3.757513355555419*^9, 3.757513356819161*^9}, {
  3.758114277242445*^9, 3.75811428178724*^9}},
 CellLabel->
  "In[445]:=",ExpressionUUID->"7487ee14-7d02-4963-a3b0-27ca720f6188"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["t", "2"], "]"}], 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Sin", "[", 
        FractionBox["t", "2"], "]"}]}]},
     {
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Sin", "[", 
        FractionBox["t", "2"], "]"}]}], 
      RowBox[{"Cos", "[", 
       FractionBox["t", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7575132549561167`*^9, 3.757513265525028*^9}, 
   3.757513357110689*^9, 3.757513655801825*^9, 3.757513702623666*^9, 
   3.757517154873425*^9, 3.7575262976704617`*^9, 3.757526336183362*^9, 
   3.75752667830544*^9, 3.757526844010173*^9, 3.757527849155684*^9, 
   3.7575338312768393`*^9, 3.757534366900606*^9, 3.7575344920977697`*^9, 
   3.757534815066205*^9, 3.757581455001294*^9, 3.757607585715403*^9, 
   3.757607725139042*^9, 3.757610004561208*^9, 3.757611689603175*^9, 
   3.757611774738661*^9, 3.7576119324172277`*^9, {3.757689893958885*^9, 
   3.757689922695703*^9}, 3.757689974892219*^9, 3.757690022374824*^9, 
   3.757690095107273*^9, 3.757690217127198*^9, {3.757690283959412*^9, 
   3.757690335879587*^9}, 3.757692811885491*^9, 3.7577134115207*^9, {
   3.7581142784884977`*^9, 3.758114282677902*^9}, 3.7581265354411716`*^9, 
   3.7581265677647457`*^9, {3.75812660565731*^9, 3.75812664384415*^9}, {
   3.758126673977726*^9, 3.75812670036901*^9}, 3.758126742991681*^9, 
   3.758127157239091*^9, 3.758127378889371*^9, 3.758128681175984*^9, 
   3.758175549635605*^9, 3.759224741528645*^9, 3.75929165827533*^9, 
   3.759293737406127*^9, 3.759296899123598*^9, 3.7593121674883327`*^9, {
   3.7593739568017797`*^9, 3.759373958413603*^9}, 3.759375909294128*^9, 
   3.759385817056126*^9, 3.7594044583249197`*^9, 3.759405619679304*^9, 
   3.759407971758891*^9, 3.7594091739968653`*^9, 3.759472812549388*^9, 
   3.7606922068185177`*^9, 3.764327469498538*^9, 3.7647821803878803`*^9, 
   3.764782788677397*^9, 3.764783118335924*^9, 3.814868365939745*^9},
 CellLabel->
  "Out[445]//MatrixForm=",ExpressionUUID->"f211be77-3dfd-4fc8-9b54-\
3c12964fa01d"]
}, Open  ]],

Cell["A y-rotation by angle t is:", "Text",
 CellChangeTimes->{{3.757513285348769*^9, 
  3.757513298669304*^9}},ExpressionUUID->"ef020c9f-99e5-4518-9a03-\
bb15c05509ea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RyM", "[", 
   RowBox[{"t", ",", "1"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.757513339057673*^9, 3.757513352211108*^9}, {
  3.7581142909154787`*^9, 3.7581142990130663`*^9}},
 CellLabel->
  "In[446]:=",ExpressionUUID->"23228d1d-05cd-4c72-82b7-201b5a5b35d3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["t", "2"], "]"}], 
      RowBox[{"Sin", "[", 
       FractionBox["t", "2"], "]"}]},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["t", "2"], "]"}]}], 
      RowBox[{"Cos", "[", 
       FractionBox["t", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.757513334290288*^9, 3.757513352407934*^9}, 
   3.757513655840869*^9, 3.757513702660377*^9, 3.757517154908848*^9, 
   3.7575262976955633`*^9, 3.757526336212956*^9, 3.757526678330559*^9, 
   3.75752684403999*^9, 3.757527849180838*^9, 3.757533831368507*^9, 
   3.757534366985379*^9, 3.7575344921352787`*^9, 3.757534815115787*^9, 
   3.7575814550532227`*^9, 3.757607585766614*^9, 3.757607725175296*^9, 
   3.7576100045861597`*^9, 3.7576116896319647`*^9, 3.7576117748381357`*^9, 
   3.757611932468203*^9, {3.757689894008359*^9, 3.757689922726506*^9}, 
   3.757689974925001*^9, 3.757690022404687*^9, 3.75769009513093*^9, 
   3.7576902171549997`*^9, {3.757690283989684*^9, 3.757690335912517*^9}, 
   3.757692811902342*^9, 3.7577134115351753`*^9, {3.758114296306423*^9, 
   3.7581142992086983`*^9}, 3.7581265354653187`*^9, 3.7581265678191957`*^9, {
   3.7581266056822357`*^9, 3.7581266438707247`*^9}, {3.7581266740041428`*^9, 
   3.758126700396317*^9}, 3.758126743012398*^9, 3.7581271572635*^9, 
   3.7581273789130573`*^9, 3.758128681195381*^9, 3.758175549725934*^9, 
   3.759224741618351*^9, 3.759291658293406*^9, 3.759293737421158*^9, 
   3.759296899142795*^9, 3.7593121676137037`*^9, 3.759373958646587*^9, 
   3.759375909438794*^9, 3.75938581711534*^9, 3.759404458342757*^9, 
   3.7594056198087997`*^9, 3.7594079717868557`*^9, 3.759409174039475*^9, 
   3.7594728126095533`*^9, 3.7606922068272953`*^9, 3.76432746957664*^9, 
   3.7647821804081182`*^9, 3.764782788700758*^9, 3.76478311836663*^9, 
   3.814868367037593*^9},
 CellLabel->
  "Out[446]//MatrixForm=",ExpressionUUID->"9b50aaec-8320-4181-ba94-\
23124ea0be96"]
}, Open  ]],

Cell["And a z-rotation is", "Text",
 CellChangeTimes->{{3.757504971877866*^9, 3.7575049844651337`*^9}, 
   3.757513332369804*^9, {3.75751336288623*^9, 
   3.757513368732534*^9}},ExpressionUUID->"e565f3ae-8666-4258-a2ce-\
812a8bae4d07"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RzM", "[", 
   RowBox[{"t", ",", "1"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.757504998507731*^9, 3.757505037835672*^9}, {
  3.757513373286056*^9, 3.757513379881426*^9}, {3.758114303010721*^9, 
  3.75811430590427*^9}},
 CellLabel->
  "In[447]:=",ExpressionUUID->"e853e9ab-c416-4da2-a2c8-75cb38e1e592"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "t"}], "2"]], "0"},
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "t"}], "2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7575133801608677`*^9, 3.757513655865144*^9, 3.757513702691865*^9, 
   3.757517154939928*^9, 3.757526297715459*^9, 3.757526336241185*^9, 
   3.75752667835456*^9, 3.757526844069133*^9, 3.757527849188551*^9, 
   3.757533831394472*^9, 3.757534367016922*^9, 3.75753449215795*^9, 
   3.7575348151510773`*^9, 3.757581455078669*^9, 3.7576075857911787`*^9, 
   3.757607725206356*^9, 3.757610004610217*^9, 3.757611689658827*^9, 
   3.757611774873176*^9, 3.757611932505772*^9, {3.7576898940263977`*^9, 
   3.757689922748598*^9}, 3.757689974947597*^9, 3.75769002240983*^9, 
   3.7576900951489487`*^9, 3.757690217175551*^9, {3.757690284012156*^9, 
   3.757690335946916*^9}, 3.75769281192135*^9, 3.757713411550139*^9, 
   3.758114306114684*^9, 3.758126535489171*^9, 3.758126567838592*^9, {
   3.758126605701063*^9, 3.7581266438925533`*^9}, {3.758126674026992*^9, 
   3.758126700419771*^9}, 3.7581267430286503`*^9, 3.758127157281692*^9, 
   3.758127378931501*^9, 3.758128681211157*^9, 3.758175549751671*^9, 
   3.7592247416745243`*^9, 3.7592916583063097`*^9, 3.75929373743568*^9, 
   3.7592968991602097`*^9, 3.759312167660495*^9, 3.759373958691264*^9, 
   3.759375909488934*^9, 3.759385817179493*^9, 3.759404458360402*^9, 
   3.759405619829617*^9, 3.759407971809849*^9, 3.75940917406618*^9, 
   3.7594728126375027`*^9, 3.760692206903882*^9, 3.76432746965841*^9, 
   3.7647821804237213`*^9, 3.764782788718733*^9, 3.764783118376464*^9, 
   3.814868367914995*^9},
 CellLabel->
  "Out[447]//MatrixForm=",ExpressionUUID->"3b779d1d-a890-4734-a42f-\
86985acab3ba"]
}, Open  ]],

Cell["A CNOT with qubit 1 as the control and 2 as the target is", "Text",
 CellChangeTimes->{{3.7591437407680063`*^9, 
  3.759143762679596*^9}},ExpressionUUID->"8e9913a8-39e6-4979-b871-\
10085019a5fc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CNOTM", "[", 
   RowBox[{"1", ",", "2"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.759143680961896*^9, 3.759143686648862*^9}, {
  3.759143765471484*^9, 3.7591437862333927`*^9}},
 CellLabel->
  "In[444]:=",ExpressionUUID->"82ff8054-3b7d-4650-877b-e786c92d9425"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7591437805936337`*^9, 3.759143787245964*^9}, 
   3.759224741693907*^9, 3.759291658318748*^9, 3.7592937374499283`*^9, 
   3.7592968991767693`*^9, 3.759312167726346*^9, 3.759373958746407*^9, 
   3.7593759095567827`*^9, 3.759385817229068*^9, 3.759404458380122*^9, 
   3.759405619852148*^9, 3.759407971831756*^9, 3.759409174091289*^9, 
   3.759472812642911*^9, 3.760692206981934*^9, 3.764327469734727*^9, 
   3.764782180438567*^9, 3.76478278873703*^9, 3.764783118386319*^9, 
   3.814868361468842*^9},
 CellLabel->
  "Out[444]//MatrixForm=",ExpressionUUID->"1122b958-a92c-423c-9406-\
6f258d567c07"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Single-qubit unitaries", "Subsection"]], \
"Subsubsection",
 CellChangeTimes->{{3.759143830805934*^9, 3.759143834445278*^9}, {
  3.7591443150771227`*^9, 3.759144324380033*^9}, {3.759224748829812*^9, 
  3.7592247514370193`*^9}},ExpressionUUID->"8694a574-2fa8-4015-ad4a-\
6f18ac21ea52"],

Cell["\<\
Choose a random 2x2 unitary and decompose it into a Z rotation, a Y rotation \
then a Z rotation\
\>", "Text",
 CellChangeTimes->{{3.75750457836036*^9, 
  3.757504654509059*^9}},ExpressionUUID->"a42672a6-8629-4eb7-afa4-\
efcc17a240c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"u", "=", 
  RowBox[{"PickRandomUnitary", "[", "2", "]"}]}]], "Input",
 CellChangeTimes->{{3.7575045978429813`*^9, 
  3.7575046109584093`*^9}},ExpressionUUID->"66dde00c-d6da-4947-84ce-\
00f1a497a624"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.35917032060122284`"}], "-", 
      RowBox[{"0.5483120963400434`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5362115951132621`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.5318154295171332`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.18488343626889753`"}], "+", 
      RowBox[{"0.7322353725406922`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.6547844880926464`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.03011226240004901`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.757504611400702*^9, 3.757513655890295*^9, 3.75751370272362*^9, 
   3.7575171549688063`*^9, 3.757526297744891*^9, 3.757526336270842*^9, 
   3.7575266783789797`*^9, 3.757526844098846*^9, 3.757527849212769*^9, 
   3.7575294616540337`*^9, 3.7575338314195223`*^9, 3.757534367046382*^9, 
   3.757534492182832*^9, 3.7575346861533318`*^9, 3.757534815188137*^9, 
   3.757581455104692*^9, 3.757607585816696*^9, 3.757607725234975*^9, 
   3.757610004633389*^9, 3.757611689666071*^9, 3.757611774909404*^9, 
   3.757611932544805*^9, {3.757689894030911*^9, 3.757689922755375*^9}, 
   3.757689974952298*^9, 3.757690022437504*^9, 3.757690095168292*^9, 
   3.7576902171809072`*^9, {3.757690284017042*^9, 3.757690335974535*^9}, 
   3.757692811937447*^9, 3.757713411566841*^9, 3.758114309061244*^9, 
   3.758126535512491*^9, 3.758126567858594*^9, {3.758126605720908*^9, 
   3.758126643914447*^9}, {3.758126674050899*^9, 3.758126700443437*^9}, 
   3.758126743044888*^9, 3.758127157300714*^9, 3.7581273789520807`*^9, 
   3.7581286812269373`*^9, 3.758175549777048*^9, 3.759143863987774*^9, 
   3.7592247417782497`*^9, 3.7592916583310137`*^9, 3.7592937374645157`*^9, 
   3.759296899192665*^9, 3.759312167806456*^9, 3.759373958790691*^9, 
   3.7593741078696613`*^9, 3.7593759096407013`*^9, 3.759385817280566*^9, 
   3.7594044583984547`*^9, 3.759405136477265*^9, 3.7594056198747387`*^9, 
   3.759407971852984*^9, 3.759409174116345*^9, 3.759472812668219*^9, 
   3.7606922070566473`*^9, 3.764327469810787*^9, 3.764782180452817*^9, 
   3.764782788757588*^9, 
   3.764783118395578*^9},ExpressionUUID->"7836cb3b-6b43-4103-acb1-\
c1062959ccc1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"ZYZDec", "[", "u", "]"}]}]], "Input",
 CellChangeTimes->{{3.759143858892935*^9, 3.7591438620482283`*^9}, {
   3.759143905709166*^9, 3.759143907692178*^9}, 3.759143981871148*^9, 
   3.7630376485440683`*^9},ExpressionUUID->"f15db461-118f-464f-b573-\
cd29775aaf93"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "4.913755828160458`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.7119658015978798`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.455947604330544`", ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.759143982347248*^9, 3.7592247418517847`*^9, 
  3.7592916583438797`*^9, 3.759293737480336*^9, 3.7592968992101593`*^9, 
  3.759312167877099*^9, 3.759373958845868*^9, 3.759375909723428*^9, 
  3.759385817329275*^9, 3.759404458417562*^9, 3.759405619897214*^9, 
  3.759407971874509*^9, 3.75940917414215*^9, 3.759472812696842*^9, 
  3.760692207135292*^9, 3.7643274698851643`*^9, 3.764782180468348*^9, 
  3.764782788777864*^9, 
  3.764783118404811*^9},ExpressionUUID->"9001ee4a-b2bc-487f-9941-\
93d94ec49824"]
}, Open  ]],

Cell["\<\
This is the standard form for gate outputs. The first gate in the list is an \
Rz on qubit 1, etc.  We can construct the unitary from these (up to phase) as \
follows. To get a reminder of the conventions, use GateTypes[]\
\>", "Text",
 CellChangeTimes->{{3.757506090720849*^9, 3.7575061687263813`*^9}, {
   3.75750620310247*^9, 3.757506210599783*^9}, {3.757607643539291*^9, 
   3.7576076618249063`*^9}, {3.75914402697755*^9, 3.759144037089456*^9}, {
   3.7593740208263283`*^9, 3.759374021263846*^9}, {3.759374523054968*^9, 
   3.7593745242378473`*^9}, 
   3.759374587218397*^9},ExpressionUUID->"fd029955-edc5-4e5d-96e3-\
dbc29b14d963"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GateTypes", "[", "]"}]], "Input",ExpressionUUID->"493bdfec-3026-4646-ad01-29f77da02757"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Gate types for UniversalQCompiler\"\>"], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.76478311841722*^9},ExpressionUUID->"e7b8753e-59fe-4981-bfeb-eec277920c03"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "2"}], 
   "\[InvisibleSpace]", "\<\",diag,act}: diagonal gate with entries diag on \
the qubits listed in act\"\>"}],
  SequenceForm[
  "{", -2, ",diag,act}: diagonal gate with entries diag on the qubits listed \
in act"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.764783118418626*^9},ExpressionUUID->"9894b4e4-dace-4400-99e8-\
3c456a461cb3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1"}], 
   "\[InvisibleSpace]", "\<\",n,m}: CZ with qubit n the control and m the \
target\"\>"}],
  SequenceForm["{", -1, ",n,m}: CZ with qubit n the control and m the target"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.7647831184200773`*^9},ExpressionUUID->"dcccdd50-9f83-4a55-8ad9-\
64297dc9ec23"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\",n,m}: CNOT with qubit n the control and m the \
target\"\>"}],
  SequenceForm[
  "{", 0, ",n,m}: CNOT with qubit n the control and m the target"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.764783118421298*^9},ExpressionUUID->"61141e5f-b038-4b51-b581-\
a62ae0a07e57"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",t,n}: x-rotation by angle t for qubit n\"\>"}],
  SequenceForm["{", 1, ",t,n}: x-rotation by angle t for qubit n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.764783118422325*^9},ExpressionUUID->"cf0eb9fa-ed25-40d9-a725-\
9d14e0e8163d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",t,n}: y-rotation by angle t for qubit n\"\>"}],
  SequenceForm["{", 2, ",t,n}: y-rotation by angle t for qubit n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.7647831184232693`*^9},ExpressionUUID->"28b3083b-bf93-47c4-9e90-\
694e65ba126e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",t,n}: z-rotation by angle t for qubit n\"\>"}],
  SequenceForm["{", 3, ",t,n}: z-rotation by angle t for qubit n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.764783118424219*^9},ExpressionUUID->"67ce96d7-65f4-4d13-9969-\
f5d0745578a6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",0,n}: trace out qubit n\"\>"}],
  SequenceForm["{", 4, ",0,n}: trace out qubit n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.7647831184252787`*^9},ExpressionUUID->"a9049cdb-0709-4ab9-9ff3-\
51b32cda8994"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",1,n}: measure qubit n in the computational \
basis\"\>"}],
  SequenceForm["{", 4, ",1,n}: measure qubit n in the computational basis"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.764783118426313*^9},ExpressionUUID->"f8eae8c6-c79f-4af7-84b9-\
10ce10fdfc5d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",0,n}: qubit n starts in state |0>\"\>"}],
  SequenceForm["{", 5, ",0,n}: qubit n starts in state |0>"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.764783118427423*^9},ExpressionUUID->"092b70c4-5477-46d0-a5df-\
2d0dc0777e8a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",1,n}: qubit n starts in state |1>\"\>"}],
  SequenceForm["{", 5, ",1,n}: qubit n starts in state |1>"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.764783118429102*^9},ExpressionUUID->"61101839-fd08-4b7c-a960-\
8b9383c81a58"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",0,n}: qubit n is postselected on |0>\"\>"}],
  SequenceForm["{", 6, ",0,n}: qubit n is postselected on |0>"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.7647831184306707`*^9},ExpressionUUID->"bd1be1ca-72b5-4ce2-94cc-\
2156545e4657"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",1,n}: qubit n is postselected on |1>\"\>"}],
  SequenceForm["{", 6, ",1,n}: qubit n is postselected on |1>"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.764783118432104*^9},ExpressionUUID->"ddf07465-abef-40b7-ab4f-\
46da25e43752"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "10"}], 
   "\[InvisibleSpace]", "\<\",t,{n,m}}: XX-gate with angle t on qubits \
n,m\"\>"}],
  SequenceForm["{", -10, ",t,{n,m}}: XX-gate with angle t on qubits n,m"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.764783118433278*^9},ExpressionUUID->"9de88cdf-a651-4d26-98ca-\
096eb5cf8f25"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"{\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "11"}], 
   "\[InvisibleSpace]", "\<\",{t,p},n}: R-gate with angles t,p on qubit \
n\"\>"}],
  SequenceForm["{", -11, ",{t,p},n}: R-gate with angles t,p on qubit n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.759291658357135*^9, 3.759293737496438*^9, 
  3.7592968992166643`*^9, 3.7593121679411163`*^9, 3.759373958909511*^9, 
  3.759375909808208*^9, 3.759385817380372*^9, 3.7594044584409313`*^9, 
  3.7594056199236507`*^9, 3.759407971898329*^9, 3.759409174169392*^9, 
  3.7594728127035933`*^9, 3.7606922072067213`*^9, 3.7643274699633493`*^9, 
  3.764782180485005*^9, 3.7647827887986403`*^9, 
  3.764783118434325*^9},ExpressionUUID->"e6d4c77d-15e8-4eb5-9871-\
6d0033207f94"]
}, Open  ]]
}, Open  ]],

Cell["\<\
Confirm the result (note that decompositions are always up to phase)\
\>", "Text",
 CellChangeTimes->{{3.757504752351391*^9, 3.757504755599193*^9}, {
  3.759143918515605*^9, 
  3.759143930243575*^9}},ExpressionUUID->"dcfced5a-2ebe-4674-b1d0-\
eda08080a0f4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"outu", "=", 
  RowBox[{"CreateOperationFromGateList", "[", "gates", "]"}]}]], "Input",
 CellChangeTimes->{{3.759143940563486*^9, 3.759143941755369*^9}, {
   3.7591441084647503`*^9, 3.7591441092637377`*^9}, 
   3.761712732366712*^9},ExpressionUUID->"c16ce974-77ac-4956-b830-\
0074c6bb9f4e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.29829465462738547`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.5836692327117534`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.727633574415562`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.20223725470257545`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.727633574415562`"}], "+", 
      RowBox[{"0.20223725470257545`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.29829465462738547`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.5836692327117534`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.759143943667492*^9, 3.7592247419478273`*^9, 
  3.759291658378539*^9, 3.759293737523376*^9, 3.7592968992426033`*^9, 
  3.759312168122308*^9, 3.7593739594050083`*^9, 3.759375910140257*^9, 
  3.759385817580181*^9, 3.75940445846949*^9, 3.759405619960153*^9, 
  3.75940797192857*^9, 3.759409174207258*^9, 3.759472812744795*^9, 
  3.760692207247097*^9, 3.764327470061767*^9, 3.76478218051635*^9, 
  3.76478278884223*^9, 
  3.764783118446603*^9},ExpressionUUID->"ff23feca-e738-495f-aad7-\
3503d3cd5c36"]
}, Open  ]],

Cell["This is equal to u up to phase:", "Text",
 CellChangeTimes->{{3.757506218021734*^9, 
  3.757506231727025*^9}},ExpressionUUID->"461778f3-d9b4-483c-8aa9-\
56544050c887"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"outu", "/", 
     RowBox[{"outu", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
    RowBox[{"u", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "u"}], "]"}]], "Input",
 CellChangeTimes->{{3.757504758668923*^9, 3.757504778067955*^9}, {
  3.757505074400775*^9, 3.757505099184412*^9}, {3.757513397098743*^9, 
  3.7575134171250763`*^9}, {3.758114317514697*^9, 3.7581143332196617`*^9}, {
  3.7591438821971684`*^9, 3.759143910556131*^9}, {3.75914394892474*^9, 
  3.759143962426612*^9}, {3.759144111761479*^9, 
  3.7591441138230658`*^9}},ExpressionUUID->"40bb3936-4a57-41a1-a306-\
fdd0b6622e33"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7575050881096067`*^9, 3.7575050995418987`*^9}, 
   3.7575136559380083`*^9, 3.7575137027823763`*^9, 3.757517155030711*^9, 
   3.7575262978008347`*^9, 3.757526336330703*^9, 3.7575266784260387`*^9, 
   3.757526844159245*^9, 3.7575278492570343`*^9, 3.7575338314675093`*^9, 
   3.757534367112227*^9, 3.75753449222898*^9, 3.7575348152607317`*^9, 
   3.757581455137092*^9, 3.757607585867847*^9, 3.757607725295507*^9, 
   3.757610004680952*^9, 3.757611689719672*^9, 3.757611774980304*^9, 
   3.757611932619985*^9, {3.757689894068449*^9, 3.757689922803647*^9}, 
   3.757689974999875*^9, 3.757690022478183*^9, 3.757690095204907*^9, 
   3.7576902172298107`*^9, {3.757690284059057*^9, 3.7576903360301437`*^9}, 
   3.757692811971443*^9, 3.757713411598822*^9, 3.75811433348232*^9, 
   3.758126535559136*^9, 3.758126567900481*^9, {3.758126605760133*^9, 
   3.758126643958748*^9}, {3.758126674096583*^9, 3.758126700490292*^9}, 
   3.7581267430768538`*^9, 3.758127157340764*^9, 3.758127378993319*^9, 
   3.758128681258206*^9, 3.758175549827763*^9, 3.759143910775632*^9, {
   3.759143958303913*^9, 3.759143962759877*^9}, 3.7592247420276947`*^9, 
   3.759291658390511*^9, 3.759293737537489*^9, 3.7592968992575293`*^9, 
   3.759312168170381*^9, 3.759373959512562*^9, 3.759375910204705*^9, 
   3.759385817650134*^9, 3.759404458489387*^9, 3.7594056199830723`*^9, 
   3.759407971946726*^9, 3.7594091742329397`*^9, 3.759472812769672*^9, 
   3.760692207305477*^9, 3.764327470141368*^9, 3.764782180536044*^9, 
   3.764782788868277*^9, 
   3.764783118459423*^9},ExpressionUUID->"19c8a96c-20a5-4855-aace-\
8e4495f57d7b"]
}, Open  ]],

Cell["\<\
We get the same result from the Quantum Shannon Decomposition\
\>", "Text",
 CellChangeTimes->{{3.757505162924829*^9, 3.757505179835832*^9}, {
   3.757505211743621*^9, 3.757505292947147*^9}, 
   3.759143988186104*^9},ExpressionUUID->"d6460ef6-1d41-4923-a5cc-\
34deab81538d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"QSD", "[", "u", "]"}]}]], "Input",
 CellChangeTimes->{{3.757505182214855*^9, 3.7575051871671667`*^9}, {
  3.7575061787878923`*^9, 3.7575061792727203`*^9}, {3.757517018329875*^9, 
  3.757517020259034*^9}},ExpressionUUID->"9ca416cb-569d-4b7d-9728-\
2409ff910bfc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "4.913755828160458`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.7119658015978798`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.455947604330544`", ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.757505187503037*^9, 3.757506180048685*^9, 3.757513655961578*^9, 
   3.757513702812502*^9, 3.75751715506382*^9, 3.757526297819865*^9, 
   3.7575263363616457`*^9, 3.757526678449678*^9, 3.757526844189398*^9, 
   3.757527849279894*^9, 3.757529468439291*^9, 3.757533831492865*^9, 
   3.757534367145623*^9, 3.757534492252701*^9, 3.757534689390511*^9, 
   3.757534815296928*^9, 3.757581455166031*^9, 3.757607585893664*^9, 
   3.757607725323835*^9, 3.7576100047044897`*^9, 3.757611689744461*^9, 
   3.7576117750178413`*^9, 3.757611932658805*^9, {3.757689894095508*^9, 
   3.757689922829974*^9}, 3.757689975029962*^9, 3.757690022503251*^9, 
   3.757690095227824*^9, 3.757690217256362*^9, {3.75769028408606*^9, 
   3.75769033606393*^9}, 3.757692811991527*^9, 3.757713411616289*^9, 
   3.758114335612792*^9, 3.758126535582941*^9, 3.758126567920643*^9, {
   3.758126605779934*^9, 3.758126643980772*^9}, {3.758126674118545*^9, 
   3.758126700517144*^9}, 3.758126743092904*^9, 3.758127157359968*^9, 
   3.758127379013357*^9, 3.7581286812737627`*^9, 3.758175549852395*^9, 
   3.75914397853115*^9, 3.759224742103652*^9, 3.759291658402953*^9, 
   3.759293737552533*^9, 3.759296899273391*^9, 3.759312168222897*^9, 
   3.759373959630291*^9, 3.7593759102538557`*^9, 3.759385817713028*^9, 
   3.759404458512439*^9, 3.7594051390911007`*^9, 3.759405620008593*^9, 
   3.7594079719649878`*^9, 3.75940917425961*^9, 3.759472812815777*^9, 
   3.7606922073301764`*^9, 3.7643274702251053`*^9, 3.764782180557088*^9, 
   3.764782788893894*^9, 
   3.7647831184727287`*^9},ExpressionUUID->"949cc299-8653-4141-8b32-\
fa5e6047d570"]
}, Open  ]],

Cell["We can also re-express the output in string form", "Text",
 CellChangeTimes->{{3.757506315452639*^9, 
  3.757506345934491*^9}},ExpressionUUID->"2b8fcdf0-8ee4-4124-8f90-\
3b9c84fdd84c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListFormToStr", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.757506327683342*^9, 3.757506364120454*^9}, {
  3.75750673780653*^9, 3.757506750862237*^9}, {3.757506839134384*^9, 
  3.7575068580986633`*^9}, {3.757506934902007*^9, 3.757507039222644*^9}, {
  3.757517029425074*^9, 3.757517031436654*^9}, {3.757529656209611*^9, 
  3.75752966118289*^9}, {3.757534475693355*^9, 3.757534480477377*^9}, {
  3.759144123999625*^9, 
  3.759144126319282*^9}},ExpressionUUID->"997ba7b0-c522-4366-bc42-\
e0cc96be98b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Rz(4.91376)(1)\"\>", ",", "\<\"Ry(1.71197)(1)\"\>", 
   ",", "\<\"Rz(5.45595)(1)\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.757506351060225*^9, 3.757506364576329*^9}, {
   3.757506740115885*^9, 3.7575067511774178`*^9}, {3.7575068412738247`*^9, 
   3.757506858671913*^9}, {3.757506936308187*^9, 3.7575070396883907`*^9}, 
   3.757513656052031*^9, 3.757513702915407*^9, 3.757517155169696*^9, 
   3.757526297940618*^9, 3.757526336476899*^9, 3.757526678540304*^9, 
   3.757526844271907*^9, 3.757527849359027*^9, 3.75752948073883*^9, 
   3.7575296618177958`*^9, 3.7575338315662622`*^9, 3.757534367243392*^9, {
   3.757534481268139*^9, 3.757534492324585*^9}, 3.757534701542634*^9, 
   3.7575348154080048`*^9, 3.757581455249626*^9, 3.7576075860130787`*^9, 
   3.757607725396817*^9, 3.757610004784027*^9, 3.7576116898255377`*^9, 
   3.757611775125963*^9, 3.757611932743742*^9, {3.7576898941462507`*^9, 
   3.757689922879785*^9}, 3.7576899750884*^9, 3.7576900225485487`*^9, 
   3.7576900952771606`*^9, 3.7576902173119087`*^9, {3.757690284133882*^9, 
   3.757690336126758*^9}, 3.7576928120284758`*^9, 3.75771341166791*^9, 
   3.7581143404262447`*^9, 3.7581265356858263`*^9, 3.75812656797898*^9, {
   3.758126605826459*^9, 3.758126644046199*^9}, {3.7581266741839867`*^9, 
   3.7581267005915823`*^9}, 3.758126743141161*^9, 3.758127157418354*^9, 
   3.7581273790735197`*^9, 3.758128681321617*^9, 3.7581755499248857`*^9, 
   3.759144126732399*^9, 3.75922474217388*^9, 3.759291658414797*^9, 
   3.759293737567286*^9, 3.759296899288814*^9, 3.7593121682903633`*^9, 
   3.759373959691738*^9, 3.759375910304614*^9, 3.759385817782609*^9, 
   3.759404458531361*^9, 3.759405620034724*^9, 3.759407971983387*^9, 
   3.759409174284543*^9, 3.7594728128204203`*^9, 3.7606922074038486`*^9, 
   3.764327470303197*^9, 3.764782180579794*^9, 3.7647827889147577`*^9, 
   3.76478311848612*^9},ExpressionUUID->"065844fb-850b-4ffb-bbeb-\
1de03fdc4e88"]
}, Open  ]],

Cell["Or as matrices", "Text",
 CellChangeTimes->{{3.757534414724687*^9, 
  3.7575344200845947`*^9}},ExpressionUUID->"c790f127-6ad6-4bad-a503-\
944afc38268f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"MatrixForm", ",", 
   RowBox[{"ListFormToOp", "[", "gatelist", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7575295468184023`*^9, 3.757529554080926*^9}, {
  3.757529587735498*^9, 3.7575296155088997`*^9}, {3.757529870016635*^9, 
  3.757529870450592*^9}, {3.7575338460449047`*^9, 3.75753385188165*^9}, {
  3.757534438834427*^9, 3.757534467755519*^9}, {3.759144133119823*^9, 
  3.7591441351272087`*^9}},ExpressionUUID->"c6b40152-14b9-48ad-93f8-\
d346932ec7a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.7745994921944294`"}], "+", 
         RowBox[{"0.6324520746207827`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.7745994921944294`"}], "-", 
         RowBox[{"0.6324520746207827`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.6554765245175439`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.7552155492350523`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.7552155492350523`"}], "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.6554765245175439`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.915672312690872`"}], "+", 
         RowBox[{"0.4019256346282854`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.915672312690872`"}], "-", 
         RowBox[{"0.4019256346282854`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.757529616207918*^9, 3.7575338315921373`*^9, {3.7575343451533833`*^9, 
   3.7575343672766647`*^9}, {3.7575344440664883`*^9, 3.75753449235301*^9}, 
   3.7575347063393908`*^9, 3.757534815445354*^9, 3.757581455278715*^9, 
   3.757607586045115*^9, 3.757607725431786*^9, 3.757610004809416*^9, 
   3.757611689852586*^9, 3.757611775159355*^9, 3.7576119327822647`*^9, {
   3.757689894170547*^9, 3.757689922904559*^9}, 3.757689975115601*^9, 
   3.757690022573043*^9, 3.757690095302114*^9, 3.757690217337592*^9, {
   3.757690284156302*^9, 3.757690336154398*^9}, 3.757692812047558*^9, 
   3.7577134116861362`*^9, 3.758114342929645*^9, 3.7581265357086973`*^9, 
   3.7581265680027313`*^9, {3.7581266058467617`*^9, 3.758126644066762*^9}, {
   3.7581266742065983`*^9, 3.7581267006169243`*^9}, 3.758126743157576*^9, 
   3.758127157437334*^9, 3.7581273790955343`*^9, 3.7581286813371973`*^9, 
   3.758175549949181*^9, 3.759144149023684*^9, 3.75922474226153*^9, 
   3.759291658427506*^9, 3.759293737582712*^9, 3.759296899304837*^9, 
   3.759312168355534*^9, 3.7593739597732687`*^9, 3.759375910354814*^9, 
   3.759385817874876*^9, 3.759404458551256*^9, 3.759405620055719*^9, 
   3.759407972001773*^9, 3.759409174307644*^9, 3.7594728128493967`*^9, 
   3.760692207487266*^9, 3.7643274704686613`*^9, 3.7647821806058283`*^9, 
   3.764782788936359*^9, 
   3.7647831184999247`*^9},ExpressionUUID->"4e0e64b6-56cb-4f59-92a3-\
a2100b122b52"]
}, Open  ]],

Cell["Or draw the topology for it:", "Text",
 CellChangeTimes->{{3.7575064350272923`*^9, 
  3.757506475762617*^9}},ExpressionUUID->"4b1fc65a-31e2-4056-8e52-\
efec81a15c27"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.757506461125391*^9, 3.757506463818823*^9}, {
  3.757517040075848*^9, 
  3.757517041566894*^9}},ExpressionUUID->"ea254779-bd6c-4507-8224-\
41dfbc3f0fec"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], 
      LineBox[{{4., -1.}, {5., -1.}}]}}, {{}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -1.2}, {3.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -1.}]}}, {}}},
   Annotation[#, 
    VertexCoordinateRules -> {{1., -1.}, {2., -1.}, {3., -1.}, {4., -1.}, {
     5., -1.}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.757506464178438*^9, 3.757513656111966*^9, 3.757513702966646*^9, 
   3.757517155232493*^9, 3.757526298097395*^9, 3.757526336538087*^9, 
   3.7575266785972147`*^9, 3.757526844333913*^9, 3.7575278494119062`*^9, 
   3.757533831619296*^9, 3.7575343673144693`*^9, 3.757534492386641*^9, 
   3.757534815484887*^9, 3.757581455309484*^9, 3.757607586082546*^9, 
   3.757607725462452*^9, 3.757610004840143*^9, 3.757611689884403*^9, 
   3.757611775191244*^9, 3.757611932822648*^9, {3.757689894199263*^9, 
   3.7576899229310102`*^9}, 3.757689975138688*^9, 3.757690022608219*^9, 
   3.757690095324081*^9, 3.757690217362822*^9, {3.757690284186857*^9, 
   3.757690336183907*^9}, 3.757692812070426*^9, 3.757713411708034*^9, 
   3.758114344544651*^9, 3.758126535732185*^9, 3.758126568024808*^9, {
   3.758126605865911*^9, 3.7581266440906553`*^9}, {3.7581266742327147`*^9, 
   3.758126700645315*^9}, 3.7581267431746607`*^9, 3.75812715746145*^9, 
   3.758127379117148*^9, 3.758128681355644*^9, 3.758175549975604*^9, 
   3.759224742339224*^9, 3.759291658453253*^9, 3.7592937376018248`*^9, 
   3.759296899323058*^9, 3.759312168423119*^9, 3.759373959823283*^9, 
   3.7593759104580317`*^9, 3.759385817947*^9, 3.759404458584805*^9, 
   3.759405620083009*^9, 3.759407972020997*^9, 3.7594091743336906`*^9, 
   3.75947281287538*^9, 3.760692207563183*^9, 3.7643274704948797`*^9, 
   3.76478218063076*^9, 3.764782788962858*^9, 
   3.764783118515192*^9},ExpressionUUID->"bf41a3f7-ea71-44f2-b75e-\
e49a6303b105"]
}, Open  ]],

Cell[TextData[{
 "If you use the package QCircuit in ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"L", 
     StyleBox[
      AdjustmentBox["A",
       BoxBaselineShift->-0.4,
       BoxMargins->{{-0.5, -0.3}, {0, 0}}],
      FontSize->Smaller], "T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]],ExpressionUUID->
  "1e43e8ba-47f4-40f0-a7eb-10de1a956bf3"],
 " then the command LatexQCircuit can be used to generate the circuit in a \
compatible form:"
}], "Text",
 CellChangeTimes->{{3.759212088845142*^9, 
  3.759212150827793*^9}},ExpressionUUID->"46a4089f-8b88-4946-9e1e-\
b419c4dfad49"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LatexQCircuit", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.759212081389986*^9, 
  3.759212085941531*^9}},ExpressionUUID->"e0f73b9d-3f5c-4a3a-9a64-\
cdd7a9ecde70"],

Cell[BoxData["\<\"{\\n& \\\\qw  & \\\\gate{R_z} & \\\\gate{R_y} & \
\\\\gate{R_z} & \\\\qw  \\n}\"\>"], "Output",
 CellChangeTimes->{3.759291658468008*^9, 3.7592937376182003`*^9, 
  3.759296899331874*^9, 3.7593121684712877`*^9, 3.759373959842038*^9, 
  3.759375910507867*^9, 3.759385818016315*^9, 3.759404458603698*^9, 
  3.759405620102681*^9, 3.759407972038969*^9, 3.7594091743567457`*^9, 
  3.759472812881645*^9, 3.760692207568859*^9, 3.764327470629607*^9, 
  3.764782180638749*^9, 3.76478278898746*^9, 
  3.764783118530973*^9},ExpressionUUID->"d4ebb54a-83d0-4585-9ac3-\
e3e65354e85f"]
}, Open  ]],

Cell["\<\
Using the option AnglePrecision\[Rule]2 gives the angles to two significant \
figures.\
\>", "Text",
 CellChangeTimes->{{3.7594051751807747`*^9, 3.759405200098342*^9}, {
  3.75940563017844*^9, 
  3.759405639364149*^9}},ExpressionUUID->"9430faff-0882-43bd-9fbe-\
0237625098cc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", 
  RowBox[{"gatelist", ",", 
   RowBox[{"AnglePrecision", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.759404617695421*^9, 3.7594046300761633`*^9}, {
  3.759405584901578*^9, 
  3.759405590143922*^9}},ExpressionUUID->"a74a8396-3ab1-4025-867d-\
2fbd846b1d17"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], 
      LineBox[{{4., -1.}, {5., -1.}}]}}, {{}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"\\!\\(\\*InterpretationBox[\\\"\\\\\\\"Rz(\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"4.9\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\))\\\\\\\"\\\", \
StringForm[\\\"Rz(`1`)\\\", ScientificForm[4.913755828160458`, 2]], \
Rule[Editable, False]]\\)\"\>", {2., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -1.2}, {3.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"\\!\\(\\*InterpretationBox[\\\"\\\\\\\"Ry(\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"1.7\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\))\\\\\\\"\\\", \
StringForm[\\\"Ry(`1`)\\\", ScientificForm[1.7119658015978798`, 2]], \
Rule[Editable, False]]\\)\"\>", {3., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"\\!\\(\\*InterpretationBox[\\\"\\\\\\\"Rz(\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"5.5\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\))\\\\\\\"\\\", \
StringForm[\\\"Rz(`1`)\\\", ScientificForm[5.455947604330544`, 2]], \
Rule[Editable, False]]\\)\"\>", {4., -1.}]}}, {}}},
   Annotation[#, 
    VertexCoordinateRules -> {{1., -1.}, {2., -1.}, {3., -1.}, {4., -1.}, {
     5., -1.}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{974., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.7594050866256027`*^9, 3.759405144622033*^9, 
  3.759405620132701*^9, 3.759407972057975*^9, 3.759409174383463*^9, 
  3.759472812915563*^9, 3.7606922077547617`*^9, 3.764327470661515*^9, 
  3.7647821806623497`*^9, 3.7647827890142927`*^9, 
  3.764783118546327*^9},ExpressionUUID->"8a7e24d7-1432-435d-be88-\
64364c6e8d43"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LatexQCircuit", "[", 
  RowBox[{"gatelist", ",", 
   RowBox[{"AnglePrecision", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.759405103579184*^9, {3.759405596535247*^9, 
   3.759405601103838*^9}},ExpressionUUID->"a695f0fc-d603-45d2-b6ad-\
b77cfd09a026"],

Cell[BoxData["\<\"{\\n& \\\\qw  & \\!\\(\\*InterpretationBox[\\\"\\\\\\\"\\\\\
\\\\\\\\\\\\gate{R_z(\\\\\\\\\\\\\\\\textnormal{$4.9$})}\\\\\\\"\\\", \
StringForm[\\\"\\\\\\\\gate{R_z(\\\\\\\\textnormal{$`1`$})}\\\", \
\\\"4.9\\\"], Rule[Editable, False]]\\) & \\!\\(\\*InterpretationBox[\\\"\\\\\
\\\"\\\\\\\\\\\\\\\\gate{R_y(\\\\\\\\\\\\\\\\textnormal{$1.7$})}\\\\\\\"\\\", \
StringForm[\\\"\\\\\\\\gate{R_y(\\\\\\\\textnormal{$`1`$})}\\\", \
\\\"1.7\\\"], Rule[Editable, False]]\\) & \\!\\(\\*InterpretationBox[\\\"\\\\\
\\\"\\\\\\\\\\\\\\\\gate{R_z(\\\\\\\\\\\\\\\\textnormal{$5.5$})}\\\\\\\"\\\", \
StringForm[\\\"\\\\\\\\gate{R_z(\\\\\\\\textnormal{$`1`$})}\\\", \
\\\"5.5\\\"], Rule[Editable, False]]\\) & \\\\qw  \\n}\"\>"], "Output",
 CellChangeTimes->{3.759293737699298*^9, 3.759296899408443*^9, 
  3.759312169006618*^9, 3.7593739600072727`*^9, 3.759375910926503*^9, 
  3.759385818280675*^9, 3.759404458696293*^9, 3.759405110427421*^9, 
  3.75940515804617*^9, 3.759405620150625*^9, 3.759407972081894*^9, 
  3.759409174411663*^9, 3.759472812959886*^9, 3.760692207810794*^9, 
  3.764327470747867*^9, 3.764782180685904*^9, 3.764782789039093*^9, 
  3.764783118563986*^9},ExpressionUUID->"18b977f0-21dc-4b43-97d4-\
6e6baaf72aea"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two qubit unitaries", "Subsection",
 CellChangeTimes->{{3.7591443343248568`*^9, 
  3.7591443372285547`*^9}},ExpressionUUID->"9dc29c6d-66a4-4478-8474-\
05d4701629f1"],

Cell[CellGroupData[{

Cell["Using QSD", "Subsubsection",
 CellChangeTimes->{{3.759144370716054*^9, 3.759144372420003*^9}, 
   3.759379654906745*^9},ExpressionUUID->"2cf0085e-e743-4161-a61b-\
1a8cf32ee6e3"],

Cell["\<\
Now choose a real two-qubit gate and do the Quantum Shannon Decomposition. \
The decomposition achieves the minimal number of required CNOT gates for \
arbitrary (and not necessarily generic) two qubit gates (and is equivalent to \
calling DecUnitary2Qubits in the considered case).\
\>", "Text",
 CellChangeTimes->{{3.7575074374137506`*^9, 3.7575074628276653`*^9}, {
  3.757507506735902*^9, 3.757507507153816*^9}, {3.759379668664657*^9, 
  3.7593796845411043`*^9}, {3.759379762179949*^9, 3.75937979107157*^9}, {
  3.7593798267006207`*^9, 3.7593798359760723`*^9}, {3.759379872896913*^9, 
  3.759379944769245*^9}, {3.759404708891511*^9, 
  3.759404717758514*^9}},ExpressionUUID->"dd64f436-7974-464e-8280-\
46fdba8f5e3a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"RPickRandomUnitary", "[", "4", "]"}]}], ";", 
  RowBox[{"u", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.757507464818143*^9, 3.75750750324406*^9}, 
   3.759375238150989*^9},ExpressionUUID->"33374886-02d2-43c7-b1da-\
acc9ca32dea1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.27402989600661437`", "0.603530321483858`", "0.04911221238894877`", 
      "0.7471591247776193`"},
     {
      RowBox[{"-", "0.4312336867096547`"}], 
      RowBox[{"-", "0.22320841559484614`"}], "0.826736140570809`", 
      "0.28411769485289307`"},
     {"0.8549432158956841`", 
      RowBox[{"-", "0.2295549593639171`"}], "0.4378965293879847`", 
      RowBox[{"-", "0.15691796511341233`"}]},
     {
      RowBox[{"-", "0.08953893642069564`"}], "0.7302285086797556`", 
      "0.34977417574530056`", 
      RowBox[{"-", "0.5800061464826786`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.757507499339512*^9, 3.757507503384161*^9}, 
   3.757513656124071*^9, 3.757513702987257*^9, 3.757517155262844*^9, 
   3.757526298118825*^9, 3.757526336554729*^9, 3.757526678616461*^9, 
   3.7575268443641*^9, 3.757527849439127*^9, {3.757530757973186*^9, 
   3.757530797829101*^9}, 3.757533831643393*^9, 3.757534367327793*^9, 
   3.757534492405472*^9, 3.757534815520022*^9, 3.757581455335916*^9, 
   3.757584073604011*^9, 3.757607586105826*^9, 3.757607725477059*^9, 
   3.75761000486246*^9, 3.757611689907926*^9, 3.757611775228304*^9, 
   3.757611932866041*^9, {3.7576898942431726`*^9, 3.757689922940675*^9}, 
   3.7576899751442757`*^9, 3.757690022628941*^9, 3.7576900953330708`*^9, 
   3.7576902173840847`*^9, {3.757690284216209*^9, 3.7576903362143106`*^9}, 
   3.757692812093503*^9, 3.7577134117220287`*^9, 3.7581143462552958`*^9, 
   3.758126535740237*^9, 3.758126568035206*^9, {3.758126605884667*^9, 
   3.758126644115885*^9}, {3.7581266742562943`*^9, 3.758126700671055*^9}, 
   3.758126743192103*^9, 3.7581271574836893`*^9, 3.75812737913951*^9, 
   3.758128681372064*^9, 3.758175550002792*^9, 3.759212173817378*^9, 
   3.75922474234627*^9, 3.759291658482984*^9, 3.759293737634047*^9, 
   3.759296899348648*^9, 3.759312168521435*^9, 3.759373959890785*^9, {
   3.759374833551944*^9, 3.759374841663892*^9}, {3.759375134942889*^9, 
   3.759375167961417*^9}, 3.759375772495442*^9, 3.7593759105572844`*^9, 
   3.759379806489447*^9, 3.759385818079311*^9, 3.759404458636141*^9, 
   3.75940508335944*^9, 3.759405620174238*^9, 3.7594079721064787`*^9, 
   3.7594091744368353`*^9, 3.759472812996649*^9, 3.760692207868841*^9, 
   3.76432747083217*^9, 3.764782180711219*^9, 3.764782789064289*^9, 
   3.7647831185819902`*^9},ExpressionUUID->"e5f42b14-09eb-4dce-88fa-\
29fe1806e579"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"QSD", "[", "u", "]"}]}]], "Input",
 CellChangeTimes->{{3.757507487989634*^9, 3.75750749410955*^9}, {
  3.7575170470088053`*^9, 3.757517048260042*^9}, {3.759375190886752*^9, 
  3.7593751962681227`*^9}, {3.759375228319816*^9, 3.7593752290203743`*^9}, {
  3.759375285059658*^9, 
  3.759375285517479*^9}},ExpressionUUID->"130f6fbd-f21e-4ead-84a2-\
c4ce90a088c1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "4.71238898038469`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.570796326794896`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.04244777250756`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.1415926535897927`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.02749639769249`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.5707963267948961`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.6320598006469655`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "6.024881971803981`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.1289882982255985`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.1806179819139055`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.570796326794897`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.5707963267948968`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.5707963267948966`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.570796326794897`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6.2831853071795845`", ",", "2"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.757507494705205*^9, 3.757507509133583*^9}, 
   3.757513656152948*^9, 3.757513703025957*^9, 3.7575171553007708`*^9, 
   3.757526298154244*^9, 3.757526336592325*^9, 3.757526678651812*^9, 
   3.757526844395265*^9, 3.757527849467328*^9, {3.7575307521538353`*^9, 
   3.757530800591217*^9}, 3.757533831673229*^9, 3.757534367361377*^9, 
   3.7575344924340487`*^9, 3.757534815565105*^9, 3.757581455364259*^9, 
   3.7576075861370983`*^9, 3.757607725505185*^9, 3.7576100048939962`*^9, 
   3.757611689931673*^9, 3.7576117752642517`*^9, 3.7576119329070807`*^9, {
   3.7576898942641697`*^9, 3.7576899229776163`*^9}, 3.75768997519073*^9, 
   3.757690022664444*^9, 3.7576900953566628`*^9, 3.757690217406242*^9, {
   3.757690284239458*^9, 3.757690336244925*^9}, 3.7576928121271143`*^9, 
   3.757713411739418*^9, 3.758114347149342*^9, 3.758126535763289*^9, 
   3.758126568055879*^9, {3.758126605904581*^9, 3.758126644141671*^9}, {
   3.758126674280916*^9, 3.758126700705555*^9}, 3.758126743211093*^9, 
   3.758127157503166*^9, 3.7581273791615257`*^9, 3.758128681390431*^9, 
   3.758175550029512*^9, 3.7592247424647512`*^9, 3.759291658515875*^9, 
   3.759293737662694*^9, 3.759296899380171*^9, 3.7593121686627083`*^9, 
   3.7593739599418497`*^9, {3.759374834642913*^9, 3.7593748425734463`*^9}, {
   3.759375135898938*^9, 3.759375168768818*^9}, 3.759375773315318*^9, 
   3.759375910654413*^9, 3.7593858181462927`*^9, 3.759404458665052*^9, 
   3.759405084216975*^9, 3.759405620207984*^9, 3.759407972137802*^9, 
   3.75940917447005*^9, 3.75947281305795*^9, 3.760692207932087*^9, 
   3.764327470954729*^9, 3.764782180744405*^9, 3.764782789098384*^9, 
   3.7647831186270437`*^9},ExpressionUUID->"590dcc26-da11-4e70-88f5-\
00e3decc8b59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.757507517710937*^9, 3.757507520984623*^9}, {
  3.757517052496437*^9, 
  3.757517053577499*^9}},ExpressionUUID->"610d5bb5-8950-41d3-bd59-\
6f7c8f3d574b"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -1.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -1.}, {11., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -1.}, {12., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -1.}, {13., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {10., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -2.}, {11., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {12., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {11., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], 
      LineBox[{{12., -2.}, {13., -2.}}]}}, {{}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -1.2}, {3.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -1.2}, {5., -0.8}}], 
       LineBox[{{4.8, -1.}, {5.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -1.2}, {6.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {6., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -1.2}, {7.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {7., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{8., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{8., -1.2}, {8., -0.8}}], 
       LineBox[{{7.8, -1.}, {8.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -1.2}, {9.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -1.2}, {10.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {10., -1.}]}}, 
     {GrayLevel[0], DiskBox[{11., -1.}, 0.1]}, {}, {}, 
     {GrayLevel[0], DiskBox[{5., -2.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{8., -2.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -2.2}, {3.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -2.2}, {4.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -2.2}, {6.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {6., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -2.2}, {7.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {7., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -2.2}, {9.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -2.2}, {10.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {10., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{11., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{11., -2.2}, {11., -1.8}}], 
       LineBox[{{10.8, -2.}, {11.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{11.8, -2.2}, {12.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {12., -2.}]}}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGCQAmIQDQEf7KH0fqiAAyqfA40vgMYXQeNLoPFl0PgKaHwl
NL4KGl8Nja+BxtfC4R6GA6j2wfgw/8L4DGjyHGh8ATS+BBpfBo2vhMZXQeOr
ofE10PhacD4A/zAsRQ==
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{655., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.7575075213074636`*^9, 3.7575136561958313`*^9, 3.7575137030559587`*^9, 
   3.757517155337336*^9, 3.7575262981845617`*^9, 3.757526336635291*^9, 
   3.757526678684094*^9, 3.7575268444288387`*^9, 3.757527849499268*^9, {
   3.757530764138912*^9, 3.757530803507592*^9}, 3.757533831706674*^9, 
   3.7575343673952*^9, 3.757534492465225*^9, 3.7575348156182747`*^9, 
   3.7575814554012833`*^9, 3.757607586170188*^9, 3.757607725535963*^9, 
   3.757610004929133*^9, 3.7576116899690123`*^9, 3.757611775306617*^9, 
   3.757611932951272*^9, {3.757689894306436*^9, 3.757689923028286*^9}, 
   3.757689975235332*^9, 3.757690022704666*^9, 3.757690095381455*^9, 
   3.75769021743025*^9, {3.757690284264307*^9, 3.757690336277734*^9}, 
   3.757692812166103*^9, 3.757713411761919*^9, 3.758114348462867*^9, 
   3.7581265357898808`*^9, 3.758126568079813*^9, {3.758126605926292*^9, 
   3.7581266441691637`*^9}, {3.758126674308447*^9, 3.758126700737397*^9}, 
   3.7581267432306967`*^9, 3.7581271575246477`*^9, 3.758127379184677*^9, 
   3.7581286814115553`*^9, 3.7581755500619507`*^9, 3.759224742575961*^9, 
   3.759291658537753*^9, 3.7592937376832027`*^9, 3.759296899400344*^9, 
   3.759312168773425*^9, 3.7593739599793673`*^9, {3.759374835868849*^9, 
   3.7593748434502068`*^9}, {3.759375137069989*^9, 3.759375169567444*^9}, 
   3.7593757742094307`*^9, 3.759375910760895*^9, 3.759385818216484*^9, 
   3.75940445868813*^9, 3.7594050857099247`*^9, 3.759405620229578*^9, 
   3.759407972161594*^9, 3.7594091744964027`*^9, 3.759472813111875*^9, 
   3.7606922080342712`*^9, 3.764327471080407*^9, 3.7647821807714577`*^9, 
   3.76478278912353*^9, 
   3.764783118657909*^9},ExpressionUUID->"f383e27c-229f-454b-bcac-\
9fb5b5abf1df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LatexQCircuit", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{
  3.759405108056796*^9},ExpressionUUID->"61c74425-3eaa-4d51-8190-\
8a2806877f5c"],

Cell[BoxData["\<\"{\\n& \\\\qw  & \\\\gate{R_z} & \\\\gate{R_y} & \
\\\\gate{R_z} & \\\\targ & \\\\gate{R_z} & \\\\gate{R_x} & \\\\targ & \
\\\\gate{R_y} & \\\\gate{R_x} & \\\\ctrl{1} & \\\\qw  & \\\\qw  \\\\\\\\\\n& \
\\\\qw  & \\\\gate{R_z} & \\\\gate{R_y} & \\\\gate{R_z} & \\\\ctrl{-1} & \
\\\\gate{R_x} & \\\\gate{R_z} & \\\\ctrl{-1} & \\\\gate{R_y} & \\\\gate{R_z} \
& \\\\targ & \\\\gate{R_z} & \\\\qw  \\n}\"\>"], "Output",
 CellChangeTimes->{3.759405108459095*^9, 3.759405620238351*^9, 
  3.75940797218859*^9, 3.759409174523449*^9, 3.759472813141841*^9, 
  3.760692208128759*^9, 3.7643274711487513`*^9, 3.76478218077992*^9, 
  3.764782789149081*^9, 
  3.7647831186812057`*^9},ExpressionUUID->"3ba524ff-5d1a-4977-847f-\
7ba5cf026fd2"]
}, Open  ]],

Cell["We can check the result as before:", "Text",
 CellChangeTimes->{{3.7575075473633413`*^9, 
  3.757507563141993*^9}},ExpressionUUID->"0784cfcb-5d1f-4773-aaec-\
bb0192710ac0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"outu", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}]}], ";", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"outu", "/", 
      RowBox[{"outu", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"u", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "u"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.757507564572139*^9, 3.757507609548224*^9}, {
   3.757517057562955*^9, 3.757517058624649*^9}, {3.757526710129388*^9, 
   3.757526716846142*^9}, {3.757689933998273*^9, 3.757689934358218*^9}, {
   3.757690081085662*^9, 3.757690081269588*^9}, {3.75812659645926*^9, 
   3.758126599481881*^9}, 
   3.761712732381304*^9},ExpressionUUID->"aea1d9da-abeb-401b-9325-\
68dec2a50772"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.757507601710257*^9, 3.757507609827969*^9}, 
   3.7575136562098722`*^9, 3.757513703087586*^9, 3.757517155367817*^9, 
   3.757526298216792*^9, 3.757526336686371*^9, 3.7575266787350273`*^9, 
   3.7575268444600363`*^9, 3.7575278495277576`*^9, 3.757530794947527*^9, 
   3.757533831722315*^9, 3.757534367409*^9, 3.757534492496045*^9, 
   3.757534815657688*^9, 3.757581455418339*^9, 3.757607586296826*^9, 
   3.757607725551132*^9, 3.7576100049414873`*^9, 3.7576116899808807`*^9, 
   3.757611775338497*^9, 3.757611932987668*^9, {3.757689894337961*^9, 
   3.7576899230638733`*^9}, 3.757689975268879*^9, 3.757690022735588*^9, 
   3.757690095395299*^9, 3.757690217451787*^9, {3.757690284299065*^9, 
   3.757690336312896*^9}, 3.757692812195634*^9, 3.757713411770443*^9, 
   3.758114350345974*^9, 3.7581265358108263`*^9, 3.758126568105673*^9, {
   3.758126605945758*^9, 3.758126644193532*^9}, {3.7581266743338137`*^9, 
   3.758126700762882*^9}, 3.758126743251501*^9, 3.7581271575450993`*^9, 
   3.7581273792057047`*^9, 3.758128681430193*^9, 3.758175550088254*^9, 
   3.759224742737234*^9, 3.759291658551437*^9, 3.759293737715582*^9, 
   3.759296899424741*^9, 3.759312169373214*^9, 3.7593739600570517`*^9, 
   3.759374852441347*^9, 3.759375911059613*^9, 3.759385818348982*^9, 
   3.7594044587151613`*^9, 3.759405620260182*^9, 3.759407972216563*^9, 
   3.759409174551955*^9, 3.759472813177525*^9, 3.7606922082077093`*^9, 
   3.7643274711723948`*^9, 3.76478218080256*^9, 3.764782789173436*^9, 
   3.764783118703745*^9},ExpressionUUID->"08519deb-dcf2-4dd6-bfc3-\
4cfc652bde45"]
}, Open  ]],

Cell["\<\
We can also apply u to other qubits using the second argument of QSD to \
specify. E.g. to the second and fourth qubits\
\>", "Text",
 CellChangeTimes->{{3.757583937431033*^9, 3.757583959297957*^9}, {
  3.757584090027108*^9, 3.757584098660459*^9}, {3.757584145807228*^9, 
  3.757584146476082*^9}},ExpressionUUID->"2fb105a9-9565-4a01-8033-\
f84a2fe02675"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"QSD", "[", 
   RowBox[{"u", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.7575839666554117`*^9, {3.757584057281*^9, 3.7575840589035597`*^9}, {
   3.757584148952326*^9, 
   3.757584149117813*^9}},ExpressionUUID->"31e968a8-d696-485f-9723-\
4465c9f5b1df"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "4.71238898038469`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.570796326794896`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.04244777250756`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.1415926535897927`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.02749639769249`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.5707963267948961`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.6320598006469655`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "6.024881971803981`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.1289882982255985`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.1806179819139055`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.570796326794897`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.5707963267948968`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.5707963267948966`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.570796326794897`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6.2831853071795845`", ",", "4"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.757584060269775*^9, 3.757584078455962*^9}, 
   3.757584149521331*^9, 3.757607586337042*^9, 3.757607725573612*^9, 
   3.7576100049658012`*^9, 3.757611690004672*^9, 3.7576117753714857`*^9, 
   3.757611933031892*^9, {3.757689894361354*^9, 3.7576899230864573`*^9}, 
   3.7576899753096037`*^9, 3.757690022757319*^9, 3.757690095437868*^9, 
   3.757690217473703*^9, {3.757690284324799*^9, 3.75769033634098*^9}, 
   3.757692812216105*^9, 3.757713411787847*^9, 3.758114352014091*^9, 
   3.758126535834841*^9, 3.758126568128537*^9, {3.7581266059646273`*^9, 
   3.7581266442175617`*^9}, {3.758126674356902*^9, 3.758126700788028*^9}, 
   3.758126743272655*^9, 3.758127157564889*^9, 3.758127379226768*^9, 
   3.758128681448771*^9, 3.758175550114584*^9, {3.759212170656261*^9, 
   3.759212175892439*^9}, 3.7592247427812*^9, 3.759291658585556*^9, 
   3.759293737745113*^9, 3.759296899456056*^9, 3.759312169922069*^9, 
   3.7593739601094427`*^9, 3.759374865950869*^9, 3.7593759111242123`*^9, 
   3.7593858184135303`*^9, 3.7594044587441874`*^9, 3.759405620289752*^9, 
   3.759407972249319*^9, 3.7594091745855703`*^9, 3.7594728132201138`*^9, 
   3.7606922082553463`*^9, 3.76432747128128*^9, 3.764782180836269*^9, 
   3.7647827892061567`*^9, 
   3.764783118739687*^9},ExpressionUUID->"b5d9dbd3-fb5a-4eb2-a329-\
a5881f295cc3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", "gatelist", "]"}]], "Input",ExpressionUUID->"6ff5f6fc-34f8-49f5-8ad7-169171d9ccd5"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -1.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -1.}, {11., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -1.}, {12., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -1.}, {13., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {5., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {8., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {10., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -2.}, {11., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {12., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -2.}, {13., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -4.}, {6., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -4.}, {9., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -3.}, {2., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {3., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -3.}, {4., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -3.}, {7., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -3.}, {8., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -3.}, {9., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -3.}, {10., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -3.}, {11., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -3.}, {12., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -3.}, {13., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -4.}, {2., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -4.}, {3., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -4.}, {4., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -4.}, {5., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -4.}, {7., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -4.}, {8., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -4.}, {10., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -4.}, {11., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -4.}, {12., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -4.}, {11., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], 
      LineBox[{{12., -4.}, {
       13., -4.}}]}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -2.2}, {3.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -2.2}, {4.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -2.2}, {5., -1.8}}], 
       LineBox[{{4.8, -2.}, {5.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -2.2}, {6.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {6., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -2.2}, {7.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {7., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{8., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{8., -2.2}, {8., -1.8}}], 
       LineBox[{{7.8, -2.}, {8.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -2.2}, {9.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -2.2}, {10.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {10., -2.}]}}, 
     {GrayLevel[0], DiskBox[{11., -2.}, 0.1]}, {}, {}, 
     {GrayLevel[0], DiskBox[{5., -4.}, 0.1]}, 
     {GrayLevel[0], 
      DiskBox[{8., -4.}, 
       0.1]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -4.2}, {2.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -4.2}, {3.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -4.2}, {4.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -4.2}, {6.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {6., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -4.2}, {7.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {7., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -4.2}, {9.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -4.2}, {10.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {10., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{11., -4.}, 0.2], 
      {GrayLevel[0], LineBox[{{11., -4.2}, {11., -3.8}}], 
       LineBox[{{10.8, -4.}, {11.2, -4.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{11.8, -4.2}, {12.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {12., -4.}]}}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxdzzEOQiEQRVFiNeUUFBQUSAgh1PbfNbgEE2uXqEtyCWrkmfxLQiZnGrjH
6/1yO4QQTp/7nb/z2tZ8rMV5b4MdjnCCM1zgCje4wwOesHrCc98jG+xwhBOc
4QJXuMEdHvCE9R/He7J6bVm9ssEORzjBGS5whRvc4QFPWD3qU49ssMMJznCF
G9zhAc+/35eES/E=
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{663., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.757584105136677*^9, 3.7575841513493567`*^9, 3.757607586374034*^9, 
   3.757607725608142*^9, 3.757610004999626*^9, 3.757611690044997*^9, 
   3.757611775421035*^9, 3.757611933071444*^9, {3.757689894414673*^9, 
   3.757689923138322*^9}, 3.7576899753604527`*^9, 3.757690022787702*^9, 
   3.757690095492145*^9, 3.757690217502713*^9, {3.757690284355695*^9, 
   3.757690336372261*^9}, 3.757692812247273*^9, 3.757713411815301*^9, 
   3.758114354409953*^9, 3.7581265358625917`*^9, 3.758126568156095*^9, {
   3.758126605990005*^9, 3.758126644243298*^9}, {3.758126674382452*^9, 
   3.758126700814534*^9}, 3.758126743295598*^9, 3.758127157590315*^9, 
   3.7581273792522097`*^9, 3.758128681475281*^9, 3.7581755501550093`*^9, 
   3.759212177267171*^9, 3.759224742889319*^9, 3.759291658613398*^9, 
   3.7592937377716618`*^9, 3.75929689948038*^9, 3.759312172217506*^9, 
   3.7593739601556063`*^9, 3.75937486850244*^9, 3.759375911178398*^9, 
   3.7593858184636*^9, 3.759404458770233*^9, 3.7594056203170223`*^9, 
   3.75940797227701*^9, 3.7594091746144457`*^9, 3.7594728132782297`*^9, 
   3.760692208364168*^9, 3.76432747140591*^9, 3.764782180864729*^9, 
   3.764782789231318*^9, 
   3.764783118768207*^9},ExpressionUUID->"fb55582b-474d-4af0-9605-\
9c7c3359ac10"]
}, Open  ]],

Cell["Or, reversing the gates to the fourth and second qubits", "Text",
 CellChangeTimes->{{3.758127345132978*^9, 
  3.7581273554129543`*^9}},ExpressionUUID->"c38843d3-2662-40ca-8e0e-\
02fb08453f54"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", 
  RowBox[{"QSD", "[", 
   RowBox[{"u", ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.758127361671535*^9, 
  3.758127369397481*^9}},ExpressionUUID->"d078974e-4247-4028-90c7-\
5f1fe1aef2e7"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -1.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -1.}, {11., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -1.}, {12., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -1.}, {13., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {10., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -2.}, {11., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {12., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {11., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -2.}, {13., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -4.}, {12., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -3.}, {2., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {3., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -3.}, {4., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -3.}, {7., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -3.}, {8., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -3.}, {9., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -3.}, {10., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -3.}, {11., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -3.}, {12., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -3.}, {13., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -4.}, {2., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -4.}, {3., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -4.}, {4., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -4.}, {5., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -4.}, {6., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -4.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -4.}, {7., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -4.}, {8., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -4.}, {9., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -4.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -4.}, {10., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -4.}, {11., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], 
      LineBox[{{12., -4.}, {
       13., -4.}}]}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -2.2}, {3.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -2.2}, {4.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -2.}]}}, 
     {GrayLevel[0], DiskBox[{5., -2.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -2.2}, {6.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {6., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -2.2}, {7.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {7., -2.}]}}, 
     {GrayLevel[0], DiskBox[{8., -2.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -2.2}, {9.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -2.2}, {10.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {10., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{11., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{11., -2.2}, {11., -1.8}}], 
       LineBox[{{10.8, -2.}, {11.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{11.8, -2.2}, {12.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {12., -2.}]}}, {}, 
     {GrayLevel[0], 
      DiskBox[{11., -4.}, 
       0.1]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -4.2}, {2.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -4.2}, {3.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -4.2}, {4.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -4.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -4.2}, {5., -3.8}}], 
       LineBox[{{4.8, -4.}, {5.2, -4.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -4.2}, {6.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {6., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -4.2}, {7.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {7., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{8., -4.}, 0.2], 
      {GrayLevel[0], LineBox[{{8., -4.2}, {8., -3.8}}], 
       LineBox[{{7.8, -4.}, {8.2, -4.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -4.2}, {9.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -4.2}, {10.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {10., -4.}]}}, {}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxdzzEKQjEQRdFgNeUUKVKkiCGEkNr+uwaXIFi7RF2SS1AxT/h3IAwnTHOP
1/vldgghnD7vu3/z2tZ+rI/z3gY7HOEEZ7jAFW5whwc8YfWE575HNtjhCCc4
wwWucIM7POAJ696X1WfL6pMNdjjCCc5wgSvc4A4PeMLqUZ96ZIMdjnCCM1zg
Cjd4wPPvN7gES/E=
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{669., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.758127373859977*^9, 3.7581273792939167`*^9}, 
   3.7581286815158443`*^9, 3.758175550209234*^9, 3.7592247430904207`*^9, 
   3.7592916586688347`*^9, 3.7592937378217793`*^9, 3.75929689953246*^9, 
   3.759312172476729*^9, 3.759373960230112*^9, 3.759374871329239*^9, 
   3.759375911271447*^9, 3.759385818548297*^9, 3.75940445882106*^9, 
   3.759405620368512*^9, 3.759407972328146*^9, 3.759409174666334*^9, 
   3.759472813348652*^9, 3.7606922085242853`*^9, 3.764327471624065*^9, 
   3.764782180918845*^9, 3.7647827893070507`*^9, 
   3.7647831188269*^9},ExpressionUUID->"0dc8262f-2d7e-4b91-8eb5-d1efdb82dc73"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using the Knill decomposition", "Subsubsection",
 CellChangeTimes->{{3.75914438101151*^9, 3.759144386730092*^9}, {
  3.75940801654436*^9, 
  3.759408019414598*^9}},ExpressionUUID->"2ec2c92d-7436-43d2-bc35-\
f9be9c400a1d"],

Cell["We could also use another decomposition", "Text",
 CellChangeTimes->{{3.7575081379148827`*^9, 3.757508143843274*^9}, {
  3.759379978029298*^9, 
  3.7593799947851677`*^9}},ExpressionUUID->"a979648e-dfee-4742-85dd-\
05a0e65322ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"KnillDec", "[", "u", "]"}]}]], "Input",
 CellChangeTimes->{{3.7575081213682203`*^9, 3.7575081280853043`*^9}, {
   3.757517063005769*^9, 3.757517064987404*^9}, 
   3.763036577614781*^9},ExpressionUUID->"2abad297-5933-44ad-9c2e-\
dcf87ff2d483"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "2.7227523517392194`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.398907590971266`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.937236327095512`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.666061415350468`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.2564876934459015`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.808228129505426`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "5.43269028422664`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.8082281295054261`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.7992661723952756`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.9213079165037912`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.985066254973467`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.32691528320902385`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.267826657453714`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.468507936798817`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.5064076262609634`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.1488484424464121`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.474957177674161`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "5.43269028422664`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.47495717767416`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.1328769399147343`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.5921194901995607`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.907500207460746`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.726477017723458`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.3437979309440726`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.1942254024223948`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.626835056615054`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.025163283680088`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "2"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6.078352850623406`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "2"], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4.50755652382851`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.5707963267948974`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.5707963267948968`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.6775184710488826`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.141592653589793`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.8926343186420664`", ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.757508128692822*^9, 3.757513656264316*^9, 3.7575137031387157`*^9, 
   3.7575171554377213`*^9, 3.75752629829937*^9, 3.7575263367313147`*^9, 
   3.757526678784298*^9, 3.757526844505578*^9, 3.7575278495847607`*^9, 
   3.757533831806099*^9, 3.75753436745404*^9, 3.757534492562087*^9, 
   3.757534815700996*^9, 3.757581455463748*^9, 3.7576075864261847`*^9, 
   3.757607725659753*^9, 3.7576100050497103`*^9, 3.757611690096685*^9, 
   3.757611775478465*^9, 3.757611933126289*^9, {3.757689894464023*^9, 
   3.757689923190173*^9}, 3.757689975433508*^9, 3.757690022849298*^9, 
   3.757690095542473*^9, 3.757690217578047*^9, {3.757690284434115*^9, 
   3.757690336430332*^9}, 3.7576928123241453`*^9, 3.7577134118487*^9, 
   3.7581143588781013`*^9, 3.75812653590624*^9, 3.758126568190475*^9, {
   3.758126606033008*^9, 3.7581266442862053`*^9}, {3.758126674416277*^9, 
   3.758126700858604*^9}, 3.758126743338745*^9, 3.758127157633569*^9, 
   3.758127379340118*^9, 3.758128681550695*^9, 3.758175550269418*^9, 
   3.759224743314123*^9, 3.759291658801833*^9, 3.759293737996024*^9, 
   3.759296899705511*^9, 3.759312172760601*^9, 3.7593739604685593`*^9, 
   3.75937591149264*^9, 3.759385818815269*^9, 3.759404459005095*^9, 
   3.7594056205291767`*^9, 3.7594079725205183`*^9, 3.759409174849419*^9, 
   3.759472813617261*^9, 3.7606922088080893`*^9, 3.764327471875424*^9, 
   3.764782181119919*^9, 3.764782789460648*^9, 
   3.7647831189845963`*^9},ExpressionUUID->"efbdde25-e7e8-45b0-9445-\
d27f31c37fb0"]
}, Open  ]],

Cell["\<\
In this case, the output is much longer, but still gives the same result\
\>", "Text",
 CellChangeTimes->{{3.757508153203644*^9, 
  3.757508181256287*^9}},ExpressionUUID->"844d7ee5-4d84-4fd3-9db8-\
899e2f29a466"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.7575081824360847`*^9, 3.7575081865011683`*^9}, {
  3.757517071324424*^9, 
  3.757517072647522*^9}},ExpressionUUID->"e5a8ae16-61bf-49bc-9667-\
3fa2b5881f78"],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{
  3.757508186847625*^9, 3.7575136562921333`*^9, 3.757513703167691*^9, 
   3.7575171554685163`*^9, 3.757526298321916*^9, 3.757526336760441*^9, 
   3.757526678815012*^9, 3.7575268445375643`*^9, 3.757527849611508*^9, 
   3.757533831832787*^9, 3.7575343674835043`*^9, 3.757534492590527*^9, 
   3.7575348157360897`*^9, 3.75758145549284*^9, 3.75760758645347*^9, 
   3.757607725690086*^9, 3.7576100050753727`*^9, 3.7576116901220417`*^9, 
   3.7576117755133867`*^9, 3.757611933163891*^9, {3.757689894492017*^9, 
   3.75768992321665*^9}, 3.757689975461347*^9, 3.757690022876848*^9, 
   3.7576900955710697`*^9, 3.757690217609024*^9, {3.757690284465798*^9, 
   3.7576903364603033`*^9}, 3.757692812353065*^9, 3.757713411865299*^9, 
   3.758114361236392*^9, 3.7581265359311037`*^9, 3.758126568212413*^9, {
   3.758126606053876*^9, 3.758126644310152*^9}, {3.758126674438409*^9, 
   3.758126700884107*^9}, 3.7581267433607397`*^9, 3.758127157655353*^9, 
   3.758127379358286*^9, 3.758128681569911*^9, 3.75817555030057*^9, 
   3.7592247433973837`*^9, 3.759291658816306*^9, 3.7592937380136766`*^9, 
   3.759296899722454*^9, 3.7593121728235607`*^9, 3.759373960524876*^9, 
   3.759375911726807*^9, 3.759385819063574*^9, 3.7594044590289*^9, 
   3.7594056205528708`*^9, 3.7594079725529547`*^9, 3.759409174874457*^9, 
   3.7594728137661457`*^9, 3.7606922090018053`*^9, 3.764327471960454*^9, 
   3.764782181144088*^9, 3.76478278949079*^9, 
   3.7647831190139723`*^9},ExpressionUUID->"43244d54-4f23-48de-b210-\
5434da9dbc93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"outu", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}]}], ";", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"outu", "/", 
      RowBox[{"outu", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"u", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "u"}], "]"}]}]], "Input",\

 CellChangeTimes->{
  3.7575170843788137`*^9, {3.757526726063217*^9, 3.7575267322936373`*^9}, {
   3.7576899418785152`*^9, 3.7576899420140553`*^9}, {3.75769007803528*^9, 
   3.757690078182075*^9}, {3.7581266164217777`*^9, 3.758126617349091*^9}, 
   3.7617127323961267`*^9},ExpressionUUID->"c3681e39-c6cc-45c3-b350-\
69b05c88f021"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7575081681898737`*^9, 3.75751365632216*^9, 3.757513703199286*^9, 
   3.757517155500539*^9, 3.757526298365541*^9, 3.757526336810853*^9, 
   3.7575266788697023`*^9, 3.757526844569434*^9, 3.757527849641603*^9, 
   3.757533831862815*^9, 3.757534367516314*^9, 3.7575344926229553`*^9, 
   3.7575348157705584`*^9, 3.757581455518653*^9, 3.75760758661524*^9, 
   3.757607725720213*^9, 3.757610005099263*^9, 3.7576116901469183`*^9, 
   3.757611775549713*^9, 3.757611933201673*^9, {3.757689894535816*^9, 
   3.757689923263715*^9}, 3.757689975489347*^9, 3.757690022903489*^9, 
   3.75769009559534*^9, 3.757690217638248*^9, {3.757690284492358*^9, 
   3.757690336498012*^9}, 3.7576928123827143`*^9, 3.757713411882697*^9, 
   3.7581143630130367`*^9, 3.7581265359681787`*^9, 3.7581265682466793`*^9, {
   3.7581266060915127`*^9, 3.758126644333593*^9}, {3.758126674460299*^9, 
   3.758126700908033*^9}, 3.758126743383004*^9, 3.758127157676928*^9, 
   3.758127379374939*^9, 3.758128681589406*^9, 3.758175550333527*^9, 
   3.759224743491551*^9, 3.759291658830184*^9, 3.759293738030705*^9, 
   3.759296899739272*^9, 3.759312172937922*^9, 3.759373960723071*^9, 
   3.759375911871685*^9, 3.759385819130951*^9, 3.7594044590544643`*^9, 
   3.759405620577039*^9, 3.7594079725841923`*^9, 3.759409174897807*^9, 
   3.759472813791806*^9, 3.760692209082234*^9, 3.764327472038034*^9, 
   3.764782181168953*^9, 3.764782789521183*^9, 
   3.764783119042894*^9},ExpressionUUID->"e7c1e0d0-f6ce-4a3c-a225-\
843f547d634e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using the column by column decomposition", "Subsubsection",
 CellChangeTimes->{{3.7591443972755327`*^9, 
  3.759144404602928*^9}},ExpressionUUID->"facffd1c-80e0-4c3f-8c8c-\
e1a80e9cf3c5"],

Cell["\<\
The other decomposition we can do is the column-by-column decomposition\
\>", "Text",
 CellChangeTimes->{{3.757513815304296*^9, 
  3.757513828622073*^9}},ExpressionUUID->"b4ca9ea5-7890-4f09-8a16-\
05f7d718df7f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"ColumnByColumnDec", "[", "u", "]"}]}]], "Input",
 CellChangeTimes->{{3.757513837819583*^9, 3.757513842837641*^9}, 
   3.757517085192902*^9},ExpressionUUID->"a92d04ca-b9b0-44a0-80a3-\
1e8c39b8b5e2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "4.71238898038469`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.497787143782138`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.71238898038469`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.497787143782138`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.6699412078771296`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.141592653589793`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.6699412078771296`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.724993335748885`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.141592653589793`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.7249933357488847`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "5.421847452764823`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.141592653589793`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4.7514143087088`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4.2141376014334355`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.679860395514129`", ",", "2"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7575138450989428`*^9, 3.757517155538911*^9, 3.7575262983992567`*^9, 
   3.757526336855468*^9, 3.757526678902321*^9, 3.757526844611785*^9, 
   3.75752784967406*^9, 3.757533831897423*^9, 3.7575343675502167`*^9, 
   3.7575344926531973`*^9, 3.757534815807374*^9, 3.75758145555906*^9, 
   3.7576075868031473`*^9, 3.757607725756258*^9, 3.757610005135784*^9, 
   3.7576116901730413`*^9, 3.757611775588868*^9, 3.757611933239698*^9, {
   3.757689894562108*^9, 3.75768992329214*^9}, 3.757689975537107*^9, 
   3.757690022948004*^9, 3.757690095651889*^9, 3.757690217694409*^9, {
   3.7576902845338993`*^9, 3.757690336544197*^9}, 3.757692812432575*^9, 
   3.757713411902912*^9, 3.758114364566125*^9, 3.758126535993308*^9, 
   3.7581265682695827`*^9, {3.7581266061138067`*^9, 3.758126644358307*^9}, {
   3.758126674482929*^9, 3.758126700935244*^9}, 3.758126743406682*^9, 
   3.758127157700531*^9, 3.758127379394679*^9, 3.758128681610401*^9, 
   3.7581755503683043`*^9, 3.7592247436229143`*^9, 3.759291658863171*^9, 
   3.759293738069869*^9, 3.7592968997728033`*^9, 3.759312173020878*^9, 
   3.7593739607823973`*^9, 3.7593759120227537`*^9, 3.759385819212479*^9, 
   3.759404459095173*^9, 3.7594056206188717`*^9, 3.759407972623829*^9, 
   3.759409174938139*^9, 3.759472813845848*^9, 3.7606922092060947`*^9, 
   3.7643274720939083`*^9, 3.764782181211669*^9, 3.7647827895605297`*^9, 
   3.764783119083144*^9},ExpressionUUID->"42d725e5-e2e5-47e6-aa4b-\
36c7d3bd7d7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{
  3.757517086047789*^9},ExpressionUUID->"d447028b-20ad-4a47-9211-\
1e7fac3a2d9e"],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{
  3.757513855942979*^9, 3.757517155574664*^9, 3.7575262984202547`*^9, 
   3.757526336886207*^9, 3.7575266789349527`*^9, 3.757526844649848*^9, 
   3.757527849702458*^9, 3.757533831924796*^9, 3.757534367584483*^9, 
   3.757534492682686*^9, 3.757534815849606*^9, 3.757581455587051*^9, 
   3.757607586856984*^9, 3.7576077257684298`*^9, 3.757610005159212*^9, 
   3.7576116901998997`*^9, 3.757611775625259*^9, 3.7576119332769823`*^9, {
   3.757689894591724*^9, 3.7576899233163557`*^9}, 3.7576899755705223`*^9, 
   3.757690022974831*^9, 3.757690095714569*^9, 3.757690217719378*^9, {
   3.757690284555942*^9, 3.757690336576419*^9}, 3.7576928124567223`*^9, 
   3.7577134119195757`*^9, 3.758114365557393*^9, 3.75812653601613*^9, 
   3.758126568290965*^9, {3.758126606133133*^9, 3.7581266443816233`*^9}, {
   3.758126674504735*^9, 3.758126700959453*^9}, 3.7581267434284277`*^9, 
   3.758127157723207*^9, 3.758127379411491*^9, 3.7581286816318283`*^9, 
   3.7581755503980494`*^9, 3.759224743797196*^9, 3.759291658876234*^9, 
   3.7592937380867968`*^9, 3.759296899788945*^9, 3.759312173071954*^9, 
   3.7593739608166857`*^9, 3.7593759120884438`*^9, 3.759385819279068*^9, 
   3.7594044591158733`*^9, 3.759405620641798*^9, 3.759407972654917*^9, 
   3.759409174961364*^9, 3.759472813872677*^9, 3.7606922092909307`*^9, 
   3.764327472168694*^9, 3.764782181235927*^9, 3.764782789591098*^9, 
   3.764783119110969*^9},ExpressionUUID->"1f59a84e-23e6-435b-a10a-\
dadbc570e767"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"outu", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}]}], ";", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"outu", "/", 
      RowBox[{"outu", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"u", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "u"}], "]"}]}]], "Input",\

 CellChangeTimes->{
  3.757517086690818*^9, {3.757526739139522*^9, 3.757526744603932*^9}, {
   3.757689950230053*^9, 3.757689950405694*^9}, {3.7576900756215057`*^9, 
   3.757690075989696*^9}, {3.758126637897923*^9, 3.7581266387905483`*^9}, 
   3.761712732410679*^9},ExpressionUUID->"0215da3a-e841-40cb-abd9-\
156bb1cc181f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.757513861626155*^9, 3.757517155610474*^9, 3.75752629846082*^9, 
   3.757526336942314*^9, 3.757526678985674*^9, 3.757526844688712*^9, 
   3.7575278497316523`*^9, 3.757533831954011*^9, 3.7575343676162577`*^9, 
   3.757534492710052*^9, 3.7575348158870487`*^9, 3.757581455614031*^9, 
   3.757607586949301*^9, 3.757607725800746*^9, 3.7576100051849937`*^9, 
   3.75761169022532*^9, 3.757611775659951*^9, 3.757611933315181*^9, {
   3.757689894634202*^9, 3.757689923355969*^9}, 3.7576899756015787`*^9, 
   3.7576900229996367`*^9, 3.757690095743063*^9, 3.757690217744504*^9, {
   3.757690284581551*^9, 3.757690336610894*^9}, 3.757692812483527*^9, 
   3.757713411936179*^9, 3.758114366684202*^9, 3.758126536051042*^9, 
   3.758126568324785*^9, {3.758126606167473*^9, 3.758126644407826*^9}, {
   3.758126674526555*^9, 3.758126700983267*^9}, 3.758126743449931*^9, 
   3.758127157743595*^9, 3.758127379429139*^9, 3.7581286816527233`*^9, 
   3.758175550423798*^9, 3.7592247438306828`*^9, 3.759291658890082*^9, 
   3.759293738103408*^9, 3.7592968998050213`*^9, 3.759312173121914*^9, 
   3.759373960876017*^9, 3.759375912138587*^9, 3.759385819347728*^9, 
   3.759404459135445*^9, 3.75940562066826*^9, 3.759407972685698*^9, 
   3.7594091749855413`*^9, 3.759472813920164*^9, 3.760692209367092*^9, 
   3.764327472256225*^9, 3.76478218126057*^9, 3.764782789622039*^9, 
   3.764783119140098*^9},ExpressionUUID->"9571e67a-1591-40a5-9b7b-\
a065b0250c0b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposition of isometries from m to n qubits", "Subsection",
 CellChangeTimes->{{3.7591443343248568`*^9, 3.7591443372285547`*^9}, {
  3.759379323941525*^9, 3.759379337069132*^9}, {3.7593800216941233`*^9, 
  3.759380026961606*^9}},ExpressionUUID->"d9ed62b5-c7b8-43fe-8332-\
371f660cf1cd"],

Cell["\<\
We provide different methods to decompose arbitrary isometries from m to n \
qubits. Recall that an isometry from m to n qubits corresponds to a unitary \
operation on n qubits where n-m qubits start in a fixed state |0>.  \
\>", "Text",
 CellChangeTimes->{{3.757515650460382*^9, 3.75751568117214*^9}, {
  3.757515815096552*^9, 3.7575158424490557`*^9}, {3.759379129091919*^9, 
  3.7593791667072268`*^9}, {3.759380098156802*^9, 
  3.7593802100193253`*^9}},ExpressionUUID->"839b682f-b426-442a-b7ad-\
7f73e328688a"],

Cell["\<\
The method DecIsometry choses automatically the method that achieves the \
lowest CNOT count. Let\[CloseCurlyQuote]s consider how to decompose a random \
isometry from one qubit to three qubits.\
\>", "Text",
 CellChangeTimes->{{3.757515650460382*^9, 3.75751568117214*^9}, {
  3.757515815096552*^9, 3.7575158424490557`*^9}, {3.759379129091919*^9, 
  3.7593791667072268`*^9}, {3.759380098156802*^9, 3.759380336092475*^9}, {
  3.759404754795334*^9, 
  3.759404757476946*^9}},ExpressionUUID->"51ace522-1ae5-4666-a664-\
a9d42dda5367"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"RPickRandomIsometry", "[", 
    RowBox[{
     RowBox[{"2", "^", "1"}], ",", 
     RowBox[{"2", "^", "3"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.759380340582904*^9, 
  3.759380346900711*^9}},ExpressionUUID->"cecf720f-a8c7-4df0-b233-\
3598e2af642f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"DecIsometry", "[", "u", "]"}]}]], "Input",
 CellChangeTimes->{{3.759380327902721*^9, 
  3.759380331158306*^9}},ExpressionUUID->"76b62c6a-be13-45a0-b257-\
50a2bff735c1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.1780972450961749`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.6150276363163085`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.141592653589796`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.7671458676442588`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.938430022368532`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.141592653589793`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.9384300223685313`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.150697235537715`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.4643304007785958`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.1798060848309118`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.1415926535897936`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.7389737066730153`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.141592653589794`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.0326417070844807`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.141592653589793`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.3737136959994808`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.141592653589793`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.4734740852423758`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4.138741737319595`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.5707963267948966`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.22888419319990075`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.5707963267948968`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.3643406002946925`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\[Pi]", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.5368167520286429`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.5089876762129686`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.7887144044412868`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.5707963267948966`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "5.2559062797383955`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.5707963267948977`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.71238898038469`", ",", "3"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.759380363774*^9, 3.759385820267582*^9, 
  3.759404459756445*^9, 3.759405621379443*^9, 3.759407973357534*^9, 
  3.7594091757206993`*^9, 3.759472814808878*^9, 3.7606922103338737`*^9, 
  3.764327473182054*^9, 3.764782181978568*^9, 3.7647827902897663`*^9, 
  3.764783119830977*^9},ExpressionUUID->"3ea00fcf-2cd5-4fa8-8bec-\
cb937e5a1bf8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.7593805864159803`*^9, 
  3.759380593525592*^9}},ExpressionUUID->"f25eba4d-1bba-4274-9e9b-\
8e3dda7e030b"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -1.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -1.}, {11., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -1.}, {12., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -1.}, {13., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{13., -1.}, {14., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{14., -1.}, {15., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{15., -1.}, {16., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{16., -1.}, {17., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{17., -1.}, {18., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{18., -1.}, {19., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{19., -1.}, {20., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{20., -1.}, {21., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{21., -1.}, {22., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{22., -1.}, {23., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{23., -1.}, {24., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{24., -1.}, {25., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{25., -1.}, {26., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{26., -1.}, {27., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{27., -1.}, {28., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{28., -1.}, {29., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{29., -1.}, {30., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {10., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {9., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -2.}, {11., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {12., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -2.}, {13., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{13., -2.}, {14., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{14., -2.}, {15., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{15., -2.}, {16., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{16., -2.}, {17., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{17., -2.}, {18., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{18., -2.}, {19., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{19., -2.}, {20., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{20., -2.}, {21., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{21., -2.}, {22., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{22., -2.}, {23., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{23., -2.}, {24., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{24., -2.}, {25., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{24., -2.}, {24., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{25., -2.}, {26., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{26., -2.}, {27., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{27., -2.}, {28., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{27., -2.}, {27., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{28., -2.}, {29., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{29., -2.}, {30., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -3.}, {10., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{24., -3.}, {25., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{27., -3.}, {28., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -3.}, {2., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {3., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -3.}, {4., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -3.}, {7., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -3.}, {8., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -3.}, {9., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -3.}, {11., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -3.}, {12., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -3.}, {13., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -3.}, {12., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{13., -3.}, {14., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{14., -3.}, {15., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{15., -3.}, {16., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{15., -3.}, {15., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{16., -3.}, {17., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{17., -3.}, {18., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{18., -3.}, {19., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{18., -3.}, {18., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{19., -3.}, {20., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{20., -3.}, {21., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{21., -3.}, {22., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{21., -3.}, {21., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{22., -3.}, {23., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{23., -3.}, {24., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{25., -3.}, {26., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{26., -3.}, {27., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{28., -3.}, {29., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{29., -3.}, {30., -3.}}]}}, {
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -1.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -1.2}, {3.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -1.2}, {5., -0.8}}], 
       LineBox[{{4.8, -1.}, {5.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -1.2}, {6.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -1.}]}}, 
     {GrayLevel[0], DiskBox[{7., -1.}, 0.1]}, {}, {}, {}, {}, {}, {}, {}, 
     {GrayLevel[0], DiskBox[{15., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{15.8, -1.2}, {16.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {16., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{16.8, -1.2}, {17.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {17., -1.}]}}, {}, {}, {}, 
     {GrayLevel[0], DiskBox[{21., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{21.8, -1.2}, {22.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {22., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{22.8, -1.2}, {23.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"Rz\"\>", {23., -1.}]}}, {}, {}, {}, {}, {}, {}, {}, 
     {GrayLevel[0], DiskBox[{5., -3.}, 0.1]}, 
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -2.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -2.2}, {3.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -2.2}, {4.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -2.}]}}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{7., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{7., -2.2}, {7., -1.8}}], 
       LineBox[{{6.8, -2.}, {7.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{7.8, -2.2}, {8.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {8., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{9., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{9., -2.2}, {9., -1.8}}], 
       LineBox[{{8.8, -2.}, {9.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -2.2}, {10.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {10., -2.}]}}, {}, 
     {GrayLevel[0], DiskBox[{12., -2.}, 0.1]}, {}, {}, {}, {}, {}, 
     {GrayLevel[0], DiskBox[{18., -2.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{18.8, -2.2}, {19.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {19., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{19.8, -2.2}, {20.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {20., -2.}]}}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{24., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{24., -2.2}, {24., -1.8}}], 
       LineBox[{{23.8, -2.}, {24.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{24.8, -2.2}, {25.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {25., -2.}]}}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{27., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{27., -2.2}, {27., -1.8}}], 
       LineBox[{{26.8, -2.}, {27.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{27.8, -2.2}, {28.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {28., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{28.8, -2.2}, {29.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {29., -2.}]}}, {}, 
     {GrayLevel[0], DiskBox[{9., -3.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{24., -3.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{27., -3.}, 0.1]}, {}, {}, {}, {}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -3.2}, {10.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {10., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{10.8, -3.2}, {11.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {11., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{12., -3.}, 0.2], 
      {GrayLevel[0], LineBox[{{12., -3.2}, {12., -2.8}}], 
       LineBox[{{11.8, -3.}, {12.2, -3.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.8, -3.2}, {13.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {13., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{13.8, -3.2}, {14.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {14., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{15., -3.}, 0.2], 
      {GrayLevel[0], LineBox[{{15., -3.2}, {15., -2.8}}], 
       LineBox[{{14.8, -3.}, {15.2, -3.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{15.8, -3.2}, {16.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {16., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{16.8, -3.2}, {17.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {17., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{18., -3.}, 0.2], 
      {GrayLevel[0], LineBox[{{18., -3.2}, {18., -2.8}}], 
       LineBox[{{17.8, -3.}, {18.2, -3.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{18.8, -3.2}, {19.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {19., -3.}]}}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{21., -3.}, 0.2], 
      {GrayLevel[0], LineBox[{{21., -3.2}, {21., -2.8}}], 
       LineBox[{{20.8, -3.}, {21.2, -3.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{21.8, -3.2}, {22.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {22., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{22.8, -3.2}, {23.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {23., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{24.8, -3.2}, {25.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {25., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{25.8, -3.2}, {26.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {26., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{27.8, -3.2}, {28.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {28., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{28.8, -3.2}, {29.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {29., -3.}]}}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxd0j1OhGAQBmBiRbnFFhQUSAghhBDYBRbYHz2DpaWJtUfUI3kENfKZ+Ewy
mTwz5Tv3L29Pr3dRFD1/98/8rc+Hbb5vi8f/jvEO73GCU5zhHBe4xBWucYNb
3OEeH/ARD3jEEz7hGS94xWd8wVd8wyGf+GPbb3lHm0PewTHe4T1OcIoznOMC
l7jCNW5wizvc4wM+4gGPeMInPOMFr/iML/iKbzjfHPKe8RmHfwiOuMd4hxOc
4gwXuMQVrnGDW9zhHh/wEQ94xBM+4QWv+IKv+PbnL17Lijo=
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{883.0021385209711, Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.759380594296196*^9, 3.759385820420754*^9, 
  3.759404459841546*^9, 3.759405621432233*^9, 3.759407973435361*^9, 
  3.75940917576978*^9, 3.7594728149100533`*^9, 3.760692210542506*^9, 
  3.764327473402527*^9, 3.764782182099679*^9, 3.764782790364623*^9, 
  3.764783119907579*^9},ExpressionUUID->"04036784-5f60-46d0-9b33-\
ce16c09b84c7"]
}, Open  ]],

Cell[TextData[{
 "When multiplying together the gates in a decomposition of an isometry from \
m to n qubits, the first ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["2", "m"], TraditionalForm]],ExpressionUUID->
  "d2d398c7-d41f-4de9-a3f6-660005bca7fd"],
 " columns match the isometry up to phase.  For example, in an isometry from \
1 qubit to 3, the first two columns match"
}], "Text",
 CellChangeTimes->{{3.757515650460382*^9, 3.75751568117214*^9}, {
  3.757515815096552*^9, 3.7575158424490557`*^9}, {3.759379129091919*^9, 
  3.7593791667072268`*^9}, {3.759380616473236*^9, 
  3.759380616639123*^9}},ExpressionUUID->"1243321f-ff53-47ad-9d71-\
5b32271566d4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"outu", "=", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"2", "^", "3"}], "]"}]}], ";", 
  RowBox[{"gatelist2", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{"gatelist", ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "_", ",", "_"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "gatelist2", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"outu", "=", 
     RowBox[{
      RowBox[{"ListFormToOp", "[", 
       RowBox[{
        RowBox[{"gatelist2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "3"}], "]"}], ".", "outu"}]}]}],
    "]"}], ";", 
  RowBox[{
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"outu", "/", 
      RowBox[{"outu", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"u", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], "//", 
   "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.75752706565029*^9, 3.757527200715087*^9}, {
  3.757690203176901*^9, 3.757690203249426*^9}, {3.75769025805585*^9, 
  3.7576902764873962`*^9}, {3.7593803716312017`*^9, 3.759380372925124*^9}, {
  3.759380408513885*^9, 
  3.75938040862963*^9}},ExpressionUUID->"70725ed5-c610-4137-b961-\
b1005d3124dd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.7145261722317675`", 
      RowBox[{"-", "0.42547390698884713`"}], 
      RowBox[{
       RowBox[{"-", "0.033176831954027146`"}], "+", 
       RowBox[{"0.0800959576599868`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.12059704784789678`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2911470284965504`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.022214424976893896`"}], "-", 
       RowBox[{"0.11167945598120518`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0022625237301955622`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.011374474900686505`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.04752850245536728`"}], "-", 
       RowBox[{"0.009454006941407132`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.42316012788264235`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.08417178281781551`", " ", "\[ImaginaryI]"}]}]},
     {"0.2240181977382128`", "0.3119358463106383`", 
      RowBox[{
       RowBox[{"-", "0.019677016505365658`"}], "+", 
       RowBox[{"0.04750452011429315`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.16513033759050466`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.39865990057024375`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.024043988814162323`"}], "-", 
       RowBox[{"0.12087729451367073`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1327037194401412`"}], "-", 
       RowBox[{"0.6671466494934127`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11115548382410789`"}], "-", 
       RowBox[{"0.022110200434684684`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.4078716789096108`"}], "-", 
       RowBox[{"0.08113072123902716`", " ", "\[ImaginaryI]"}]}]},
     {"0.12486279770883034`", "0.270668794559549`", 
      RowBox[{"0.2644780043398943`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6385063850267428`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.06270890297159172`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.1513926840355544`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.10692054391445034`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.5375258729406919`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.008254505765285733`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.04149820282180515`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.25379114457074753`"}], "-", 
       RowBox[{"0.0504821973865603`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.19003411165028494`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0378001350312483`", " ", "\[ImaginaryI]"}]}]},
     {"0.13819944254620656`", "0.258694079633418`", 
      RowBox[{
       RowBox[{"-", "0.035526474974026764`"}], "+", 
       RowBox[{"0.08576849770560298`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.15492142495764696`"}], "+", 
       RowBox[{"0.37401340523491694`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.04165957687402756`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2094368360440516`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.09304339353803114`"}], "-", 
       RowBox[{"0.4677607268151494`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5205870296503518`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.10355119849489618`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.4237662799902979`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.08429235396854044`", " ", "\[ImaginaryI]"}]}]},
     {"0.5179554373169178`", 
      RowBox[{"-", "0.10543697723489694`"}], 
      RowBox[{
       RowBox[{"-", "0.004141579093033751`"}], "+", 
       RowBox[{"0.009998656416044341`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11392642963093401`"}], "+", 
       RowBox[{"0.27504273152774356`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07011897312496465`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35251188273844797`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.04153299589373598`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.20880047048287673`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.24206216538756287`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.048149158370286674`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6175396659874843`"}], "-", 
       RowBox[{"0.12283627691241367`", " ", "\[ImaginaryI]"}]}]},
     {"0.11143857643463692`", "0.6110261438904073`", 
      RowBox[{
       RowBox[{"-", "0.09479572861037809`"}], "+", 
       RowBox[{"0.228857133666214`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.15915677700332245`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.38423844958500936`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.00803414532444827`"}], "-", 
       RowBox[{"0.040390376075076256`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.09761368567737375`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.4907371369778203`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.34195622789199387`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.06801932283021424`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07777709077020287`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.015470825253004304`", " ", "\[ImaginaryI]"}]}]},
     {"0.11781611514499744`", "0.03749632354560218`", 
      RowBox[{"0.2494312485550549`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6021803031412674`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.039581394202780784`"}], "+", 
       RowBox[{"0.09555793870198952`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.12541982881719646`"}], "-", 
       RowBox[{"0.6305280585083545`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.009521907897358706`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.047869863612774816`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3490734818088695`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0694350326560622`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.08103708931015717`"}], "-", 
       RowBox[{"0.016119279280240185`", " ", "\[ImaginaryI]"}]}]},
     {"0.3316645349662613`", "0.44227579642906345`", 
      RowBox[{
       RowBox[{"-", "0.05028564854991067`"}], "+", 
       RowBox[{"0.12140029472192072`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1918986212560239`"}], "+", 
       RowBox[{"0.46328425403699164`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.055765269381518955`"}], "-", 
       RowBox[{"0.2803509410507463`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.01937884211043477`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.09742401825346018`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.5608244076488749`"}], "-", 
       RowBox[{"0.1115549106097329`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.08278657838951865`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.01646727429472101`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.757527113843692*^9, 3.757527201206946*^9}, 
   3.757527853211667*^9, 3.7575338361348124`*^9, 3.7575343715749493`*^9, 
   3.757534819938993*^9, 3.757581459516374*^9, 3.757607730508882*^9, 
   3.757610009584359*^9, 3.757611694933392*^9, 3.757611780125017*^9, 
   3.757611938340271*^9, 3.7576900279852533`*^9, 3.757690100840515*^9, 
   3.757690222786511*^9, {3.757690289553319*^9, 3.757690341829267*^9}, 
   3.7576928173898897`*^9, 3.757713415578573*^9, 3.758114425834635*^9, {
   3.7581266785882*^9, 3.7581267050469427`*^9}, 3.758126747456976*^9, 
   3.758127161869753*^9, 3.75812738355756*^9, 3.758128685610046*^9, 
   3.7581755547968893`*^9, 3.7592247663562593`*^9, 3.7592916741282463`*^9, 
   3.759293753679083*^9, 3.7592969152860327`*^9, 3.759312197970851*^9, 
   3.759373982268421*^9, 3.759375934669467*^9, 3.75937906163612*^9, {
   3.7593803796059017`*^9, 3.7593804089113092`*^9}, 3.759380640326838*^9, 
   3.7593858204960403`*^9, 3.7594044598562603`*^9, 3.759405621446229*^9, 
   3.759407973470665*^9, 3.7594091757952967`*^9, 3.75947281499469*^9, 
   3.760692210683477*^9, 3.764327473518921*^9, 3.764782182143911*^9, 
   3.764782790398613*^9, 
   3.7647831199344597`*^9},ExpressionUUID->"319f3846-1c4f-4f30-a1ea-\
1add4374d03f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"u", "//", "MatrixForm"}]], "Input",ExpressionUUID->"b5e93143-638f-4417-81b1-9060d3e72248"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.7145261722317675`", 
      RowBox[{"-", "0.42547390698884735`"}]},
     {"0.22401819773821297`", "0.3119358463106385`"},
     {"0.12486279770882894`", "0.27066879455954845`"},
     {"0.13819944254620647`", "0.2586940796334179`"},
     {"0.5179554373169183`", 
      RowBox[{"-", "0.10543697723489662`"}]},
     {"0.11143857643463778`", "0.6110261438904072`"},
     {"0.11781611514499667`", "0.037496323545602145`"},
     {"0.3316645349662603`", "0.4422757964290634`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.757527221112061*^9, 3.757527853240086*^9, 3.757533836201303*^9, 
   3.7575343716054583`*^9, 3.757534819973804*^9, 3.7575814595437117`*^9, 
   3.757607730537279*^9, 3.757610009617577*^9, 3.757611694963902*^9, 
   3.757611780160906*^9, 3.7576119383786793`*^9, 3.757690027990859*^9, 
   3.7576901008453093`*^9, 3.7576902227942657`*^9, {3.75769028955859*^9, 
   3.75769034185874*^9}, 3.757692817395665*^9, 3.757713415596813*^9, 
   3.758114427696093*^9, {3.758126678611354*^9, 3.758126705071939*^9}, 
   3.7581267474779167`*^9, 3.758127161889701*^9, 3.758127383574951*^9, 
   3.758128685631798*^9, 3.758175554814822*^9, 3.7592247664171963`*^9, 
   3.75929167414288*^9, 3.7592937536976843`*^9, 3.759296915301846*^9, 
   3.75931219818582*^9, 3.759373982320374*^9, 3.7593759347374287`*^9, 
   3.7593790644929457`*^9, 3.7593790998560753`*^9, 3.759380419030512*^9, 
   3.759380644923151*^9, 3.759385820580612*^9, 3.759404459883809*^9, 
   3.759405621468782*^9, 3.7594079735025253`*^9, 3.759409175821397*^9, 
   3.7594728150016537`*^9, 3.760692210740828*^9, 3.764327473593316*^9, 
   3.764782182166548*^9, 3.7647827904289923`*^9, 
   3.7647831199584627`*^9},ExpressionUUID->"8d9eefbd-6c84-44df-833c-\
4777003d5957"]
}, Open  ]],

Cell["\<\
We can also use CreateOperationFromGateList to directly give the isometry\
\>", "Text",
 CellChangeTimes->{{3.7575272240920467`*^9, 3.75752724389215*^9}, {
   3.7581144552753057`*^9, 3.7581144576544237`*^9}, 
   3.76171273244508*^9},ExpressionUUID->"426b4ed2-9f72-4be8-aefd-\
5e53cc097a94"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"outu", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}], "]"}]}], 
  ";", 
  RowBox[{
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"outu", "/", 
       RowBox[{"outu", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
      RowBox[{"u", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "u"}], "]"}], "//", 
   "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.75751572086311*^9, 3.757515740636297*^9}, 
   3.757517098923085*^9, {3.757526777098508*^9, 3.757526785625703*^9}, {
   3.757526907384047*^9, 3.7575269111504383`*^9}, {3.757527031822918*^9, 
   3.757527043931292*^9}, 3.757527134637731*^9, {3.757527265739305*^9, 
   3.757527269591154*^9}, {3.757690039924809*^9, 3.75769006044331*^9}, {
   3.758114441907103*^9, 3.758114444719627*^9}, 
   3.761712732487369*^9},ExpressionUUID->"02defd4b-819d-431d-82a6-\
3a3fff8dda67"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"},
     {"0", "0"},
     {"0", "0"},
     {"0", "0"},
     {"0", "0"},
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.757527135029463*^9, {3.7575272595360813`*^9, 3.75752728133337*^9}, 
   3.757527853269623*^9, 3.7575338362307034`*^9, 3.757534371637348*^9, 
   3.757534820009842*^9, 3.75758145957154*^9, 3.757607730566894*^9, 
   3.75761000964856*^9, 3.7576116949969177`*^9, 3.7576117801963577`*^9, 
   3.7576119384196033`*^9, 3.757690028039747*^9, 3.757690100869485*^9, 
   3.7576902228204327`*^9, {3.757690289584671*^9, 3.757690341891426*^9}, 
   3.757692817423596*^9, 3.757713415614675*^9, {3.7581144307411118`*^9, 
   3.7581144451369963`*^9}, {3.7581266786346283`*^9, 3.758126705097583*^9}, 
   3.758126747498641*^9, 3.758127161910061*^9, 3.758127383596146*^9, 
   3.758128685652731*^9, 3.758175554832616*^9, 3.759224766454772*^9, 
   3.759291674157939*^9, 3.759293753716095*^9, 3.759296915317739*^9, 
   3.759312198470747*^9, 3.759373982370358*^9, 3.759375934803872*^9, 
   3.759380433837276*^9, 3.759380676714839*^9, 3.759385820662167*^9, 
   3.759404459904634*^9, 3.759405621490394*^9, 3.7594079735335007`*^9, 
   3.7594091758455057`*^9, 3.759472815047071*^9, 3.7606922107690353`*^9, 
   3.7643274736781807`*^9, 3.764782182189188*^9, 3.764782790459247*^9, 
   3.7647831199825087`*^9},ExpressionUUID->"441e9a73-dee2-4bb9-8659-\
07fd66608d29"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CNOT counts for different decompositions", "Subsubsection",
 CellChangeTimes->{{3.75914441405912*^9, 3.759144436608555*^9}, {
  3.759391632701742*^9, 3.759391637467333*^9}, {3.7594048179020557`*^9, 
  3.759404818391675*^9}},ExpressionUUID->"8248c181-52f1-4304-9112-\
3f356503b37f"],

Cell["\<\
Instead of using DecIsometry, a specific method to decompose an isometry can \
be chosen (in particular, to lower the run time). Which method is best (and \
chosen by DecIsometry) depends on the situation\
\>", "Text",
 CellChangeTimes->{{3.757513885371943*^9, 3.757513904226548*^9}, 
   3.757517087147273*^9, {3.757517148446698*^9, 3.757517149318984*^9}, {
   3.759380742762426*^9, 3.759380815584895*^9}, {3.7593808971576567`*^9, 
   3.759380936314172*^9}, {3.759404826036273*^9, 
   3.759404830270969*^9}},ExpressionUUID->"1adc78f9-f9af-43db-be3d-\
d4983d365628"],

Cell["For a full unitary on 4 qubits:", "Text",
 CellChangeTimes->{{3.757514027956024*^9, 3.757514031724853*^9}, {
  3.757514064177796*^9, 
  3.757514065492021*^9}},ExpressionUUID->"c846ee9b-b100-4128-baba-\
e11a43d42986"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"PickRandomUnitary", "[", "16", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.757513909914626*^9, 
  3.7575139260447283`*^9}},ExpressionUUID->"ea93d721-0c64-489a-b5b4-\
b17e19730c76"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"QSD", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7575139293933077`*^9, 
  3.757513947674231*^9}},ExpressionUUID->"b975efc1-5379-4742-b79c-\
7b5908e65f09"],

Cell[BoxData["100"], "Output",
 CellChangeTimes->{
  3.757513948275826*^9, 3.7575171559026527`*^9, 3.757526298723926*^9, 
   3.757526337218103*^9, 3.757526679274411*^9, 3.757526844974599*^9, 
   3.75752785001691*^9, 3.757533832226267*^9, 3.757534367894978*^9, 
   3.757534492999592*^9, 3.75753481617484*^9, 3.757581455887669*^9, 
   3.757607600879819*^9, 3.7576077260654593`*^9, 3.757610005466268*^9, 
   3.757611690505246*^9, 3.757611775951602*^9, 3.75761193362527*^9, {
   3.7576898949583187`*^9, 3.757689923674185*^9}, 3.75768997592759*^9, 
   3.757690023320612*^9, 3.757690096103963*^9, 3.7576902180718803`*^9, {
   3.757690284919379*^9, 3.75769033694912*^9}, 3.757692812809441*^9, 
   3.75771341217866*^9, 3.758114369401052*^9, 3.758126536350039*^9, 
   3.75812656862078*^9, {3.758126606462902*^9, 3.75812664470969*^9}, {
   3.7581266748304567`*^9, 3.758126701305655*^9}, 3.75812674374771*^9, 
   3.7581271580405617`*^9, 3.7581273797369328`*^9, 3.758128681946753*^9, 
   3.758175550936152*^9, 3.759224744640854*^9, 3.759291659434923*^9, 
   3.7592937386579647`*^9, 3.759296900354412*^9, 3.759312173937607*^9, 
   3.7593739616759987`*^9, 3.7593759129649982`*^9, 3.7593858215254507`*^9, 
   3.7594044604788103`*^9, 3.7594056220751057`*^9, 3.759407974128428*^9, 
   3.7594091764137163`*^9, 3.759472815891061*^9, 3.7606922116694593`*^9, 
   3.764327474582797*^9, 3.764782182785151*^9, 3.7647827910651627`*^9, 
   3.764783120585413*^9},ExpressionUUID->"ace25f21-62b3-497e-b4c2-\
d60614c4f49a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"KnillDec", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757513955113896*^9, 3.757513959698237*^9}, 
   3.763036577627475*^9},ExpressionUUID->"b213a2a5-87f1-429f-8e76-\
083b077a36b3"],

Cell[BoxData["422"], "Output",
 CellChangeTimes->{
  3.757513961017724*^9, 3.757517156673811*^9, 3.7575262995007963`*^9, 
   3.757526337944811*^9, 3.757526679973979*^9, 3.757526845677825*^9, 
   3.7575278507286253`*^9, 3.757533832940878*^9, 3.757534368602188*^9, 
   3.757534493721158*^9, 3.757534816909255*^9, 3.757581456583001*^9, 
   3.757607726881089*^9, 3.75761000622823*^9, 3.75761169122589*^9, 
   3.757611776737494*^9, 3.7576119344869537`*^9, {3.7576898957971773`*^9, 
   3.7576899245333433`*^9}, 3.7576899768161907`*^9, 3.75769002420153*^9, 
   3.7576900969957323`*^9, 3.757690218931039*^9, {3.757690285798297*^9, 
   3.757690337890942*^9}, 3.7576928137039537`*^9, 3.757713412821517*^9, 
   3.758114371252014*^9, 3.758126537063684*^9, 3.758126569334358*^9, {
   3.7581266071913357`*^9, 3.7581266454317007`*^9}, {3.758126675562216*^9, 
   3.7581267020427847`*^9}, 3.758126744471078*^9, 3.7581271587885427`*^9, 
   3.758127380477454*^9, 3.758128682661324*^9, 3.758175551725049*^9, 
   3.759224756250051*^9, 3.75929166822227*^9, 3.75929374766918*^9, 
   3.7592969091712008`*^9, 3.759312186636507*^9, 3.759373973256155*^9, 
   3.759375924966354*^9, 3.759385834049831*^9, 3.759404469661375*^9, 
   3.759405631392168*^9, 3.7594079834544067`*^9, 3.7594091857890577`*^9, 
   3.759472828617434*^9, 3.760692224162711*^9, 3.764327487134315*^9, 
   3.764782192851677*^9, 3.76478280099247*^9, 
   3.764783130616523*^9},ExpressionUUID->"549ea625-e7be-4ab5-abef-\
db42722be71d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"ColumnByColumnDec", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757513968957479*^9, 
  3.7575139713634*^9}},ExpressionUUID->"0d3f0839-bc4c-4f9a-86da-564bff51623d"],

Cell[BoxData["218"], "Output",
 CellChangeTimes->{
  3.757513972673992*^9, 3.757517157593008*^9, 3.757526300327484*^9, 
   3.757526338752906*^9, 3.757526680816394*^9, 3.757526846514328*^9, 
   3.757527851603117*^9, 3.757533833893992*^9, 3.7575343694453783`*^9, 
   3.757534494638358*^9, 3.757534817714163*^9, 3.757581457487355*^9, 
   3.757607727839807*^9, 3.757610007056279*^9, 3.757611692218601*^9, 
   3.7576117775903587`*^9, 3.757611935461638*^9, {3.757689896807572*^9, 
   3.75768992553292*^9}, 3.757689977789549*^9, 3.757690025248258*^9, 
   3.7576900979868507`*^9, 3.75769021994129*^9, {3.757690286797585*^9, 
   3.757690338875963*^9}, 3.757692814678994*^9, 3.7577134136054163`*^9, 
   3.75811437272036*^9, 3.7581265379043493`*^9, 3.758126570165649*^9, {
   3.758126608026972*^9, 3.758126646293202*^9}, {3.7581266764221783`*^9, 
   3.758126702860613*^9}, 3.75812674529471*^9, 3.758127159642873*^9, 
   3.758127381302889*^9, 3.7581286834813147`*^9, 3.758175552535076*^9, 
   3.7592247582045107`*^9, 3.759291669549652*^9, 3.7592937490105963`*^9, 
   3.759296910516429*^9, 3.7593121885747766`*^9, 3.759373975050942*^9, 
   3.759375926876954*^9, 3.759385835986677*^9, 3.7594044710429564`*^9, 
   3.759405632816448*^9, 3.759407984859729*^9, 3.759409187158292*^9, 
   3.759472830500839*^9, 3.7606922261949377`*^9, 3.7643274891603928`*^9, 
   3.764782194317642*^9, 3.764782802437035*^9, 
   3.7647831321000013`*^9},ExpressionUUID->"fa68ef85-b338-4c42-a52c-\
68dad38553f9"]
}, Open  ]],

Cell["For an isometry from 1 qubit to 4 qubits", "Text",
 CellChangeTimes->{{3.7575140362797728`*^9, 3.757514059021636*^9}, {
  3.7593808416969557`*^9, 
  3.759380842576087*^9}},ExpressionUUID->"ca8ebe5c-071c-4c2f-a14b-\
3b16420a4e82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"PickRandomIsometry", "[", 
    RowBox[{"2", ",", "16"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.757513909914626*^9, 3.7575139260447283`*^9}, {
  3.757513984812017*^9, 
  3.7575139884589367`*^9}},ExpressionUUID->"4abbf7ab-5f81-4355-b10a-\
47845b224dd5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"QSD", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7575139293933077`*^9, 
  3.757513947674231*^9}},ExpressionUUID->"37d762ca-1478-4ef1-bf6b-\
4bc4c0cc156a"],

Cell[BoxData["67"], "Output",
 CellChangeTimes->{
  3.757513948275826*^9, 3.7575139920101347`*^9, 3.757514415707713*^9, 
   3.7575171579370193`*^9, 3.7575263005513163`*^9, 3.757526338966907*^9, 
   3.757526681021741*^9, 3.757526846727837*^9, 3.75752785181192*^9, 
   3.757533834094179*^9, 3.75753436965827*^9, 3.757534494841495*^9, 
   3.757534817964425*^9, 3.7575814576879787`*^9, 3.7575833850898247`*^9, 
   3.7576077281321287`*^9, 3.757610007269524*^9, 3.7576116924698887`*^9, 
   3.757611777819807*^9, 3.757611935737142*^9, {3.7576898970689907`*^9, 
   3.7576899257943277`*^9}, 3.757689978050502*^9, 3.7576900255098543`*^9, 
   3.7576900983011312`*^9, 3.757690220212455*^9, {3.7576902870579042`*^9, 
   3.757690339142211*^9}, 3.7576928149352818`*^9, 3.757713413782723*^9, 
   3.758114375172327*^9, 3.758126538126267*^9, 3.758126570405302*^9, {
   3.7581266082591877`*^9, 3.758126646517125*^9}, {3.7581266766446257`*^9, 
   3.758126703080192*^9}, 3.7581267455130253`*^9, 3.758127159869212*^9, 
   3.758127381533032*^9, 3.758128683696003*^9, 3.758175552763986*^9, 
   3.7592247588831797`*^9, 3.759291669950221*^9, 3.759293749418181*^9, 
   3.759296910922711*^9, 3.759299099994664*^9, 3.7593121891894617`*^9, 
   3.759373975661463*^9, 3.7593759274781437`*^9, 3.759385836614531*^9, 
   3.759404471463542*^9, 3.759405633230134*^9, 3.7594079852821198`*^9, 
   3.759409187571372*^9, 3.759472831078156*^9, 3.7606922268903027`*^9, 
   3.76432748987176*^9, 3.764782194773408*^9, 3.764782802874723*^9, 
   3.76478313254531*^9},ExpressionUUID->"d62ba9f9-49e4-416f-aacc-\
49fdc0e5df68"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"KnillDec", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757513955113896*^9, 3.757513959698237*^9}, 
   3.763036577639082*^9},ExpressionUUID->"ee3be496-151a-40f6-8812-\
f67f58c6e0f2"],

Cell[BoxData["58"], "Output",
 CellChangeTimes->{
  3.757513961017724*^9, 3.7575139940432377`*^9, 3.7575144158522263`*^9, 
   3.757517158082375*^9, 3.7575263006951017`*^9, 3.757526339106926*^9, 
   3.757526681207715*^9, 3.757526846894663*^9, 3.7575278519702044`*^9, 
   3.757533834308467*^9, 3.757534369827441*^9, 3.757534494894765*^9, 
   3.757534818121442*^9, 3.75758145784483*^9, 3.757583386624135*^9, 
   3.757607728312564*^9, 3.7576100074114*^9, 3.7576116926261883`*^9, 
   3.757611777961356*^9, 3.7576119358775587`*^9, {3.757689897247622*^9, 
   3.757689925972344*^9}, 3.7576899782292547`*^9, 3.757690025679921*^9, 
   3.757690098476042*^9, 3.757690220382025*^9, {3.757690287232706*^9, 
   3.757690339322948*^9}, 3.757692815115459*^9, 3.757713413902763*^9, 
   3.758114376091592*^9, 3.75812653828255*^9, 3.7581265705656776`*^9, {
   3.758126608421095*^9, 3.758126646681924*^9}, {3.7581266767995234`*^9, 
   3.7581267032333813`*^9}, 3.7581267456647043`*^9, 3.75812716003613*^9, 
   3.758127381687626*^9, 3.75812868385052*^9, 3.758175552921895*^9, 
   3.759224759910653*^9, 3.759291670685451*^9, 3.759293750171406*^9, 
   3.759296911661026*^9, 3.7592991007570543`*^9, 3.759312190183346*^9, 
   3.7593739766448298`*^9, 3.759375928565151*^9, 3.759385837668885*^9, 
   3.759404472247772*^9, 3.7594056340176*^9, 3.7594079861400347`*^9, 
   3.759409188339548*^9, 3.759472832109741*^9, 3.76069222803557*^9, 
   3.764327491000772*^9, 3.76478219566343*^9, 3.7647828037097473`*^9, 
   3.764783133405916*^9},ExpressionUUID->"3bb80638-d847-4dcc-9839-\
c575e3b5b864"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"gatelist", "=", 
   RowBox[{"ColumnByColumnDec", "[", "u", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.757513968957479*^9, 3.7575139713634*^9}, {
   3.757514851180253*^9, 3.757514851297124*^9}, 
   3.757517087957159*^9},ExpressionUUID->"fec35c68-ac01-4960-8fd9-\
3eb3f77e78ad"],

Cell[BoxData["25"], "Output",
 CellChangeTimes->{{3.757513972673992*^9, 3.7575139960299273`*^9}, 
   3.757514415976425*^9, 3.757514853454886*^9, 3.757517158203351*^9, 
   3.757526300820459*^9, 3.757526339240733*^9, 3.757526681342348*^9, 
   3.75752684701537*^9, 3.757527852091156*^9, 3.757533834426794*^9, 
   3.757534369945159*^9, 3.757534818241721*^9, 3.7575814579652367`*^9, 
   3.757583388246566*^9, 3.757607728433049*^9, 3.7576100075395193`*^9, 
   3.75761169276945*^9, 3.757611778085948*^9, 3.757611936073337*^9, {
   3.7576898974202843`*^9, 3.7576899261322403`*^9}, 3.757689978391942*^9, 
   3.757690025842227*^9, 3.7576900986599483`*^9, 3.757690220543538*^9, {
   3.757690287398162*^9, 3.757690339489773*^9}, 3.757692815275875*^9, 
   3.757713414026046*^9, 3.758114377046358*^9, 3.758126538398933*^9, 
   3.758126570694907*^9, {3.758126608538498*^9, 3.758126646799758*^9}, {
   3.758126676916134*^9, 3.758126703351993*^9}, 3.758126745782413*^9, 
   3.758127160154521*^9, 3.75812738180543*^9, 3.758128683966576*^9, 
   3.7581755530435*^9, 3.7592247603058977`*^9, 3.759291670871093*^9, 
   3.759293750362384*^9, 3.7592969118498774`*^9, 3.759299100952071*^9, 
   3.759312190474906*^9, 3.759373976927492*^9, 3.759375928855289*^9, 
   3.759385838021859*^9, 3.759404472446751*^9, 3.7594056342137527`*^9, 
   3.759407986341468*^9, 3.759409188537197*^9, 3.7594728323857327`*^9, 
   3.760692228385318*^9, 3.7643274913886423`*^9, 3.7647821958711443`*^9, 
   3.7647828039258137`*^9, 
   3.764783133620841*^9},ExpressionUUID->"a8c1f843-68cb-49f6-b199-\
e514ab415423"]
}, Open  ]],

Cell["\<\
For generic isometries, the CNOT count for the column-by-column decomposition \
can be improved by using a different way to decompose the first column (this \
may increase the running time for large isometries significantly):\
\>", "Text",
 CellChangeTimes->{{3.75758347143896*^9, 3.757583500252845*^9}, {
  3.759376369249198*^9, 3.759376508191821*^9}, {3.75937654848976*^9, 
  3.7593765619605007`*^9}, {3.7593766014351063`*^9, 3.7593766084090033`*^9}, {
  3.759377225971654*^9, 3.759377230863037*^9}, {3.759377536286744*^9, 
  3.75937755733107*^9}, {3.7594048968122387`*^9, 
  3.7594049028500433`*^9}},ExpressionUUID->"f874e417-de6b-40d7-9dd5-\
e065a432a8fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"gatelist", "=", 
   RowBox[{"ColumnByColumnDec", "[", 
    RowBox[{"u", ",", 
     RowBox[{"FirstColumn", "\[Rule]", "\"\<StatePreparation\>\""}]}], 
    "]"}]}], "]"}]], "Input",ExpressionUUID->"8d738cf0-851d-49e3-a935-\
8781b8a7e55a"],

Cell[BoxData["22"], "Output",
 CellChangeTimes->{3.759376524398864*^9, 3.759385838329743*^9, 
  3.75940447266022*^9, 3.7594056344275703`*^9, 3.759407986553266*^9, 
  3.7594091887478857`*^9, 3.75947283269672*^9, 3.7606922287696133`*^9, 
  3.764327491761154*^9, 3.7647821961174593`*^9, 3.764782804150922*^9, 
  3.764783133969822*^9},ExpressionUUID->"b1adda1e-19b8-42b3-9437-\
bd094c5c4b47"]
}, Open  ]],

Cell["\<\
By default simplifications are done automatically. To switch them off use \
Simp->False. For the considered isometry, this gives the same CNOT count of \
the column-by-column decomposition, but with more single-qubit rotations.\
\>", "Text",
 CellChangeTimes->{{3.75758347143896*^9, 3.757583500252845*^9}, {
  3.75937690577352*^9, 3.75937695850838*^9}, {3.759377277529511*^9, 
  3.759377279303603*^9}, {3.7593773313227167`*^9, 3.759377339000237*^9}, {
  3.75940500372019*^9, 
  3.759405027104692*^9}},ExpressionUUID->"da36d355-3b4e-4584-8744-\
13fe188ca18c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"ColumnByColumnDec", "[", 
   RowBox[{"u", ",", 
    RowBox[{"Simp", "\[Rule]", "False"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7593768878384027`*^9, 
  3.759376889912622*^9}},ExpressionUUID->"26a0ec5a-b6c3-4f92-9d7c-\
6845cec7462a"],

Cell[BoxData["25"], "Output",
 CellChangeTimes->{3.759376890492012*^9, 3.759385838508026*^9, 
  3.759404472779334*^9, 3.7594056345442743`*^9, 3.75940798667238*^9, 
  3.759409188864169*^9, 3.7594728328911257`*^9, 3.760692229010627*^9, 
  3.764327492001481*^9, 3.764782196254706*^9, 3.7647828042717657`*^9, 
  3.764783134903364*^9},ExpressionUUID->"bb5dd553-6736-4ee3-a66c-\
33d3d547ef0d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"ColumnByColumnDec", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757583454582328*^9, 3.7575834663168087`*^9}, {
   3.7575835258527803`*^9, 3.7575835279093447`*^9}, {3.757583588210676*^9, 
   3.757583617395234*^9}, {3.757611740205202*^9, 3.757611741524683*^9}, {
   3.757611792419368*^9, 3.7576118318617353`*^9}, 3.759224842365056*^9, {
   3.7593762093732767`*^9, 3.75937621213006*^9}, {3.7593768324068317`*^9, 
   3.7593768636011267`*^9}, 
   3.75937730246332*^9},ExpressionUUID->"87c91cb6-4e7e-4873-bd00-\
56e1785854b0"],

Cell[BoxData["96"], "Output",
 CellChangeTimes->{
  3.757583466758623*^9, {3.757583555711115*^9, 3.757583617947542*^9}, 
   3.757607728946608*^9, 3.757610007969378*^9, 3.757611693278337*^9, 
   3.757611778607605*^9, {3.75761182952567*^9, 3.7576118324401073`*^9}, 
   3.757611936593535*^9, {3.757689897841271*^9, 3.757689926563672*^9}, 
   3.757689978822867*^9, 3.757690026259467*^9, 3.757690099097722*^9, 
   3.757690221044951*^9, {3.75769028785005*^9, 3.757690339965868*^9}, 
   3.75769281570264*^9, 3.757713414384956*^9, 3.758114382525572*^9, 
   3.758126538778813*^9, 3.758126571091414*^9, {3.758126608911873*^9, 
   3.758126647181234*^9}, {3.758126677274775*^9, 3.7581267037255096`*^9}, 
   3.758126746146078*^9, 3.758127160576065*^9, 3.7581273821868353`*^9, 
   3.75812868433916*^9, 3.758175553495132*^9, 3.7592247613729362`*^9, 
   3.759291671481819*^9, 3.759293750984572*^9, 3.75929691223508*^9, 
   3.759299101370943*^9, 3.759312191066979*^9, 3.759373977489326*^9, 
   3.759375929397799*^9, 3.7593762488389473`*^9, 3.7593768380394363`*^9, 
   3.7593768691851463`*^9, 3.759377303179866*^9, 3.759385838772386*^9, 
   3.7594044729567432`*^9, 3.759405634723483*^9, 3.759407986849325*^9, 
   3.759409189051353*^9, 3.759472833155301*^9, 3.76069222932863*^9, 
   3.764327492319152*^9, 3.76478219643827*^9, 3.764782804457364*^9, 
   3.764783135117483*^9},ExpressionUUID->"85861a18-81f1-4167-8789-\
f3dd3423d7cd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"ColumnByColumnDec", "[", 
   RowBox[{"u", ",", 
    RowBox[{"Simp", "\[Rule]", "False"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7593768492772503`*^9, 3.759376867996057*^9}, {
  3.75937730588235*^9, 
  3.7593773134108353`*^9}},ExpressionUUID->"f92742e5-6ca2-4f44-be44-\
bdb4f883b779"],

Cell[BoxData["134"], "Output",
 CellChangeTimes->{{3.759376850689456*^9, 3.759376870294269*^9}, 
   3.759377313976466*^9, 3.759385839007742*^9, 3.759404473072719*^9, 
   3.7594056348384542`*^9, 3.759407986963832*^9, 3.759409189166502*^9, 
   3.759472833367947*^9, 3.7606922296267433`*^9, 3.7643274926269493`*^9, 
   3.764782196555789*^9, 3.764782804576908*^9, 
   3.764783135238888*^9},ExpressionUUID->"49bea0a2-eb1a-445d-9cd5-\
a4d733665686"]
}, Open  ]],

Cell["\<\
DecIsometryGeneric automatically picks the method with the lowest CNOT count \
for a generic isometry (which is the column by column decomposition with the \
option FirstColumn\[Rule]\[CloseCurlyDoubleQuote]StatePreparation\
\[CloseCurlyDoubleQuote] in the considered case).\
\>", "Text",
 CellChangeTimes->{{3.757514377212953*^9, 3.7575143954148006`*^9}, {
   3.757514824654207*^9, 3.757514829425476*^9}, {3.757534848568204*^9, 
   3.757534850186921*^9}, 3.757536024422106*^9, {3.7593773734040937`*^9, 
   3.7593773833445673`*^9}, {3.759377415428261*^9, 
   3.75937745681593*^9}},ExpressionUUID->"ea7ec8f5-a4f9-466f-94d8-\
8044398979f9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"DecIsometryGeneric", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757514397519498*^9, 3.757514408491246*^9}, {
   3.757534853542811*^9, 3.757534854831892*^9}, 
   3.7575360265471992`*^9},ExpressionUUID->"59e20ce0-7ada-4b6a-8f2b-\
4bc2320111be"],

Cell[BoxData["22"], "Output",
 CellChangeTimes->{{3.757514409310978*^9, 3.7575144161018343`*^9}, 
   3.7575171583290987`*^9, 3.7575263009497643`*^9, 3.7575263393714247`*^9, 
   3.757526681459427*^9, 3.757526847136606*^9, 3.757527852210608*^9, 
   3.757533834850566*^9, 3.757534370363071*^9, 3.757534818729354*^9, 
   3.757534859020815*^9, 3.7575814580818777`*^9, 3.757607728560272*^9, 
   3.757610007664735*^9, 3.757611692931239*^9, 3.7576117782118073`*^9, 
   3.757611936219777*^9, {3.757689897584785*^9, 3.7576899262906513`*^9}, 
   3.757689978553925*^9, 3.75769002599994*^9, 3.757690098823606*^9, 
   3.757690220707725*^9, {3.7576902875582027`*^9, 3.7576903396589193`*^9}, 
   3.757692815436861*^9, 3.7577134141312447`*^9, 3.758114378444818*^9, 
   3.758126538492053*^9, 3.758126570786395*^9, {3.7581266086313877`*^9, 
   3.758126646892064*^9}, {3.758126677007263*^9, 3.7581267034496202`*^9}, 
   3.758126745877266*^9, 3.758127160249892*^9, 3.7581273819004917`*^9, 
   3.758128684058769*^9, 3.758175553143111*^9, 3.759224760597863*^9, 
   3.759291671029992*^9, 3.7592937505188417`*^9, 3.75929691238977*^9, 
   3.759299101592889*^9, 3.759312191324751*^9, 3.7593739777416773`*^9, 
   3.759375929631599*^9, 3.759376256771158*^9, 3.75938583924258*^9, 
   3.759404473231269*^9, 3.7594056349978437`*^9, 3.759407987121586*^9, 
   3.759409189327444*^9, 3.7594728336101294`*^9, 3.760692229925761*^9, 
   3.7643274929229403`*^9, 3.76478219672501*^9, 3.764782804742628*^9, 
   3.764783135406933*^9},ExpressionUUID->"07e2203d-40c0-436a-84e0-\
ee849ad62a1f"]
}, Open  ]],

Cell["\<\
As an example for an non generic isometry, we consider an isometry of the \
following simple form:\
\>", "Text",
 CellChangeTimes->{{3.757514085344386*^9, 3.757514089558826*^9}, {
  3.757514166919166*^9, 3.7575141719126472`*^9}, {3.75751472165613*^9, 
  3.757514726011923*^9}, {3.759378334124083*^9, 3.759378387562396*^9}, {
  3.759378460805272*^9, 3.759378461339213*^9}, {3.759378544070867*^9, 
  3.759378566340506*^9}},ExpressionUUID->"702ceced-fbcb-47e7-a98d-\
99932edf260d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"N", "[", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0"},
        {"0", 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}], ")"}]}]},
        {
         RowBox[{"1", "/", "2"}], "0"},
        {"0", "0"},
        {"0", 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}], ")"}]}]},
        {
         RowBox[{"1", "/", "2"}], "0"},
        {
         RowBox[{"1", "/", "2"}], "0"},
        {
         RowBox[{"1", "/", "2"}], "0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7593784475145206`*^9, 3.759378453901505*^9}, {
   3.759378491748426*^9, 3.7593784945801487`*^9}, 3.7593785744466057`*^9, {
   3.759378614632332*^9, 3.759378616268834*^9}, {3.759378714577402*^9, 
   3.759378737038599*^9}, {3.759378773291933*^9, 3.759378788086981*^9}, {
   3.7593788496865377`*^9, 3.75937885776681*^9}, {3.759404912507119*^9, 
   3.759404958269567*^9}},ExpressionUUID->"424ab8e9-05c5-4d90-9e3b-\
d767e9e0203d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"QSD", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.759378479485211*^9, 
  3.759378499851705*^9}},ExpressionUUID->"e17878b4-b880-4d9b-9cc8-\
4e07d81be222"],

Cell[BoxData["14"], "Output",
 CellChangeTimes->{{3.7593784847614717`*^9, 3.759378500941278*^9}, 
   3.759378579910286*^9, 3.75937861825016*^9, 3.759378739871318*^9, 
   3.7593788777945843`*^9, 3.759378936180805*^9, 3.759380958458089*^9, 
   3.75938583946285*^9, 3.759404473368657*^9, 3.7594050687713003`*^9, 
   3.759405635131802*^9, 3.7594079872561827`*^9, 3.759409189531331*^9, 
   3.75947283379432*^9, 3.7606922302176743`*^9, 3.764327493214106*^9, 
   3.7647821968795547`*^9, 3.7647828048996067`*^9, 
   3.7647831355518303`*^9},ExpressionUUID->"06a0e222-3ce6-4e33-889a-\
72da491d4e51"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"KnillDec", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.7630365776496964`*^9},ExpressionUUID->"6d7aa686-0e13-4c72-adfb-\
8873c3cc5d43"],

Cell[BoxData["22"], "Output",
 CellChangeTimes->{3.759378509462253*^9, 3.7593785816770573`*^9, 
  3.7593786193219233`*^9, 3.7593787408846416`*^9, 3.759378879370534*^9, 
  3.7593789377439623`*^9, 3.75938095940659*^9, 3.759385839926415*^9, 
  3.759404473722537*^9, 3.7594050704896383`*^9, 3.759405635584362*^9, 
  3.759407987729258*^9, 3.759409189908657*^9, 3.759472834327874*^9, 
  3.7606922307978992`*^9, 3.76432749378308*^9, 3.764782197246461*^9, 
  3.764782805256596*^9, 
  3.7647831359130993`*^9},ExpressionUUID->"17f324e8-dd4d-4f5f-8759-\
68b4090b7ab6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"ColumnByColumnDec", "[", "u", "]"}], "]"}]], "Input",ExpressionUUID\
->"39bea900-f462-4103-9289-92f3d47447f8"],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{3.759378515082109*^9, 3.759378582966667*^9, 
  3.759378619938833*^9, 3.759378741702354*^9, 3.759378880463169*^9, 
  3.7593789386324797`*^9, 3.759380959593587*^9, 3.759385840095615*^9, 
  3.759404473775735*^9, 3.7594050716095343`*^9, 3.759405635638068*^9, 
  3.7594079877924213`*^9, 3.759409189962347*^9, 3.759472834434*^9, 
  3.76069223100778*^9, 3.764327493988261*^9, 3.764782197301867*^9, 
  3.76478280531332*^9, 
  3.764783135990432*^9},ExpressionUUID->"6ef5906f-444a-464d-a228-\
c8cfef7c1268"]
}, Open  ]],

Cell["\<\
Note that DecIsometryGeneric doesn\[CloseCurlyQuote]t get the best count \
here, because it is based on generic isometries, but here we have a special \
case. DecIsometry recovers the best count.\
\>", "Text",
 CellChangeTimes->{{3.757514731532902*^9, 3.757514760371853*^9}, {
   3.7575348680029573`*^9, 3.7575348860046864`*^9}, 3.757536033138056*^9, {
   3.759378068009213*^9, 
   3.7593780722233143`*^9}},ExpressionUUID->"d8f91627-a76f-411f-970c-\
a86d504a8867"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"DecIsometryGeneric", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757534894029907*^9, 3.75753489572232*^9}, 
   3.757536035389635*^9},ExpressionUUID->"4b7fada7-70e4-4ac8-a512-\
e1a0ff1accf1"],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{
  3.7575814585310917`*^9, 3.757607729481049*^9, 3.757610008458414*^9, 
   3.75761169381114*^9, 3.757611779108398*^9, 3.7576119371645823`*^9, {
   3.757689898345825*^9, 3.7576899270577993`*^9}, 3.7576899793919487`*^9, 
   3.757690026789681*^9, 3.757690099650886*^9, 3.757690221592443*^9, {
   3.757690288389862*^9, 3.7576903405701838`*^9}, 3.757692816233719*^9, 
   3.757713414738488*^9, 3.758114393150982*^9, 3.758126539154105*^9, 
   3.758126571482152*^9, {3.758126609318441*^9, 3.758126647582058*^9}, {
   3.7581266776551*^9, 3.7581267041041203`*^9}, 3.758126746524439*^9, 
   3.758127160942824*^9, 3.75812738257664*^9, 3.7581286846930428`*^9, 
   3.7581755538882217`*^9, 3.7592247627521973`*^9, 3.759291672121491*^9, 
   3.7592937516330214`*^9, 3.759296913277814*^9, 3.759312193297151*^9, 
   3.759373979428432*^9, 3.7593759316356707`*^9, 3.759378138032837*^9, 
   3.759378664402026*^9, 3.75937875710914*^9, 3.759378861862265*^9, 
   3.759378955005488*^9, 3.7593809640426064`*^9, 3.759385840202887*^9, 
   3.759404473865095*^9, 3.759405635712572*^9, 3.759407987875485*^9, 
   3.759409190037005*^9, 3.7594728345165243`*^9, 3.760692231165596*^9, 
   3.7643274941518908`*^9, 3.764782197391596*^9, 3.764782805373807*^9, 
   3.7647831360481863`*^9},ExpressionUUID->"983ace49-c825-4370-bc92-\
782b6b1cba2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"DecIsometry", "[", "u", "]"}], "]"}]], "Input",ExpressionUUID->\
"31f5c59d-f0e4-4fc9-854d-31b2a773ec0d"],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{
  3.757514691015182*^9, 3.757517158770705*^9, 3.757526301446212*^9, 
   3.757526339781103*^9, 3.757526681929936*^9, 3.757526847596195*^9, 
   3.757527852716152*^9, 3.757533835496335*^9, 3.7575343708735847`*^9, 
   3.757534819261548*^9, 3.757581458754928*^9, 3.757607729711187*^9, 
   3.7576100087063713`*^9, 3.75761169406775*^9, 3.757611779343573*^9, 
   3.757611937434022*^9, {3.757689898567152*^9, 3.757689927294218*^9}, 
   3.7576899796203623`*^9, 3.7576900270135403`*^9, 3.757690099883875*^9, 
   3.757690221824101*^9, {3.757690288623169*^9, 3.75769034080622*^9}, 
   3.757692816458293*^9, 3.757713414942569*^9, 3.758114394168252*^9, 
   3.758126539398552*^9, 3.758126571724465*^9, {3.7581266095513153`*^9, 
   3.758126647819669*^9}, {3.758126677894644*^9, 3.758126704342875*^9}, 
   3.75812674675714*^9, 3.7581271611794043`*^9, 3.758127382844304*^9, 
   3.758128684904407*^9, 3.758175554106699*^9, 3.759224763603367*^9, 
   3.759291672633988*^9, 3.7592937521564207`*^9, 3.759296913796144*^9, 
   3.759312195180328*^9, 3.759373980085353*^9, 3.759375932344149*^9, 
   3.759378145995078*^9, 3.7593786759500303`*^9, 3.759378758656797*^9, 
   3.759378863393627*^9, 3.759378956929227*^9, 3.759380965366263*^9, 
   3.7593858409537077`*^9, 3.759404474430008*^9, 3.759405636284498*^9, 
   3.759407988488881*^9, 3.7594091906136847`*^9, 3.759472835308339*^9, 
   3.760692232017902*^9, 3.764327495029707*^9, 3.764782197982464*^9, 
   3.764782805967197*^9, 
   3.76478313664464*^9},ExpressionUUID->"2ec7ddaa-939d-4140-8401-\
d72f27e41778"]
}, Open  ]],

Cell["In the following case the Knill decomposition does best", "Text",
 CellChangeTimes->{{3.7575166203106318`*^9, 3.757516626974576*^9}, {
  3.757583813095517*^9, 
  3.757583815056209*^9}},ExpressionUUID->"32fe0a93-619b-4151-a29b-\
f7270d869a45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"l", "=", 
   RowBox[{"CreateOperationFromGateList", "[", 
    RowBox[{
     RowBox[{"StatePreparation", "[", 
      RowBox[{
       RowBox[{"RPickRandomPsi", "[", "8", "]"}], ",", 
       RowBox[{"IgnoreAncilla", "\[Rule]", "True"}]}], "]"}], ",", "3"}], 
    "]"}]}], ";", 
  RowBox[{"u", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"l", ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "8", "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"E", "^", "I"}], "-", "1"}], ")"}], "*", 
        RowBox[{
         RowBox[{"KetV", "[", 
          RowBox[{"0", ",", "8"}], "]"}], ".", 
         RowBox[{"BraV", "[", 
          RowBox[{"0", ",", "8"}], "]"}]}]}]}], ")"}], ".", 
     RowBox[{"CT", "[", "l", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.757516335844459*^9, 3.757516495609826*^9}, {
   3.7575165402342176`*^9, 3.7575165790990257`*^9}, {3.757526761553502*^9, 
   3.7575267652679977`*^9}, {3.75752687777776*^9, 3.757526878342518*^9}, {
   3.757689963069522*^9, 3.7576899631816673`*^9}, {3.757690005038198*^9, 
   3.757690013470997*^9}, {3.7581144049418983`*^9, 3.7581144066737013`*^9}, {
   3.758126658655819*^9, 3.758126666539563*^9}, 
   3.761712732499826*^9},ExpressionUUID->"56c8dbde-e44c-4d84-9b6c-\
08111637c292"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"QSD", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7575139293933077`*^9, 
  3.757513947674231*^9}},ExpressionUUID->"be3821c6-f7f0-44c8-a141-\
44c7e2d71909"],

Cell[BoxData["20"], "Output",
 CellChangeTimes->{
  3.757513948275826*^9, 3.7575139920101347`*^9, 3.757514132267392*^9, {
   3.757514203426241*^9, 3.75751427074971*^9}, 3.7575146814353228`*^9, 
   3.7575165106814003`*^9, 3.757516545848013*^9, 3.757516583478215*^9, 
   3.7575171588706217`*^9, 3.757526331476544*^9, 3.757526398057654*^9, 
   3.757526748359085*^9, 3.757526850401642*^9, 3.7575268833779297`*^9, 
   3.757527852818582*^9, 3.757533835604793*^9, 3.75753437100143*^9, 
   3.757534819369686*^9, 3.7575814589006166`*^9, 3.757607729855444*^9, 
   3.7576100088386297`*^9, 3.757611694189611*^9, 3.7576117794494677`*^9, 
   3.7576119375565567`*^9, 3.757689920175763*^9, 3.757689971052845*^9, {
   3.757690002992347*^9, 3.757690027148465*^9}, 3.7576901000228367`*^9, 
   3.757690221955999*^9, {3.7576902887542553`*^9, 3.757690340952186*^9}, 
   3.757692816598229*^9, 3.757713415048678*^9, 3.7581144098820047`*^9, 
   3.758126566079054*^9, {3.758126602834939*^9, 3.758126704450395*^9}, 
   3.75812674686541*^9, 3.758127161287657*^9, 3.7581273829688377`*^9, 
   3.758128685030055*^9, 3.758175554218157*^9, 3.759224764121724*^9, 
   3.7592916728334227`*^9, 3.7592937523496037`*^9, 3.759296913988785*^9, 
   3.759312195559074*^9, 3.759373980404525*^9, 3.759375932723597*^9, 
   3.75937903202568*^9, 3.759380972108398*^9, 3.759385841463513*^9, 
   3.75940447467889*^9, 3.759405636572565*^9, 3.7594079887766867`*^9, 
   3.759409190835239*^9, 3.75947283561206*^9, 3.760692232506369*^9, 
   3.764327495536953*^9, 3.764782198269833*^9, 3.7647828062125673`*^9, 
   3.764783136852351*^9},ExpressionUUID->"885b6f0e-2d5f-42ad-a058-\
34a21ad130ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"KnillDec", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757513955113896*^9, 3.757513959698237*^9}, 
   3.7630365776606083`*^9},ExpressionUUID->"d3eeccb5-4b23-48fd-9a50-\
4f9c98785594"],

Cell[BoxData["14"], "Output",
 CellChangeTimes->{
  3.757513961017724*^9, 3.7575139940432377`*^9, 3.757514134200411*^9, {
   3.757514205036613*^9, 3.7575142723360443`*^9}, 3.757514683380272*^9, 
   3.757516548086442*^9, 3.757516585177309*^9, 3.7575171589200087`*^9, 
   3.757526885637971*^9, 3.757527852893763*^9, 3.7575338356518373`*^9, 
   3.757534371049856*^9, 3.757534819423245*^9, 3.757581458954097*^9, 
   3.757607729911901*^9, 3.75761000891829*^9, 3.75761169424426*^9, 
   3.7576117794993553`*^9, 3.757611937600724*^9, 3.757690027225232*^9, 
   3.757690100098476*^9, 3.7576902220270243`*^9, {3.757690288826621*^9, 
   3.757690341030105*^9}, 3.7576928166671743`*^9, 3.7577134150899353`*^9, 
   3.758114411056872*^9, {3.758126678041703*^9, 3.7581267044958973`*^9}, 
   3.7581267469119377`*^9, 3.758127161331717*^9, 3.75812738302107*^9, 
   3.75812868507722*^9, 3.758175554263015*^9, 3.759224764308209*^9, 
   3.759291672988625*^9, 3.759293752507647*^9, 3.759296914136088*^9, 
   3.759312195674408*^9, 3.75937398051747*^9, 3.759375932859132*^9, 
   3.759379032772059*^9, 3.7593809746743402`*^9, 3.7593858415962267`*^9, 
   3.7594044747676*^9, 3.759405636652657*^9, 3.759407988861465*^9, 
   3.759409190919203*^9, 3.75947283575311*^9, 3.760692232699682*^9, 
   3.764327495738771*^9, 3.7647821983689947`*^9, 3.7647828062960253`*^9, 
   3.764783136950938*^9},ExpressionUUID->"51881320-1312-4489-b842-\
ef01bcd1e24d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"ColumnByColumnDec", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757513968957479*^9, 
  3.7575139713634*^9}},ExpressionUUID->"50eac638-3653-4ef8-a270-926a8b17e0d6"],

Cell[BoxData["41"], "Output",
 CellChangeTimes->{{3.757513972673992*^9, 3.7575139960299273`*^9}, 
   3.7575141359030333`*^9, {3.757514206647176*^9, 3.7575142743945513`*^9}, 
   3.757514684998644*^9, 3.757516549997905*^9, 3.757516587100122*^9, 
   3.757517159083187*^9, 3.757527853057975*^9, 3.7575338358127527`*^9, 
   3.7575343712161417`*^9, 3.7575348195899487`*^9, 3.757581459105166*^9, 
   3.7576077300783453`*^9, 3.757610009085264*^9, 3.757611694432439*^9, 
   3.757611779666976*^9, 3.757611937819275*^9, 3.757690027422894*^9, 
   3.757690100292186*^9, 3.7576902222301292`*^9, {3.757690289021942*^9, 
   3.757690341266626*^9}, 3.7576928168584146`*^9, 3.757713415224901*^9, 
   3.7581144124682426`*^9, {3.758126678186035*^9, 3.758126704645183*^9}, 
   3.758126747061179*^9, 3.758127161479391*^9, 3.7581273831741877`*^9, 
   3.758128685223159*^9, 3.758175554412184*^9, 3.7592247647067213`*^9, 
   3.7592916732273893`*^9, 3.759293752757506*^9, 3.759296914380767*^9, 
   3.7593121960040407`*^9, 3.7593739808418083`*^9, 3.759375933223929*^9, 
   3.759379034225088*^9, 3.759380975628667*^9, 3.7593858419501762`*^9, 
   3.759404475017118*^9, 3.759405636901662*^9, 3.759407989110515*^9, 
   3.7594091911652393`*^9, 3.759472836114881*^9, 3.7606922331164923`*^9, 
   3.764327496163259*^9, 3.764782198628261*^9, 3.7647828065563307`*^9, 
   3.764783137235066*^9},ExpressionUUID->"58ab0e29-a5ee-4eac-a5be-\
451f6992be3c"]
}, Open  ]],

Cell["\<\
Again DecIsometryGeneric does not give the best, but DecIsometry does\
\>", "Text",
 CellChangeTimes->{{3.757516640047254*^9, 3.757516647016404*^9}, {
   3.757534907423086*^9, 3.757534934558329*^9}, 
   3.75753603806037*^9},ExpressionUUID->"26940f68-fd94-4106-9376-\
57ce4a95bb0e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"DecIsometryGeneric", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7575349474648333`*^9, 3.757534948688555*^9}, 
   3.757536038585952*^9},ExpressionUUID->"78dbb129-cd07-4d62-a12d-\
e27edb33a64f"],

Cell[BoxData["20"], "Output",
 CellChangeTimes->{
  3.75758145918566*^9, 3.7576077301617126`*^9, 3.757610009167343*^9, 
   3.757611694548914*^9, 3.75761177977717*^9, 3.757611937932344*^9, 
   3.757690027553234*^9, 3.757690100428772*^9, 3.757690222363143*^9, {
   3.757690289158063*^9, 3.757690341380498*^9}, 3.757692816995141*^9, 
   3.757713415293479*^9, 3.758114414306402*^9, {3.758126678255926*^9, 
   3.7581267047147493`*^9}, 3.7581267471320057`*^9, 3.758127161550252*^9, 
   3.7581273832445097`*^9, 3.758128685292096*^9, 3.758175554482397*^9, 
   3.75922476503115*^9, 3.759291673352826*^9, 3.759293752888946*^9, 
   3.759296914505374*^9, 3.759312196185522*^9, 3.759373981014737*^9, 
   3.759375933409679*^9, 3.759379038787529*^9, 3.759380982415743*^9, 
   3.759385842141366*^9, 3.759404475147071*^9, 3.759405637029351*^9, 
   3.759407989246978*^9, 3.759409191293845*^9, 3.759472836309649*^9, 
   3.7606922334313593`*^9, 3.764327496495537*^9, 3.764782198763041*^9, 
   3.764782806688377*^9, 
   3.764783137368926*^9},ExpressionUUID->"aeeb0f21-a3ad-40a2-a065-\
0ac347691d8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"DecIsometry", "[", "u", "]"}], "]"}]], "Input",ExpressionUUID->\
"8c1b8c2e-014d-4b36-b3b4-22dda78cdad1"],

Cell[BoxData["14"], "Output",
 CellChangeTimes->{
  3.757516635107339*^9, 3.757517159164377*^9, 3.757527853139695*^9, 
   3.757533836064341*^9, 3.757534371498476*^9, 3.757534819848734*^9, 
   3.7575814594428167`*^9, 3.757607730432094*^9, 3.757610009500225*^9, 
   3.757611694851652*^9, 3.757611780036992*^9, 3.757611938247223*^9, 
   3.7576900279077682`*^9, 3.757690100762547*^9, 3.757690222699848*^9, {
   3.75769028948801*^9, 3.7576903417313957`*^9}, 3.757692817312634*^9, 
   3.757713415525797*^9, 3.758114416949376*^9, {3.7581266785261374`*^9, 
   3.7581267049797173`*^9}, 3.758126747395837*^9, 3.758127161811667*^9, 
   3.7581273835085382`*^9, 3.758128685550383*^9, 3.7581755547407846`*^9, 
   3.759224766057353*^9, 3.759291674066972*^9, 3.759293753610866*^9, 
   3.759296915221633*^9, 3.75931219730241*^9, 3.7593739820069437`*^9, 
   3.7593759344778957`*^9, {3.759379042700694*^9, 3.759379045358439*^9}, 
   3.7593809840551767`*^9, 3.759385843323312*^9, 3.759404475893446*^9, 
   3.759405637767293*^9, 3.759407989994392*^9, 3.7594091920322933`*^9, 
   3.759472837323814*^9, 3.760692234539036*^9, 3.764327497647862*^9, 
   3.7647821995527773`*^9, 3.764782807461802*^9, 
   3.7647831381592293`*^9},ExpressionUUID->"b8c3b7b8-490b-48b7-99df-\
26f1da96d974"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We also have some decompositions that scale well for sparse cases\
\>", "Subsection",
 CellChangeTimes->{{3.808739379590679*^9, 3.80873939263647*^9}, {
  3.8087408326006737`*^9, 
  3.8087408329237757`*^9}},ExpressionUUID->"cf195567-654f-48b5-8c83-\
9e59ad0f4e90"],

Cell["Create a sparse isometry in the form of a permutation matrix", "Text",
 CellChangeTimes->{{3.808740822032975*^9, 3.808740828814803*^9}, {
  3.814868584337831*^9, 
  3.814868595548098*^9}},ExpressionUUID->"13bbad07-4d05-4bc1-a795-\
e831258c5f0e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "16"}], ";", 
  RowBox[{"lst", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "16"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"permlist", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "16"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"Length", "[", "lst", "]"}], "-", "1"}], "]"}], "+", "1"}]}],
      ";", 
     RowBox[{"permlist", "=", 
      RowBox[{"Insert", "[", 
       RowBox[{"permlist", ",", 
        RowBox[{"lst", "[", 
         RowBox[{"[", "k", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", 
     RowBox[{"lst", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"lst", ",", 
        RowBox[{"{", "k", "}"}]}], "]"}]}]}]}], "]"}], ";", 
  RowBox[{"perm", "=", 
   RowBox[{"Permute", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "16", "]"}], ",", "permlist"}], "]"}]}], 
  ";", 
  RowBox[{"perm", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.809190667090108*^9, 3.809190897492633*^9}, {
  3.809190931122768*^9, 3.809190941978681*^9}, {3.814868459739519*^9, 
  3.8148684610812883`*^9}},
 CellLabel->
  "In[455]:=",ExpressionUUID->"25164243-de4b-49fd-a96d-0d1f04de4f82"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.809190836646249*^9, 3.809190897865815*^9}, {
   3.8091909323588037`*^9, 3.8091909424852943`*^9}, 3.814868398799967*^9, 
   3.814868464280521*^9},
 CellLabel->
  "Out[455]//MatrixForm=",ExpressionUUID->"a8085176-4035-4a4a-accb-\
c3ed43363e24"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"perm", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
        "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
        "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
        "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
        "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
        "0", "1"},
       {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
        "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
        "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
        "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
        "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
        "0", "0"},
       {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
        "0", "0"},
       {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
        "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
        "0", "0"},
       {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
        "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
        "1", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
        "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]], "Input",
 CellChangeTimes->{{3.814868501119095*^9, 3.814868514596073*^9}},
 CellLabel->
  "In[461]:=",ExpressionUUID->"3ab1a337-8e09-4629-a3ce-4e5f603afd85"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"gatelist", "=", 
   RowBox[{"SparseHouseholderDec", "[", 
    RowBox[{"N", "[", "perm", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.809190142791493*^9, 3.8091901472496023`*^9}, {
  3.80919019448437*^9, 3.8091901959846163`*^9}, {3.814868470694652*^9, 
  3.814868472004508*^9}, {3.81486898192076*^9, 3.814868984041945*^9}},
 CellLabel->
  "In[472]:=",ExpressionUUID->"6779d11a-c1f8-4052-9afd-5ed423f59915"],

Cell[BoxData["74"], "Output",
 CellChangeTimes->{{3.809190147728711*^9, 3.809190216748659*^9}, 
   3.8091905393062153`*^9, {3.8091905764068117`*^9, 3.809190585822703*^9}, 
   3.809190946414007*^9, {3.8121069554876432`*^9, 3.812107093049151*^9}, {
   3.812107304823522*^9, 3.81210731274393*^9}, 3.814868402086359*^9, 
   3.814868473950077*^9, 3.814868518186431*^9, 3.814868986235003*^9},
 CellLabel->
  "Out[472]=",ExpressionUUID->"c17d8d53-be8d-4979-9983-8ed83def5a81"]
}, Open  ]],

Cell["Check the result", "Text",
 CellChangeTimes->{{3.8148690452159557`*^9, 
  3.8148690476668673`*^9}},ExpressionUUID->"a254276b-eb32-42e6-b592-\
23b1f3495e94"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}], "/", 
    RowBox[{
     RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "-", "perm"}], "]"}]], "Input",\

 CellChangeTimes->{{3.8148689889201097`*^9, 3.814869034604273*^9}},
 CellLabel->
  "In[476]:=",ExpressionUUID->"440ee041-3dfd-4a4c-af46-298e3bde41af"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.814868995143876*^9, 3.814869035371047*^9}},
 CellLabel->
  "Out[476]=",ExpressionUUID->"a96250ac-2289-43f5-bd0f-1378b4537706"]
}, Open  ]],

Cell["Compare to the counts of other decompositions", "Text",
 CellChangeTimes->{{3.814869052539119*^9, 
  3.814869063239497*^9}},ExpressionUUID->"eefefc46-bff7-4065-bed1-\
d7b5763b4c8d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"ColumnByColumnDec", "[", 
   RowBox[{"N", "[", "perm", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8091900639441357`*^9, 3.809190069606069*^9}, {
  3.809190109781187*^9, 3.809190115810088*^9}, {3.809190185144478*^9, 
  3.809190189141292*^9}, {3.814868475942902*^9, 3.8148684772050753`*^9}},
 CellLabel->
  "In[457]:=",ExpressionUUID->"25f979fc-facb-4cc4-ad5d-2d7905b86ff4"],

Cell[BoxData["110"], "Output",
 CellChangeTimes->{{3.809190069901496*^9, 3.8091901163673267`*^9}, {
   3.809190180462788*^9, 3.809190208554449*^9}, 3.8091904232794456`*^9, 
   3.809190540011084*^9, {3.80919057721673*^9, 3.8091905867780943`*^9}, 
   3.8091909473588057`*^9, {3.8121069564168377`*^9, 3.8121070939869843`*^9}, {
   3.8121073055431757`*^9, 3.812107316140563*^9}, 3.8148684035635767`*^9, 
   3.814868478173915*^9},
 CellLabel->
  "Out[457]=",ExpressionUUID->"fe44da6f-16db-447f-b391-46991ec32fe6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"KnillDec", "[", 
   RowBox[{"N", "[", "perm", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.809190405495653*^9, 3.809190409901*^9}, {
  3.814868480503969*^9, 3.8148684817994537`*^9}},
 CellLabel->
  "In[458]:=",ExpressionUUID->"da33745d-f4cb-4cb2-b4f0-e542087046bb"],

Cell[BoxData["305"], "Output",
 CellChangeTimes->{{3.809190529586957*^9, 3.80919054308265*^9}, {
   3.809190579171516*^9, 3.809190589121022*^9}, 3.809190952352396*^9, {
   3.812107004062063*^9, 3.812107035517261*^9}, 3.812107307570067*^9, 
   3.814868411838766*^9, 3.814868486632008*^9},
 CellLabel->
  "Out[458]=",ExpressionUUID->"8157e231-f0c1-4711-9675-4edd7cbcd085"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"QSD", "[", 
   RowBox[{"N", "[", "perm", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.809190420578928*^9, 3.80919042612162*^9}, {
  3.814868485890963*^9, 3.8148684873514013`*^9}},
 CellLabel->
  "In[459]:=",ExpressionUUID->"33b76cc6-5036-4137-a1c6-79678d5b89bf"],

Cell[BoxData["97"], "Output",
 CellChangeTimes->{
  3.8091905443044252`*^9, {3.809190580002511*^9, 3.809190589872216*^9}, 
   3.809190952997632*^9, 3.812106968694089*^9, {3.8121070068177156`*^9, 
   3.812107088121174*^9}, {3.812107307750437*^9, 3.8121073144712143`*^9}, 
   3.81486841248435*^9, 3.814868488570256*^9},
 CellLabel->
  "Out[459]=",ExpressionUUID->"0ec2ce55-2a34-4fd7-bff3-0fb794f10887"]
}, Open  ]],

Cell["\<\
However, other decompositions often beat SparseHouseholderDec in small cases. \
Here illustrated for three qubits\
\>", "Text",
 CellChangeTimes->{{3.8148686170529957`*^9, 3.814868660582184*^9}, {
  3.814868910613431*^9, 
  3.8148689347068367`*^9}},ExpressionUUID->"1814fdca-4b3e-404c-8691-\
d52ea6ead541"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"DirectSum", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PickRandomUnitary", "[", "2", "]"}], ",", 
      RowBox[{"PickRandomUnitary", "[", "2", "]"}], ",", 
      RowBox[{"PickRandomUnitary", "[", "2", "]"}], ",", 
      RowBox[{"PickRandomUnitary", "[", "2", "]"}]}], "}"}], "]"}]}], ";", 
  RowBox[{"U", "=", 
   RowBox[{"Permute", "[", 
    RowBox[{"U", ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "7", ",", "5", ",", "6", ",", "8", ",", "4", ",", "2", ",", 
       "3"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"U", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.814868669689702*^9, 3.814868736597814*^9}, {
  3.814868835941605*^9, 3.8148688467811537`*^9}},
 CellLabel->
  "In[469]:=",ExpressionUUID->"e2c54123-c97f-47a9-ba4d-9d38d590bbf0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.8356077229689508`"}], "+", 
       RowBox[{"0.49675342475989653`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1846720416980829`"}], "-", 
       RowBox[{"0.14454067012097427`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"0.4231873185953937`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.13634241896453553`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6349620533321632`"}], "+", 
       RowBox[{"0.6317803645248425`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "0.8688289177830388`"}], "+", 
       RowBox[{"0.21785212827717185`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3351709788956644`"}], "+", 
       RowBox[{"0.2921252757554237`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "0.6593933139840543`"}], "+", 
       RowBox[{"0.7476920192486659`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07797589775689628`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.008767051613000171`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", "0.37929972655767735`"}], "+", 
       RowBox[{"0.20454113727805884`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.8922180180204976`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.13506164856777217`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0"},
     {"0", "0", 
      RowBox[{"0.47924410167798004`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.7646042973990764`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0921747503146589`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.4209622011655688`", " ", "\[ImaginaryI]"}]}], "0", "0", "0",
       "0"},
     {
      RowBox[{
       RowBox[{"-", "0.029889654879610716`"}], "+", 
       RowBox[{"0.23259917634234337`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.9436591038583453`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.23347746658147953`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "0.07655012692653838`"}], "-", 
       RowBox[{"0.017238906360608142`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.5737028322074271`"}], "-", 
       RowBox[{"0.8152962397142512`", " ", "\[ImaginaryI]"}]}], "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.814868736824308*^9, {3.814868839763274*^9, 3.814868847088934*^9}},
 CellLabel->
  "Out[469]//MatrixForm=",ExpressionUUID->"f8e04570-9b20-4cc3-9744-\
fbd84bf51e16"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"SparseHouseholderDec", "[", "U", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.814868887081767*^9, 3.814868887589122*^9}},
 CellLabel->
  "In[470]:=",ExpressionUUID->"fda4dc68-8e99-41d3-9052-5f3bf7a60003"],

Cell[BoxData["78"], "Output",
 CellChangeTimes->{3.814868890367057*^9},
 CellLabel->
  "Out[470]=",ExpressionUUID->"90aa5a6c-b9fb-4797-98e2-d42d72f7f102"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"ColumnByColumnDec", "[", "U", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.814868898350525*^9, 3.814868899235482*^9}},
 CellLabel->
  "In[471]:=",ExpressionUUID->"40b7d157-1b1b-4465-97ff-c5f454278a16"],

Cell[BoxData["34"], "Output",
 CellChangeTimes->{3.814868899745234*^9},
 CellLabel->
  "Out[471]=",ExpressionUUID->"8d95d5ba-005e-4dfb-970c-173c1a77c4cd"]
}, Open  ]],

Cell["Another example picked randomly", "Text",
 CellChangeTimes->{{3.81487416428442*^9, 
  3.814874170594385*^9}},ExpressionUUID->"381f6e9b-6792-443d-b72c-\
c0a763cd58ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"PickRandomSparseIsometry", "[", 
     RowBox[{
      RowBox[{"2", "^", "2"}], ",", 
      RowBox[{"2", "^", "6"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.8148740200506363`*^9, {3.814874069774961*^9, 3.8148740724212437`*^9}},
 CellLabel->
  "In[493]:=",ExpressionUUID->"6dfdb2fa-a749-4c59-acc8-2cf5f6828a05"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"gatelist", "=", 
   RowBox[{"SparseHouseholderDec", "[", "V", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.814874027729299*^9, {3.814874097178104*^9, 3.814874098910578*^9}},
 CellLabel->
  "In[496]:=",ExpressionUUID->"1813880b-5d65-4d6b-afc2-9c53c1ab5ace"],

Cell[BoxData["392"], "Output",
 CellChangeTimes->{{3.814874074693571*^9, 3.814874104988249*^9}},
 CellLabel->
  "Out[496]=",ExpressionUUID->"97fe0a1b-59ae-4f09-8d8f-adea7901c850"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"ColumnByColumnDec", "[", "V", "]"}], "]"}]], "Input",
 CellChangeTimes->{3.814874035646573*^9},
 CellLabel->
  "In[495]:=",ExpressionUUID->"5e14cf82-2c3a-4c5c-8d92-771e64e010ea"],

Cell[BoxData["166"], "Output",
 CellChangeTimes->{3.814874083866453*^9},
 CellLabel->
  "Out[495]=",ExpressionUUID->"3b36b593-cb12-47c8-8a42-09b29fdcd9fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}], "]"}]}], 
  ";", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"out", "*", 
     RowBox[{
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Normal", "[", "V", "]"}], "]"}], ",", "0"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Normal", "[", "out", "]"}], "]"}], ",", "0"}], "]"}], "[", 
       
       RowBox[{"[", "1", "]"}], "]"}]}]}], "-", "V"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8148741022230663`*^9, 3.814874144276107*^9}},
 CellLabel->
  "In[499]:=",ExpressionUUID->"82517269-0365-4872-bc2c-e03d9cb514a6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8148741108069267`*^9, 3.814874148131393*^9}},
 CellLabel->
  "Out[499]=",ExpressionUUID->"724adb33-70c9-40cf-82ca-ea204d3eab95"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["State preparation", "Subsection",
 CellChangeTimes->{{3.759144482929893*^9, 
  3.759144485567499*^9}},ExpressionUUID->"dab312b9-c026-4326-b038-\
64c16427232d"],

Cell["\<\
State preparation is just a special case of an isometry from m to n qubits, \
with m=0. We provide a method StatePreparation, which achieves the lowest \
known CNOT counts for generic states.\
\>", "Text",
 CellChangeTimes->{{3.757516696336713*^9, 3.757516712504345*^9}, {
  3.75938102093292*^9, 3.759381120539817*^9}, {3.759381282583296*^9, 
  3.759381315549452*^9}},ExpressionUUID->"9dfa27fb-c2b1-4374-a068-\
105bd9041bba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"state", "=", 
  RowBox[{"PickRandomPsi", "[", "8", "]"}]}]], "Input",
 CellChangeTimes->{{3.757516718478341*^9, 
  3.7575167296038218`*^9}},ExpressionUUID->"4d196da3-861b-4523-917b-\
374487b45ac4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.04439624729586082`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.04734374035911791`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.09340505727236434`"}], "+", 
     RowBox[{"0.39698151782522134`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.08490869914579541`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.23990456790241943`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.11486175519775504`"}], "-", 
     RowBox[{"0.06637272243230773`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.06416739591314762`"}], "-", 
     RowBox[{"0.11268179120805538`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.012656439603777974`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.4597331863903722`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5613206586078022`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.34271096724814126`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.020212216843781477`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.29297920030730457`", " ", "\[ImaginaryI]"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.757516732958437*^9, 3.757517159268922*^9, 3.757526941309457*^9, 
   3.757527294758203*^9, 3.7575278532977533`*^9, 3.757533836259776*^9, 
   3.7575343716697397`*^9, 3.757534820046123*^9, 3.7575814595997467`*^9, 
   3.7576077305954723`*^9, 3.7576100096770487`*^9, 3.757611695029497*^9, 
   3.7576117802323627`*^9, 3.757611938459119*^9, 3.757690028046204*^9, 
   3.757690100879426*^9, 3.757690222825465*^9, {3.757690289589799*^9, 
   3.757690341898098*^9}, 3.75769281742933*^9, 3.7577134156312523`*^9, 
   3.758114460892716*^9, {3.758126678658111*^9, 3.7581267051223717`*^9}, 
   3.758126747519328*^9, 3.758127161930884*^9, 3.758127383636573*^9, 
   3.758128685672987*^9, 3.758175554849999*^9, 3.759224766514407*^9, 
   3.759291674172364*^9, 3.759293753734762*^9, 3.759296915333387*^9, 
   3.759312199184375*^9, 3.759373982421036*^9, 3.759375934869129*^9, 
   3.7593813302925663`*^9, 3.759381846739994*^9, 3.759385843429327*^9, 
   3.7594044759193497`*^9, 3.759405637840979*^9, 3.759407990067059*^9, 
   3.759409192099165*^9, 3.759472837366559*^9, 3.760692234684595*^9, 
   3.764327497801413*^9, 3.764782199590375*^9, 3.764782807499124*^9, 
   3.7647831381875134`*^9},ExpressionUUID->"17abba2a-2bb7-4e1b-ae78-\
8a3c5ac0ca12"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"StatePreparation", "[", "state", "]"}]}]], "Input",
 CellChangeTimes->{{3.7575167357045*^9, 
  3.757516753237501*^9}},ExpressionUUID->"5bd27100-29a7-4faf-9375-\
828e175f0fe9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.22715159767179582`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2.502024368833662`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.7636809612333166`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.16546952367524978`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\[Pi]", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.7110964971894799`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.0284585790327965`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.6068302145376852`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.281411261550124`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.5966313727619961`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.6258984733478979`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2.6594287853842733`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.4743085433539618`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.724460397443795`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.168978657849166`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.050160690638204`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.4370503558775929`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2.66945381174548`", ",", "3"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.757516741849362*^9, 3.757516755009457*^9}, 
   3.75751715931962*^9, 3.757526943341971*^9, 3.757527296897531*^9, 
   3.757527853332066*^9, 3.757533836303288*^9, 3.7575343717129803`*^9, 
   3.757534820085162*^9, 3.75758145963783*^9, 3.757607730631315*^9, 
   3.757610009709642*^9, 3.757611695069521*^9, 3.757611780271289*^9, 
   3.757611938504821*^9, 3.757690028108753*^9, 3.7576901009285173`*^9, 
   3.757690222874515*^9, {3.7576902896388683`*^9, 3.757690341955635*^9}, 
   3.757692817479309*^9, 3.757713415656562*^9, 3.7581144623367853`*^9, {
   3.758126678708139*^9, 3.758126705173649*^9}, 3.758126747558564*^9, 
   3.7581271619714413`*^9, 3.758127383665103*^9, 3.758128685699485*^9, 
   3.7581755548770313`*^9, 3.759224766602017*^9, 3.759291674218902*^9, 
   3.759293753784268*^9, 3.759296915380724*^9, 3.759312199552557*^9, 
   3.7593739825001383`*^9, 3.7593759349479237`*^9, 3.7593813316263227`*^9, 
   3.759381847929448*^9, 3.75938584352326*^9, 3.759404475969741*^9, 
   3.7594056378896914`*^9, 3.759407990132882*^9, 3.759409192149764*^9, 
   3.7594728374478703`*^9, 3.76069223476587*^9, 3.764327497885745*^9, 
   3.764782199642003*^9, 3.7647828075505743`*^9, 
   3.7647831382405453`*^9},ExpressionUUID->"71b25513-5ff8-463b-9f69-\
7e75bdcf6c8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.759381502256336*^9, 
  3.759381508584725*^9}},ExpressionUUID->"1bd9562e-a9ba-4050-ab3c-\
d3da09ddda1f"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{3.7593815091745462`*^9, 3.7593858436142893`*^9, 
  3.759404475990106*^9, 3.759405637911121*^9, 3.759407990154066*^9, 
  3.759409192168784*^9, 3.7594728374742813`*^9, 3.7606922348432503`*^9, 
  3.764327497966487*^9, 3.764782199668323*^9, 3.764782807584117*^9, 
  3.764783138263875*^9},ExpressionUUID->"19a095a6-db79-462f-9980-\
c1e8aa43c3f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.759381830885811*^9, 
  3.759381835921575*^9}},ExpressionUUID->"fc9100bb-5704-451b-a600-\
57d53982a44b"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -1.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -1.}, {11., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -1.}, {12., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -1.}, {13., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{13., -1.}, {14., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {8., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {10., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -2.}, {11., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {12., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {11., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -2.}, {13., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{13., -2.}, {14., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -3.}, {9., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -3.}, {12., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -3.}, {2., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {3., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -3.}, {4., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -3.}, {7., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -3.}, {8., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -3.}, {10., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -3.}, {11., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -3.}, {13., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{13., -3.}, {14., -3.}}]}}, {
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -1.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -1.2}, {3.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -1.}]}}, {}, 
     {GrayLevel[0], DiskBox[{5., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -1.2}, {6.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -1.2}, {7.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"Rz\"\>", {7., -1.}]}}, {}, {}, {}, {}, {}, {}, {}, 
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -2.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -2.2}, {3.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -2.2}, {4.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -2.}]}}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{8., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{8., -2.2}, {8., -1.8}}], 
       LineBox[{{7.8, -2.}, {8.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -2.2}, {9.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -2.2}, {10.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {10., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{11., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{11., -2.2}, {11., -1.8}}], 
       LineBox[{{10.8, -2.}, {11.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{11.8, -2.2}, {12.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {12., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.8, -2.2}, {13.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {13., -2.}]}}, {}, 
     {GrayLevel[0], DiskBox[{8., -3.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{11., -3.}, 0.1]}, 
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -3.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -3.2}, {2.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {2., -3.}]}}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -3.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -3.2}, {5., -2.8}}], 
       LineBox[{{4.8, -3.}, {5.2, -3.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -3.2}, {6.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -3.2}, {7.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {7., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -3.2}, {9.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -3.2}, {10.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {10., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{11.8, -3.2}, {12.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {12., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.8, -3.2}, {13.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {13., -3.}]}}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxdz0EKwyAQheGhK5cuXLhwYUVExDvEM/QIha57xPZIOUIS4gTyC8PjmwGH
eb6/r89DRNpeR55vXWb+ZmPcbWALO9jDAY5wgjNc4Ao3uMN6n/xnjrsNbGEH
ezjAEU5whgtc4QZ3WPcZ/KfW+9WCuYEt7GAPBzjBGa5wg/vlDYviQGU=
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{720., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.7593818367066603`*^9, 3.759381849234848*^9}, 
   3.7593858437141123`*^9, 3.7594044760212307`*^9, 3.759405637939148*^9, 
   3.75940799018355*^9, 3.7594091921989727`*^9, 3.7594728375291567`*^9, 
   3.760692234952819*^9, 3.764327498068369*^9, 3.7647821997002583`*^9, 
   3.764782807619925*^9, 
   3.764783138294589*^9},ExpressionUUID->"e62c5d89-2b76-4cd0-8660-\
cec0ab5c7919"]
}, Open  ]],

Cell["\<\
Note that one gets the same output calling DecIsometry[state] in the \
considered case.\
\>", "Text",
 CellChangeTimes->{{3.757516696336713*^9, 3.757516712504345*^9}, {
  3.75938102093292*^9, 3.759381120539817*^9}, {3.759381282583296*^9, 
  3.759381315549452*^9}, {3.7593813532559233`*^9, 3.759381381069434*^9}, {
  3.7593814278648148`*^9, 
  3.759381437294229*^9}},ExpressionUUID->"d4f931a3-3ae3-41f5-9f74-\
7c16d2825e29"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DecIsometry", "[", "state", "]"}], "\[Equal]", 
  RowBox[{"StatePreparation", "[", "state", "]"}]}]], "Input",
 CellChangeTimes->{{3.759381382759769*^9, 
  3.759381391646028*^9}},ExpressionUUID->"2f30f6e3-3793-4ebf-b276-\
b8d325f5c9ac"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.759381392134934*^9, 3.7593858439146*^9, 
  3.759404476145295*^9, 3.7594056380618896`*^9, 3.7594079903093147`*^9, 
  3.7594091923230057`*^9, 3.759472837699882*^9, 3.760692235196845*^9, 
  3.764327498293985*^9, 3.764782199829645*^9, 3.764782807747964*^9, 
  3.764783138425812*^9},ExpressionUUID->"4181143a-8748-46f8-a1bb-\
ea41b477b915"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"outstate", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}]}], ";", 
  RowBox[{"outstate", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.7575168099384747`*^9, 3.7575168118415422`*^9}, {
   3.7575268034909697`*^9, 3.757526825386506*^9}, {3.757526946293707*^9, 
   3.757526951261057*^9}, {3.7575273526805353`*^9, 3.757527359844061*^9}, {
   3.757690055699898*^9, 3.757690056211672*^9}, {3.7581144665050917`*^9, 
   3.758114467477818*^9}, 
   3.761712732512207*^9},ExpressionUUID->"58a18459-f356-4218-88ac-\
648e79dfc1a6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.02896720653454741`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.05808061183158923`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.024273556578884206`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.4070990354568309`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.01259927407778022`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.25417503257360036`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.12906466503081487`"}], "-", 
       RowBox[{"0.030673658579775498`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.09376698415310301`"}], "-", 
       RowBox[{"0.08956781481627238`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.11961809861439723`"}], "-", 
       RowBox[{"0.44407915805176623`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.635988400738273`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1674826647101915`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.1033223009101382`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.274899704723528`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7575168083724823`*^9, 3.7575168121658487`*^9}, 
   3.7575171593423843`*^9, 3.7575269517428293`*^9, 3.757527299035492*^9, 
   3.7575273602338743`*^9, 3.7575278533605833`*^9, 3.757533836329118*^9, 
   3.757534371745124*^9, 3.757534820119275*^9, 3.757581459665489*^9, 
   3.7576077306591043`*^9, 3.757610009737413*^9, 3.757611695102551*^9, 
   3.757611780308125*^9, 3.757611938542124*^9, 3.757690028133752*^9, 
   3.757690100961277*^9, 3.757690222907094*^9, {3.7576902896662283`*^9, 
   3.75769034199072*^9}, 3.7576928175127897`*^9, 3.757713415675021*^9, 
   3.758114468360696*^9, {3.7581266787324867`*^9, 3.758126705199314*^9}, 
   3.7581267475859632`*^9, 3.7581271620022383`*^9, 3.758127383683036*^9, 
   3.7581286857222843`*^9, 3.7581755548951387`*^9, 3.759224766690762*^9, 
   3.759291674236906*^9, 3.759293753802841*^9, 3.75929691539745*^9, 
   3.759312199670896*^9, 3.759373982555517*^9, 3.7593759350217857`*^9, 
   3.759381410312827*^9, 3.759381443193212*^9, 3.759385843995777*^9, 
   3.7594044761660748`*^9, 3.759405638083199*^9, 3.7594079903301163`*^9, 
   3.759409192344344*^9, 3.7594728377324133`*^9, 3.760692235272718*^9, 
   3.7643274983881187`*^9, 3.764782199861103*^9, 3.764782807782387*^9, 
   3.76478313845264*^9},ExpressionUUID->"61c57ea8-1053-4de7-956d-\
704b568a23f4"]
}, Open  ]],

Cell["This is equal to the state up to phase", "Text",
 CellChangeTimes->{{3.757527329762117*^9, 
  3.7575273347498913`*^9}},ExpressionUUID->"49c9afe0-1a50-4fd5-9f74-\
49a337344be2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"outstate", "/", 
     RowBox[{"outstate", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
    RowBox[{"state", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "state"}], "]"}]], "Input",\

 CellChangeTimes->{{3.757516757251266*^9, 3.7575168324466753`*^9}, {
  3.75751686337438*^9, 3.757516917347582*^9}, {3.757527346186681*^9, 
  3.7575273643612347`*^9}},ExpressionUUID->"2ec006b1-0a1d-467c-a872-\
9d3d10a3976f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7575168005861797`*^9, 3.757516832795843*^9}, {
   3.757516866348853*^9, 3.757516917625008*^9}, 3.757517159368146*^9, 
   3.757527365788896*^9, 3.757527853391686*^9, 3.757533836357278*^9, 
   3.757534371776943*^9, 3.75753482015302*^9, 3.757581459691143*^9, 
   3.7576077306694927`*^9, 3.7576100097671556`*^9, 3.757611695134583*^9, 
   3.757611780344174*^9, 3.7576119385785713`*^9, 3.757690028174494*^9, 
   3.7576901009675417`*^9, 3.757690222926887*^9, {3.757690289688315*^9, 
   3.757690341998893*^9}, 3.7576928175204887`*^9, 3.757713415695231*^9, 
   3.7581144715746403`*^9, {3.758126678756133*^9, 3.758126705226001*^9}, 
   3.7581267476069736`*^9, 3.7581271620221*^9, 3.758127383701069*^9, 
   3.758128685743064*^9, 3.7581755549127617`*^9, 3.759224766750293*^9, 
   3.759291674252561*^9, 3.759293753820305*^9, 3.759296915413649*^9, 
   3.759312199752008*^9, 3.759373982622139*^9, 3.759375935102577*^9, 
   3.759381445308099*^9, 3.759385844077124*^9, 3.75940447618747*^9, 
   3.7594056381044207`*^9, 3.7594079903511333`*^9, 3.759409192367032*^9, 
   3.759472837755122*^9, 3.760692235345183*^9, 3.764327498483354*^9, 
   3.764782199889552*^9, 3.764782807817875*^9, 
   3.7647831384785852`*^9},ExpressionUUID->"86cca4fc-c93b-4e6d-bb93-\
f82d5713e6e7"]
}, Open  ]],

Cell["\<\
Alternatively, one can decompose a state using uniformly controlled gates by \
calling the column by column decomposition.  This requires one CNOT gate more \
in the considered case (but lowers the running time for large states). \
\>", "Text",
 CellChangeTimes->{{3.757516696336713*^9, 3.757516712504345*^9}, {
  3.75938102093292*^9, 3.759381120539817*^9}, {3.759381282583296*^9, 
  3.759381315549452*^9}, {3.7593813532559233`*^9, 3.759381381069434*^9}, {
  3.7593814278648148`*^9, 3.759381494294718*^9}, {3.759381547592679*^9, 
  3.759381578551941*^9}, {3.759408202598772*^9, 
  3.7594082160721693`*^9}},ExpressionUUID->"401cd3a2-bd13-4896-9644-\
f541651413c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"ColumnByColumnDec", "[", "state", "]"}]}]], "Input",
 CellChangeTimes->{{3.759381530673196*^9, 
  3.759381532708334*^9}},ExpressionUUID->"2cac7e6a-b5a4-4bbc-8880-\
b147e9db1d67"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2.1667914255793983`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.819170641741293`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2.8490729742521372`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.0447362996596214`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.0693237334018086`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.518836515282963`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4.195459750021605`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.8190115862270093`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.896852244217945`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.6725317018906556`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.5072484248671933`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.469197145505387`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.3041176870888473`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.6568301159347584`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.21384056130604615`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2.276560016903862`", ",", "3"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7593815335502567`*^9, 3.7593858441598186`*^9, 
  3.759404476225266*^9, 3.7594056381421432`*^9, 3.759407990388258*^9, 
  3.75940919240366*^9, 3.759472837826889*^9, 3.760692235465852*^9, 
  3.764327498609235*^9, 3.764782199943376*^9, 3.764782807858418*^9, 
  3.764783138529645*^9},ExpressionUUID->"44572f4f-6fe0-40f7-a4cc-\
eed23083c01f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.759381540051269*^9, 
  3.7593815435434523`*^9}},ExpressionUUID->"6eef6b5c-0464-4c80-aceb-\
7c46b2afe171"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.759381544148542*^9, 3.759385844243702*^9, 
  3.7594044762452097`*^9, 3.759405638164068*^9, 3.759407990407485*^9, 
  3.7594091924253197`*^9, 3.759472837851686*^9, 3.7606922355448627`*^9, 
  3.764327498695157*^9, 3.7647821999712257`*^9, 3.764782807889532*^9, 
  3.7647831385544043`*^9},ExpressionUUID->"bea73d5c-604b-44d7-9e5b-\
cf9283cfe657"]
}, Open  ]],

Cell["We can also use a special decomposition for sparse states", "Text",
 CellChangeTimes->{{3.814869138357448*^9, 
  3.814869151307572*^9}},ExpressionUUID->"3972457e-93df-468d-b26b-\
7a353f4ef487"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"state", "=", 
  RowBox[{"PickRandomSparsePsi", "[", 
   RowBox[{
    RowBox[{"2", "^", "7"}], ",", 
    RowBox[{"2", "^", "3"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.814869159549811*^9, 3.814869168629786*^9}, {
   3.81487348544446*^9, 3.814873514681884*^9}, {3.814873566030628*^9, 
   3.8148735805115137`*^9}, 3.814873649200212*^9, {3.814873732254614*^9, 
   3.814873742580338*^9}},
 CellLabel->
  "In[475]:=",ExpressionUUID->"5a3c05e7-5546-4635-b085-c0e377c4e406"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquarePlusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGCQAmJGIAaxrcp3x81SOmc/x3jRFvMfV+xfLFJ8HLjqlX1e
5NvwdxNu2BtZzfho8eaZffrtfp3/fu/tcanHJa7wPlRbuO6oPQMUiGw5+XCy
32WSzdlm8W6dzakL9sea6m7kPzhj/0uFXW/l1ec41YdPdTeYxn3Zfs3RJf0n
urfbn2AonH9e4QnJ9pIqrhuwS7Tc8qF9jVPnkVeTXtofr2XQ0p1Ieritm5/W
4/rrov3hilO5a+8dtlfwPKP87+FTe/H9hqUH2C7Ylz1LXTPh7G17vQtitzQl
3uA0Z/MWt9XLPS/at7OnBN/mW24fw92XUXnsAc3DAZc4AG4zRA8=
              "], {{0, 
              0}, {1, 26}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> 
             False, FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["8", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"128", ",", "1"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquareMinusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGCQAmJGIAaxrcp3x81SOmc/x3jRFvMfV+xfLFJ8HLjqlX1e
5NvwdxNu2BtZzfho8eaZffrtfp3/fu/tcanHJa7wPlRbuO6oPQMUiGw5+XCy
32WSzdlm8W6dzakL9sea6m7kPzhj/0uFXW/l1ec41YdPdTeYxn3Zfs3RJf0n
urfbn2AonH9e4QnJ9pIqrhuwS7Tc8qF9jVPnkVeTXtofr2XQ0p1Ieritm5/W
4/rrov3hilO5a+8dtlfwPKP87+FTe/H9hqUH2C7Ylz1LXTPh7G17vQtitzQl
3uA0Z/MWt9XLPS/at7OnBN/mW24fw92XUXnsAc3DAZc4AG4zRA8=
              "], {{0, 
              0}, {1, 26}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> 
             False, FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["8", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"128", ",", "1"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.0625`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"27", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.19268199535827588`"}], "-", 
                    RowBox[{"0.06434044848220602`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"40", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.050595813549424606`", "\[VeryThinSpace]"}], 
                    "+", 
                    RowBox[{"0.2464835832289197`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"43", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.1048056728067475`"}], "+", 
                    RowBox[{"0.1192248017737759`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"58", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.4392520668840033`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.19446498070230506`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {128, 1}, 0, {
   1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
     0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3, 3, 
     3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 
     4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 
     6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 
     7, 7, 7, 7, 7, 7, 8, 8, 8, 8}, {{1}, {1}, {1}, {1}, {1}, {1}, {1}, {
     1}}}, {Complex[-0.19268199535827588`, -0.06434044848220602], Complex[
     0.050595813549424606`, 0.2464835832289197], 
     Complex[-0.1048056728067475, 0.1192248017737759], Complex[
     0.4392520668840033, -0.19446498070230506`], 
     Complex[-0.11339180588350505`, -0.24439943342060397`], 
     Complex[-0.08264656688023991, 0.3210538505212477], 
     Complex[-0.45813749121033753`, 0.1525175174049835], Complex[
     0.39077412057706873`, 0.2666670037364407]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.814873499676278*^9, 3.814873514931733*^9}, {
   3.814873566609974*^9, 3.8148735809350367`*^9}, 3.814873649880966*^9, {
   3.814873733165175*^9, 3.8148737428531017`*^9}, 3.81488844778491*^9},
 CellLabel->
  "Out[475]=",ExpressionUUID->"518e08ec-f5a9-4fd6-b541-9c59d73fc5b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", "state", "]"}]], "Input",
 CellChangeTimes->{{3.814873604863909*^9, 3.814873607169505*^9}},
 CellLabel->
  "In[476]:=",ExpressionUUID->"1d56cc9c-700d-40b4-b275-8a8ffaa4b0e0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.19268199535827588`"}], "-", 
     RowBox[{"0.06434044848220602`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.050595813549424606`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.2464835832289197`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.1048056728067475`"}], "+", 
     RowBox[{"0.1192248017737759`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4392520668840033`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.19446498070230506`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.11339180588350505`"}], "-", 
     RowBox[{"0.24439943342060397`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.08264656688023991`"}], "+", 
     RowBox[{"0.3210538505212477`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.45813749121033753`"}], "+", 
     RowBox[{"0.1525175174049835`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.39077412057706873`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.2666670037364407`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.814873607447682*^9, {3.814873737781444*^9, 3.81487374452492*^9}, 
   3.814888449180636*^9},
 CellLabel->
  "Out[476]=",ExpressionUUID->"4431a047-1860-4d81-a3af-6bf6318ac166"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"gatelist", "=", 
   RowBox[{"SparseStatePreparation", "[", "state", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.814873751754201*^9, 3.814873799483285*^9}},
 CellLabel->
  "In[477]:=",ExpressionUUID->"787f29c3-dd77-45d0-9bf9-b8f69cc676db"],

Cell[BoxData["149"], "Output",
 CellChangeTimes->{{3.8148737577377577`*^9, 3.8148738001474247`*^9}, 
   3.814888452261896*^9},
 CellLabel->
  "Out[477]=",ExpressionUUID->"e4aab031-6813-459c-a0cd-118cbc6365d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}], "]"}]}], 
  ";", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"out", "*", 
     RowBox[{
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Normal", "[", "state", "]"}], "]"}], ",", "0"}], "]"}], 
       "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Normal", "[", "out", "]"}], "]"}], ",", "0"}], "]"}], "[", 
       
       RowBox[{"[", "1", "]"}], "]"}]}]}], "-", "state"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.81487380528106*^9, 3.814873817042997*^9}, {
  3.814873866625826*^9, 3.814873868805784*^9}, {3.8148739200122643`*^9, 
  3.814873961032216*^9}},
 CellLabel->
  "In[479]:=",ExpressionUUID->"84b6c2ba-9899-42dd-878c-6336cbd081b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8148738122829647`*^9, 3.814873817738371*^9}, {
   3.814873943444702*^9, 3.8148739616395283`*^9}, 3.814888463339366*^9},
 CellLabel->
  "Out[479]=",ExpressionUUID->"2efb52f2-2e33-498e-a8c3-089375425416"]
}, Open  ]],

Cell["Dense state preparation is worse:", "Text",
 CellChangeTimes->{{3.8148739749905577`*^9, 
  3.814873982272678*^9}},ExpressionUUID->"d486fb96-390e-478a-b6c3-\
8ddeea37be4c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"StatePreparation", "[", "state", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8148737642267637`*^9, 3.8148737909619293`*^9}},
 CellLabel->
  "In[480]:=",ExpressionUUID->"1a9d2ee1-264f-4def-a027-4f8474061015"],

Cell[BoxData["374"], "Output",
 CellChangeTimes->{{3.814873772579597*^9, 3.8148737922568293`*^9}, 
   3.814888467643867*^9},
 CellLabel->
  "Out[480]=",ExpressionUUID->"ad7986d2-4278-4c27-b02c-90a2fbb10306"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analytic calculations", "Subsection",
 CellChangeTimes->{{3.7591444955295477`*^9, 
  3.759144504096755*^9}},ExpressionUUID->"f4aafe88-fa16-45f2-8ba5-\
fa1d4c77208f"],

Cell["We can also do analytic calculations", "Text",
 CellChangeTimes->{{3.7575172544095*^9, 
  3.757517260442649*^9}},ExpressionUUID->"8e6e76b9-188a-4c85-8f60-\
111065d6cc69"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"u", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "/", 
   RowBox[{"2", "^", 
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7575172664783573`*^9, 3.757517310022407*^9}},
 CellLabel->
  "In[464]:=",ExpressionUUID->"398ad519-a901-442f-8655-c0df5c52f44c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], ",", "0", ",", "0", ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      SqrtBox["2"]], ",", 
     FractionBox["1", 
      SqrtBox["2"]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", "0", ",", "0", ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      SqrtBox["2"]], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.757517310502611*^9, 3.7575273868220253`*^9, 3.757527853420762*^9, 
   3.757533836385603*^9, 3.757534371808511*^9, 3.757534820185917*^9, 
   3.757581459720957*^9, 3.7576077306976*^9, 3.757610009797076*^9, 
   3.757611695165742*^9, 3.757611780380012*^9, 3.75761193861031*^9, 
   3.75769002820376*^9, 3.757690100992082*^9, 3.757690222946209*^9, {
   3.757690289709354*^9, 3.7576903420287027`*^9}, 3.7576928175464582`*^9, 
   3.757713415714304*^9, 3.758114475127283*^9, {3.758126678778531*^9, 
   3.758126705251917*^9}, 3.758126747627638*^9, 3.758127162042482*^9, 
   3.7581273837190943`*^9, 3.758128685763332*^9, 3.75817555493023*^9, 
   3.759224766784504*^9, 3.759291674267696*^9, 3.759293753837542*^9, 
   3.7592969154293423`*^9, 3.759312199819612*^9, 3.7593739827399797`*^9, 
   3.759375935169935*^9, 3.7593816847776823`*^9, 3.759382829082761*^9, 
   3.759385844327169*^9, 3.7594044762651033`*^9, 3.759405638185213*^9, 
   3.7594061877087297`*^9, 3.759407773608618*^9, 3.7594079904286823`*^9, 
   3.759409192445957*^9, 3.759472837891941*^9, 3.7606922356249104`*^9, 
   3.764327498834484*^9, 3.764782199977283*^9, 3.764782807919147*^9, 
   3.76478313858099*^9, 3.814888343629204*^9},
 CellLabel->
  "Out[464]=",ExpressionUUID->"56fe248c-64d5-4931-841e-cc1d6d3dc357"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"QSD", "[", "u", "]"}]}]], "Input",
 CellChangeTimes->{{3.757517328518024*^9, 3.757517332854033*^9}},
 CellLabel->
  "In[471]:=",ExpressionUUID->"ff0f51f9-ee3f-422f-9e4a-ab500556a69d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "2"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     FractionBox["\[Pi]", "2"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "2"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "2"], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     FractionBox["\[Pi]", "2"], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "2"], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["\[Pi]", "2"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox[
      RowBox[{"3", " ", "\[Pi]"}], "2"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\[Pi]", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox[
      RowBox[{"3", " ", "\[Pi]"}], "2"], ",", "1"}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.75751733337391*^9, 3.7575273883665953`*^9, 3.7575278535081882`*^9, 
   3.757533836459567*^9, 3.7575343718937073`*^9, 3.757534820263132*^9, 
   3.757581459794898*^9, 3.757607730777462*^9, 3.75761000987542*^9, 
   3.757611695254966*^9, 3.757611780461762*^9, 3.757611938721735*^9, 
   3.757690028273685*^9, 3.7576901010713882`*^9, 3.757690223014485*^9, {
   3.75769028978104*^9, 3.757690342115279*^9}, 3.757692817615706*^9, 
   3.757713415774578*^9, 3.758114476521556*^9, {3.758126678841358*^9, 
   3.758126705315126*^9}, 3.758126747690387*^9, 3.758127162116647*^9, 
   3.758127383793207*^9, 3.758128685822297*^9, 3.758175554992453*^9, 
   3.759224766931724*^9, 3.759291674340077*^9, 3.759293753907023*^9, 
   3.759296915503046*^9, 3.759312199932886*^9, 3.7593739828411407`*^9, 
   3.7593759352439537`*^9, 3.759381685887436*^9, 3.759385844454339*^9, 
   3.759404476355935*^9, 3.759405638285103*^9, 3.759407774531767*^9, 
   3.759407990490629*^9, 3.759409192542321*^9, 3.7594728380165663`*^9, 
   3.7606922358359127`*^9, 3.764327498949148*^9, 3.7647822000687017`*^9, 
   3.764782808000965*^9, 3.764783138666665*^9, 3.814888344705019*^9, 
   3.8148883852756863`*^9},
 CellLabel->
  "Out[471]=",ExpressionUUID->"40158e58-014c-485b-84c7-f30e9c64ebb9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"outu", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}]}], ";", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"outu", "/", 
      RowBox[{"outu", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"u", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "u"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.7575173358553247`*^9, 3.757517351664289*^9}, {
   3.757527376303652*^9, 3.757527382615747*^9}, {3.7576902994710817`*^9, 
   3.757690299943022*^9}, {3.758126692315504*^9, 3.7581266937571707`*^9}, 
   3.7617127325248127`*^9, {3.814888352402072*^9, 3.814888381425147*^9}},
 CellLabel->
  "In[472]:=",ExpressionUUID->"fe937f34-29f6-481c-a03b-9f0b129835af"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.757517346313857*^9, 3.757517352120369*^9}, {
   3.757527383125897*^9, 3.7575273905020933`*^9}, 3.75752785359594*^9, 
   3.75753383652702*^9, 3.757534371990439*^9, 3.757534820330884*^9, 
   3.757581459877339*^9, 3.757607730843143*^9, 3.757610009931484*^9, 
   3.757611695319512*^9, 3.757611780540288*^9, 3.757611938790303*^9, 
   3.757690028306201*^9, 3.757690101105205*^9, 3.757690223046183*^9, {
   3.757690289811294*^9, 3.757690342189321*^9}, 3.757692817647821*^9, 
   3.7577134158260717`*^9, 3.758114477876045*^9, {3.758126678867679*^9, 
   3.7581267053612947`*^9}, 3.75812674773844*^9, 3.758127162172765*^9, 
   3.758127383866899*^9, 3.758128685866045*^9, 3.758175555046879*^9, 
   3.759224767058138*^9, 3.75929167440702*^9, 3.759293753981277*^9, 
   3.7592969155698557`*^9, 3.759312200169949*^9, 3.7593739829034557`*^9, 
   3.759375935298554*^9, 3.7593816874036427`*^9, 3.759385844606254*^9, 
   3.7594044764219*^9, 3.759405638356463*^9, 3.7594077753859673`*^9, 
   3.759407990539412*^9, 3.759409192607788*^9, 3.7594728380799513`*^9, 
   3.7606922359387903`*^9, 3.764327499060708*^9, 3.764782200134247*^9, 
   3.764782808076442*^9, 3.7647831387342033`*^9, {3.814888346092946*^9, 
   3.81488838629079*^9}},
 CellLabel->
  "Out[472]=",ExpressionUUID->"c49f2f7b-64e2-4892-82f1-8c3bb7cf0c1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"ColumnByColumnDec", "[", "u", "]"}]}]], "Input",
 CellChangeTimes->{{3.75751736068784*^9, 3.7575173625964403`*^9}},
 CellLabel->
  "In[473]:=",ExpressionUUID->"6a448a75-412f-41ff-9ad5-dbb68656d95f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "2"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "2"], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox[
      RowBox[{"3", " ", "\[Pi]"}], "2"], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "2"], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     FractionBox["\[Pi]", "2"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "2"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox[
      RowBox[{"3", " ", "\[Pi]"}], "2"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     FractionBox[
      RowBox[{"3", " ", "\[Pi]"}], "2"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     FractionBox["\[Pi]", "2"], ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7575173631935463`*^9, 3.757527394076583*^9, 3.7575278536593513`*^9, 
   3.7575338365828943`*^9, 3.757534372047656*^9, 3.757534820396587*^9, 
   3.757581459934256*^9, 3.757607730902492*^9, 3.7576100099907417`*^9, 
   3.757611695402623*^9, 3.757611780608058*^9, 3.7576119388605013`*^9, 
   3.757690028354393*^9, 3.757690101156036*^9, 3.7576902230988073`*^9, {
   3.757690289872231*^9, 3.757690342239686*^9}, 3.757692817706668*^9, 
   3.757713415870036*^9, 3.75811447859895*^9, {3.7581266789201317`*^9, 
   3.758126705408203*^9}, 3.7581267477859*^9, 3.758127162221607*^9, 
   3.7581273839272547`*^9, 3.758128685910836*^9, 3.758175555093877*^9, 
   3.759224767209711*^9, 3.759291674466735*^9, 3.759293754051112*^9, 
   3.7592969156296997`*^9, 3.759312200286087*^9, 3.759373982985561*^9, 
   3.759375935370701*^9, 3.7593816890048647`*^9, 3.759385844701894*^9, 
   3.759404476485491*^9, 3.759405638417962*^9, 3.759406187825396*^9, 
   3.7594077768559713`*^9, 3.7594079905922937`*^9, 3.7594091926698027`*^9, 
   3.7594728381623783`*^9, 3.760692236076076*^9, 3.764327499191122*^9, 
   3.764782200201199*^9, 3.764782808141062*^9, 3.764783138803938*^9, {
   3.814888368466914*^9, 3.8148883873133593`*^9}},
 CellLabel->
  "Out[473]=",ExpressionUUID->"52e7a2bf-40c8-455b-8c95-275d0629bf9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"outu", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}]}], ";", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"outu", "/", 
      RowBox[{"outu", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"u", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "u"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.7575173797859707`*^9, 3.7575174034835443`*^9}, {
   3.75752740169552*^9, 3.7575274055942583`*^9}, {3.757690329262306*^9, 
   3.7576903297902*^9}, {3.758126709583047*^9, 3.758126710565688*^9}, 
   3.7617127325373373`*^9},
 CellLabel->
  "In[474]:=",ExpressionUUID->"66a88cc5-7485-49e0-b676-b3546d2e75e2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.757517370381271*^9, 3.7575174040957403`*^9, 3.757527406595263*^9, 
   3.757527853688056*^9, 3.7575338366106243`*^9, 3.757534372083069*^9, 
   3.75753482042914*^9, 3.757581459965733*^9, 3.757607730932087*^9, 
   3.757610010029274*^9, 3.757611695436352*^9, 3.757611780642065*^9, 
   3.757611938899963*^9, 3.757690028418438*^9, 3.7576901011908503`*^9, 
   3.757690223138117*^9, {3.7576902899084387`*^9, 3.757690342276905*^9}, 
   3.757692817743029*^9, 3.757713415890951*^9, 3.758114479606538*^9, {
   3.7581266789589777`*^9, 3.758126705446459*^9}, 3.7581267478100224`*^9, 
   3.7581271622422657`*^9, 3.758127383948641*^9, 3.758128685951318*^9, 
   3.758175555114519*^9, 3.759224767385613*^9, 3.759291674490796*^9, 
   3.759293754077993*^9, 3.759296915659779*^9, 3.759312200371337*^9, 
   3.759373983036721*^9, 3.759375935424934*^9, 3.759381690432539*^9, 
   3.759385844794755*^9, 3.759404476510889*^9, 3.759405638441595*^9, 
   3.75940777772746*^9, 3.759407990614222*^9, 3.759409192694215*^9, 
   3.759472838201583*^9, 3.7606922361678*^9, 3.764327499282013*^9, 
   3.764782200231037*^9, 3.7647828081727133`*^9, 3.764783138832542*^9, {
   3.814888370910795*^9, 3.814888388049374*^9}},
 CellLabel->
  "Out[474]=",ExpressionUUID->"66d49c37-9abc-4992-99a1-a0fecb839ed4"]
}, Open  ]],

Cell["Print Circuit can also be used to show the output", "Text",
 CellChangeTimes->{{3.7594058538454857`*^9, 
  3.759405863557639*^9}},ExpressionUUID->"52d8537e-671a-4ba5-b29c-\
ccc2e2369266"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.759405836881555*^9, 
  3.759405847719487*^9}},ExpressionUUID->"9212425b-c884-4e3e-adb8-\
3351aad96a52"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -1.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -1.}, {11., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -1.}, {12., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -1.}, {11., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -1.}, {13., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {12., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {10., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -2.}, {11., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], 
      LineBox[{{12., -2.}, {13., -2.}}]}}, {{}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{3., -1.2}, {3., -0.8}}], 
       LineBox[{{2.8, -1.}, {3.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -1.2}, {5., -0.8}}], 
       LineBox[{{4.8, -1.}, {5.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -1.2}, {6.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {6., -1.}]}}, {}, 
     {GrayLevel[0], DiskBox[{8., -1.}, 0.1]}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{11., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{11., -1.2}, {11., -0.8}}], 
       LineBox[{{10.8, -1.}, {11.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{11.8, -1.2}, {12.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {12., -1.}]}}, {}, 
     {GrayLevel[0], DiskBox[{3., -2.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{5., -2.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{11., -2.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -2.}]}}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -2.2}, {6.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -2.2}, {7.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {7., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{8., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{8., -2.2}, {8., -1.8}}], 
       LineBox[{{7.8, -2.}, {8.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -2.2}, {9.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {9., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -2.2}, {10.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {10., -2.}]}}, {}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGCQAmIQDQEf7KH0fqiAAyqfA40vgMYXQeNLoPFl0PgKaHwl
NL4KGl8Nja+BxtfC4V6GA6jug/HV0Pgw/8P4DGjyAmh8CTS+DBpfAY2vhMZX
QeNroPG14HwA8aAsRQ==
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{688., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.759406187861223*^9, 3.759407779121296*^9, 
  3.759407990641773*^9, 3.759409192716783*^9, 3.759472838253474*^9, 
  3.760692236271339*^9, 3.7643274993849382`*^9, 3.764782200261799*^9, 
  3.764782808206203*^9, 
  3.7647831388705587`*^9},ExpressionUUID->"5a761a3d-5ee4-4ad5-be45-\
94ee7704aa35"]
}, Open  ]],

Cell["\<\
The option AnglePrecision->1 shows the angles (because they are exact, any \
precision above 0 can be used)\
\>", "Text",
 CellChangeTimes->{{3.759405870055407*^9, 
  3.759405921242215*^9}},ExpressionUUID->"fbbd3b1c-cdd8-44be-ac02-\
8977f057bbc6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", 
  RowBox[{
   RowBox[{"Take", "[", 
    RowBox[{"gatelist", ",", "6"}], "]"}], ",", 
   RowBox[{"AnglePrecision", "\[Rule]", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.759405896648553*^9, 3.759405901750627*^9}, {
  3.7594062207687683`*^9, 3.759406231340534*^9}, {3.75940634670197*^9, 
  3.759406363727571*^9}},ExpressionUUID->"ecba03b0-93e7-471e-b130-\
52c26202be96"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], 
      LineBox[{{6., -2.}, {7., -2.}}]}}, {{}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"\\!\\(\\*InterpretationBox[\\\"\\\\\\\"Rz(\\\\\\\\!\\\\\\\
\\(\\\\\\\\*FractionBox[\\\\\\\\\\\\\\\"\[Pi]\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\
\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"2\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\
\\\\\"]\\\\\\\\))\\\\\\\"\\\", StringForm[\\\"Rz(`1`)\\\", \
ScientificForm[Times[Rational[1, 2], Pi], 1]], Rule[Editable, \
False]]\\)\"\>", {2., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{3., -1.2}, {3., -0.8}}], 
       LineBox[{{2.8, -1.}, {3.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"\\!\\(\\*InterpretationBox[\\\"\\\\\\\"Rz(\\\\\\\\!\\\\\\\
\\(\\\\\\\\*FractionBox[RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\"3\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\" \
\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"\[Pi]\\\\\\\\\\\\\\\"}], \\\\\\\\\\\\\\\"\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"2\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\"]\\\\\\\\))\\\\\\\"\\\", StringForm[\\\"Rz(`1`)\\\", \
ScientificForm[Times[Rational[3, 2], Pi], 1]], Rule[Editable, \
False]]\\)\"\>", {4., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -1.2}, {5., -0.8}}], 
       LineBox[{{4.8, -1.}, {5.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -1.2}, {6.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"\\!\\(\\*InterpretationBox[\\\"\\\\\\\"Rz(\\\\\\\\!\\\\\\\
\\(\\\\\\\\*FractionBox[\\\\\\\\\\\\\\\"\[Pi]\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\
\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"2\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\
\\\\\"]\\\\\\\\))\\\\\\\"\\\", StringForm[\\\"Rz(`1`)\\\", \
ScientificForm[Times[Rational[1, 2], Pi], 1]], Rule[Editable, \
False]]\\)\"\>", {6., -1.}]}}, {}, 
     {GrayLevel[0], DiskBox[{3., -2.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{5., -2.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"\\!\\(\\*InterpretationBox[\\\"\\\\\\\"Rz(\\\\\\\\!\\\\\\\
\\(\\\\\\\\*FractionBox[\\\\\\\\\\\\\\\"\[Pi]\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\
\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"2\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\
\\\\\"]\\\\\\\\))\\\\\\\"\\\", StringForm[\\\"Rz(`1`)\\\", \
ScientificForm[Times[Rational[1, 2], Pi], 1]], Rule[Editable, \
False]]\\)\"\>", {2., -2.}]}}, {}, {}, {}}},
   Annotation[#, 
    VertexCoordinateRules -> {{1., -1.}, {2., -1.}, {3., -1.}, {4., -1.}, {
     5., -1.}, {6., -1.}, {7., -1.}, {3., -2.}, {5., -2.}, {1., -2.}, {
     2., -2.}, {4., -2.}, {6., -2.}, {7., -2.}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{906., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.759406187899663*^9, 3.759406231894771*^9, {3.759406355605739*^9, 
   3.7594063639436007`*^9}, 3.759407780389803*^9, 3.759407990657486*^9, 
   3.759409192740856*^9, 3.759472838278986*^9, 3.760692236370069*^9, 
   3.764327499461218*^9, 3.7647822002766047`*^9, 3.764782808237589*^9, 
   3.7647831389036818`*^9},ExpressionUUID->"03eec5ea-d1ed-4ca4-8c86-\
39904bf74289"]
}, Open  ]],

Cell["If non-exact output is desired, can use NGateList", "Text",
 CellChangeTimes->{{3.7594059352095537`*^9, 
  3.7594059720734777`*^9}},ExpressionUUID->"b572bc16-8648-47d4-aac9-\
090cf69a9b9d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", 
  RowBox[{
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"NGateList", "[", "gatelist", "]"}], ",", "6"}], "]"}], ",", 
   RowBox[{"AnglePrecision", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.759405978347145*^9, 3.7594059843193007`*^9}, {
  3.7594062594551907`*^9, 
  3.759406331760582*^9}},ExpressionUUID->"35492735-479f-4bd1-b2f4-\
c3fe80e72c6f"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], 
      LineBox[{{6., -2.}, {7., -2.}}]}}, {{}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"\\!\\(\\*InterpretationBox[\\\"\\\\\\\"Rz(\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"1.6\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\))\\\\\\\"\\\", \
StringForm[\\\"Rz(`1`)\\\", ScientificForm[1.5707963267948966`, 2]], \
Rule[Editable, False]]\\)\"\>", {2., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{3., -1.2}, {3., -0.8}}], 
       LineBox[{{2.8, -1.}, {3.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"\\!\\(\\*InterpretationBox[\\\"\\\\\\\"Rz(\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"4.7\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\))\\\\\\\"\\\", \
StringForm[\\\"Rz(`1`)\\\", ScientificForm[4.71238898038469`, 2]], \
Rule[Editable, False]]\\)\"\>", {4., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -1.2}, {5., -0.8}}], 
       LineBox[{{4.8, -1.}, {5.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -1.2}, {6.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"\\!\\(\\*InterpretationBox[\\\"\\\\\\\"Rz(\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"1.6\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\))\\\\\\\"\\\", \
StringForm[\\\"Rz(`1`)\\\", ScientificForm[1.5707963267948966`, 2]], \
Rule[Editable, False]]\\)\"\>", {6., -1.}]}}, {}, 
     {GrayLevel[0], DiskBox[{3., -2.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{5., -2.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"\\!\\(\\*InterpretationBox[\\\"\\\\\\\"Rz(\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"1.6\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\))\\\\\\\"\\\", \
StringForm[\\\"Rz(`1`)\\\", ScientificForm[1.5707963267948966`, 2]], \
Rule[Editable, False]]\\)\"\>", {2., -2.}]}}, {}, {}, {}}},
   Annotation[#, 
    VertexCoordinateRules -> {{1., -1.}, {2., -1.}, {3., -1.}, {4., -1.}, {
     5., -1.}, {6., -1.}, {7., -1.}, {3., -2.}, {5., -2.}, {1., -2.}, {
     2., -2.}, {4., -2.}, {6., -2.}, {7., -2.}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{781., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.759406187939268*^9, {3.759406245532918*^9, 3.759406332091694*^9}, 
   3.759407782367374*^9, 3.759407990675118*^9, 3.759409192767494*^9, 
   3.759472838342572*^9, 3.760692236472275*^9, 3.764327499581339*^9, 
   3.7647822002938347`*^9, 3.7647828082687387`*^9, 
   3.764783138937243*^9},ExpressionUUID->"56df857d-917c-4564-ad7b-\
025079284081"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LatexQCircuit", "[", 
  RowBox[{
   RowBox[{"Take", "[", 
    RowBox[{"gatelist", ",", "6"}], "]"}], ",", 
   RowBox[{"AnglePrecision", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.75940650616541*^9, 
  3.7594065208587418`*^9}},ExpressionUUID->"0a4ad435-be6c-43ea-be24-\
b878510e30e0"],

Cell[BoxData["\<\"{\\n& \\\\qw  & \\!\\(\\*InterpretationBox[\\\"\\\\\\\"\\\\\
\\\\\\\\\\\\gate{R_z(\\\\\\\\\\\\\\\\textnormal{$\\\\\\\\\\\\\\\\frac{\\\\\\\\\
\\\\\\\\pi }{2}$})}\\\\\\\"\\\", \
StringForm[\\\"\\\\\\\\gate{R_z(\\\\\\\\textnormal{$`1`$})}\\\", \
\\\"\\\\\\\\frac{\\\\\\\\pi }{2}\\\"], Rule[Editable, False]]\\) & \\\\targ & \
\\!\\(\\*InterpretationBox[\\\"\\\\\\\"\\\\\\\\\\\\\\\\gate{R_z(\\\\\\\\\\\\\\\
\\textnormal{$\\\\\\\\\\\\\\\\frac{3 \\\\\\\\\\\\\\\\pi }{2}$})}\\\\\\\"\\\", \
StringForm[\\\"\\\\\\\\gate{R_z(\\\\\\\\textnormal{$`1`$})}\\\", \
\\\"\\\\\\\\frac{3 \\\\\\\\pi }{2}\\\"], Rule[Editable, False]]\\) & \\\\targ \
& \\!\\(\\*InterpretationBox[\\\"\\\\\\\"\\\\\\\\\\\\\\\\gate{R_z(\\\\\\\\\\\\\
\\\\textnormal{$\\\\\\\\\\\\\\\\frac{\\\\\\\\\\\\\\\\pi }{2}$})}\\\\\\\"\\\", \
StringForm[\\\"\\\\\\\\gate{R_z(\\\\\\\\textnormal{$`1`$})}\\\", \
\\\"\\\\\\\\frac{\\\\\\\\pi }{2}\\\"], Rule[Editable, False]]\\) & \\\\qw  \\\
\\\\\\\\n& \\\\qw  & \
\\!\\(\\*InterpretationBox[\\\"\\\\\\\"\\\\\\\\\\\\\\\\gate{R_z(\\\\\\\\\\\\\\\
\\textnormal{$\\\\\\\\\\\\\\\\frac{\\\\\\\\\\\\\\\\pi }{2}$})}\\\\\\\"\\\", \
StringForm[\\\"\\\\\\\\gate{R_z(\\\\\\\\textnormal{$`1`$})}\\\", \
\\\"\\\\\\\\frac{\\\\\\\\pi }{2}\\\"], Rule[Editable, False]]\\) & \
\\\\ctrl{-1} & \\\\qw  & \\\\ctrl{-1} & \\\\qw  & \\\\qw  \\n}\"\>"], "Output",\

 CellChangeTimes->{{3.759406509154728*^9, 3.7594065213567963`*^9}, 
   3.759407784323264*^9, 3.759407990686021*^9, 3.759409192793347*^9, 
   3.759472838410365*^9, 3.7606922365474873`*^9, 3.7643274996903343`*^9, 
   3.764782200304652*^9, 3.764782808302902*^9, 
   3.764783138968652*^9},ExpressionUUID->"acd1e5e6-8393-48bd-9e34-\
0c51460e9b16"]
}, Open  ]],

Cell["The exact computations rapidly become time consuming", "Text",
 CellChangeTimes->{{3.757517703741518*^9, 
  3.757517716048285*^9}},ExpressionUUID->"552fcdda-5c39-401b-99d1-\
a5837a26e4a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["5", 
        RowBox[{"3", " ", 
         SqrtBox["26"]}]], ",", 
       FractionBox["1", 
        RowBox[{"3", " ", 
         SqrtBox["26"]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         SqrtBox["26"]]}], ",", 
       FractionBox["5", 
        SqrtBox["26"]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"5", " ", 
         SqrtBox[
          FractionBox["2", "13"]]}], "3"], ",", 
       FractionBox[
        SqrtBox[
         FractionBox["2", "13"]], "3"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"5", " ", 
         SqrtBox[
          FractionBox["2", "13"]]}], "3"], ",", 
       FractionBox[
        SqrtBox[
         FractionBox["2", "13"]], "3"]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7575176797520323`*^9, 
  3.757517698716528*^9}},ExpressionUUID->"224f0a17-01b6-4593-a838-\
7a05718f0c91"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CT", "[", "u", "]"}], ".", "u"}]], "Input",
 CellChangeTimes->{{3.7575176863756866`*^9, 
  3.757517694005507*^9}},ExpressionUUID->"552ea2e1-1bf9-4ed2-a65b-\
7f99db654217"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.757517688326836*^9, 3.757517694376464*^9}, 
   3.757527412337574*^9, 3.7575278537239227`*^9, 3.757533836656107*^9, 
   3.7575343721198807`*^9, 3.757534820470439*^9, 3.757581460004553*^9, 
   3.757607730967264*^9, 3.757610010065529*^9, 3.7576116954768867`*^9, 
   3.757611780683139*^9, 3.757611938945271*^9, 3.757690028511973*^9, 
   3.7576901012418337`*^9, 3.757690223166234*^9, {3.7576902899374533`*^9, 
   3.757690342312984*^9}, 3.7576928177773647`*^9, 3.757713415910467*^9, 
   3.758114482943633*^9, {3.7581266790085382`*^9, 3.7581267054757967`*^9}, 
   3.758126747828953*^9, 3.758127162264884*^9, 3.758127383968199*^9, 
   3.758128685977703*^9, 3.758175555136063*^9, 3.759144523801388*^9, 
   3.759148394516654*^9, 3.759152586473418*^9, 3.759153316251145*^9, 
   3.759153459531197*^9, 3.759153802604917*^9, 3.7591543954537983`*^9, 
   3.759154511841905*^9, 3.759154596770175*^9, 3.759154730645368*^9, 
   3.759210302886435*^9, 3.75922476755727*^9, 3.7592916745083523`*^9, 
   3.759293754100918*^9, 3.759296915680662*^9, 3.759312200487444*^9, 
   3.759373983156516*^9, 3.75937593552221*^9, 3.759381693999144*^9, 
   3.75938584489452*^9, 3.7594044765403833`*^9, 3.759405638461698*^9, 
   3.7594079907111464`*^9, 3.75940919282117*^9, 3.759472838443591*^9, 
   3.7606922366298523`*^9, 3.7643274999980717`*^9, 3.7647822003454638`*^9, 
   3.7647828083383923`*^9, 
   3.764783139005158*^9},ExpressionUUID->"a3394e72-dd8b-4cb4-a13f-\
9fee2827c290"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"gatelist", "=", 
   RowBox[{"ColumnByColumnDec", "[", "u", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.757517436518847*^9, 3.7575174487640676`*^9}, {
  3.757517569087667*^9, 3.757517573084631*^9}, {3.757517722632564*^9, 
  3.757517726359372*^9}},ExpressionUUID->"dfb5e326-e96d-47b4-bd06-\
a784701653b8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8.876781`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "\[Pi]", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox[
        RowBox[{"3", " ", "\[Pi]"}], "4"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"\[Pi]", "-", 
        RowBox[{"2", " ", 
         RowBox[{"ArcTan", "[", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SqrtBox["2"]}], ")"}], "2"], "]"}]}]}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "\[Pi]", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"2", " ", 
        RowBox[{"ArcSec", "[", 
         SqrtBox[
          RowBox[{"18", "-", 
           RowBox[{"12", " ", 
            SqrtBox["2"]}]}]], "]"}]}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"\[Pi]", "-", 
        RowBox[{"2", " ", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           FractionBox["1", "5"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             SqrtBox["34"]}], ")"}]}], "]"}]}]}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "\[Pi]", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       FractionBox["\[Pi]", "4"], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"\[Pi]", "+", 
        RowBox[{"2", " ", 
         RowBox[{"ArcCot", "[", 
          FractionBox["10", 
           SqrtBox["17"]], "]"}]}]}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"\[Pi]", "-", 
        RowBox[{"2", " ", 
         RowBox[{"ArcCot", "[", 
          RowBox[{
           FractionBox["1", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SqrtBox["17"]}], ")"}]}], "]"}]}]}], ",", "2"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7575174933361473`*^9, 3.757517552487015*^9, 3.757517594070369*^9, 
   3.7575176691580667`*^9, 3.757517783149007*^9, 3.757517857507699*^9, 
   3.757527475485907*^9, 3.757527912678537*^9, 3.7575338573257732`*^9, 
   3.757534374853916*^9, 3.7575348326139708`*^9, 3.757581518142673*^9, 
   3.757607782393553*^9, 3.757610056534837*^9, 3.757611753435492*^9, 
   3.7576118223410463`*^9, 3.7576119931974916`*^9, 3.75769006355064*^9, 
   3.757690162581498*^9, 3.757690273357993*^9, {3.7576903054893293`*^9, 
   3.7576903340253*^9}, 3.757690386135557*^9, 3.757692868840473*^9, 
   3.757713454783443*^9, 3.758114531483634*^9, 3.758126698435934*^9, 
   3.758126741423456*^9, 3.758126795415772*^9, 3.758127212209305*^9, 
   3.758127387558979*^9, 3.758128732317912*^9, 3.7581755931894283`*^9, 
   3.759144539613469*^9, 3.759148410544405*^9, 3.759152588300617*^9, 
   3.7591531749517508`*^9, 3.759153318050892*^9, {3.759153474167728*^9, 
   3.759153491453525*^9}, 3.7591538173396273`*^9, 3.759153940213621*^9, 
   3.759154410122579*^9, 3.75915452647523*^9, 3.759154611260458*^9, 
   3.759154735854309*^9, 3.7591552488000927`*^9, 3.75921031765405*^9, 
   3.759212343194189*^9, 3.759224782636355*^9, 3.759291687099881*^9, 
   3.759293767110808*^9, 3.759296928293768*^9, 3.759312214121418*^9, 
   3.759373998031829*^9, 3.7593759490319633`*^9, 3.7593817027135143`*^9, 
   3.759385856124585*^9, 3.759404485020894*^9, 3.7594056456952477`*^9, 
   3.759407997916895*^9, 3.759409199949068*^9, 3.7594728480145607`*^9, 
   3.760692247986862*^9, 3.7643275111458893`*^9, 3.764782209431246*^9, 
   3.764782816951014*^9, 
   3.764783147713231*^9},ExpressionUUID->"cb0a5612-ad0d-4c42-aa16-\
9de7a03d13d4"]
}, Open  ]],

Cell["The output matches the original isometry (up to phase)", "Text",
 CellChangeTimes->{{3.7575181861532288`*^9, 3.757518203863703*^9}, {
  3.759210379825376*^9, 3.759210392209343*^9}, {3.759210423728546*^9, 
  3.759210425968513*^9}},ExpressionUUID->"68189830-ab36-4128-a5de-\
731b0db19983"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"outu", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.759210402049265*^9, 3.759210403713147*^9}, 
   3.761712732549642*^9},ExpressionUUID->"bdc88020-f9c6-42d9-9cd9-\
f080cb0cbb69"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"102.818027`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"5", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"7", "/", "8"}]]}], 
        RowBox[{"3", " ", 
         SqrtBox["26"]}]], ",", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"7", "/", "8"}]], 
        RowBox[{"3", " ", 
         SqrtBox["26"]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"7", "/", "8"}]], 
         SqrtBox["26"]]}], ",", 
       FractionBox[
        RowBox[{"5", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"7", "/", "8"}]]}], 
        SqrtBox["26"]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["5", "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"7", "/", "8"}]], " ", 
        SqrtBox[
         FractionBox["2", "13"]]}], ",", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"7", "/", "8"}]], " ", 
        SqrtBox[
         FractionBox["2", "13"]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["5", "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"7", "/", "8"}]], " ", 
        SqrtBox[
         FractionBox["2", "13"]]}], ",", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"7", "/", "8"}]], " ", 
        SqrtBox[
         FractionBox["2", "13"]]}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.759210405839568*^9, 3.7592104641242743`*^9, 
  3.759212308750181*^9, 3.759212414369697*^9, 3.759224858151639*^9, 
  3.759291788380443*^9, 3.759293869940524*^9, 3.759297028648808*^9, 
  3.759312281093419*^9, 3.7593740766277723`*^9, 3.7593760156274242`*^9, 
  3.759381763730394*^9, 3.7593859415822153`*^9, 3.759404585819652*^9, 
  3.759405742368823*^9, 3.759408095494987*^9, 3.759409297277627*^9, 
  3.759472910332019*^9, 3.760692328893214*^9, 3.764327587204113*^9, 
  3.764782311821821*^9, 3.764782821619474*^9, 
  3.764783250271041*^9},ExpressionUUID->"24c502a1-322c-4b1b-98e8-\
cf6dad63ef61"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"outu", "/", 
      RowBox[{"outu", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"u", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "u"}], "]"}], "//", 
  "MatrixForm"}]], "Input",ExpressionUUID->"43ddd6db-ec15-46d2-a80f-\
9b61ad5974a7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"},
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.759210464196027*^9, 3.759212308803301*^9, 
  3.759212414435001*^9, 3.759224858204301*^9, 3.759291788408856*^9, 
  3.759293869980547*^9, 3.759297028684333*^9, 3.7593122813013067`*^9, 
  3.759374076729926*^9, 3.759376015705469*^9, 3.7593817638353148`*^9, 
  3.7593859416795073`*^9, 3.759404585858529*^9, 3.75940574239559*^9, 
  3.759408095531006*^9, 3.759409297323121*^9, 3.759472910395007*^9, 
  3.7606923289796047`*^9, 3.764327587424829*^9, 3.7647823118490562`*^9, 
  3.764783250311055*^9},ExpressionUUID->"2426087a-7e0b-418a-938b-\
9be6d3084e61"]
}, Open  ]],

Cell["\<\
Generating the operator involves attempts to simplify so can be slow.  The \
option FullSimp->False sometimes yields just as good a result after a final \
simplification (and can be faster, even including the final simplification):\
\>", "Text",
 CellChangeTimes->{{3.759210431368289*^9, 3.759210458927745*^9}, {
  3.7592105101025553`*^9, 
  3.7592106199658537`*^9}},ExpressionUUID->"9dd56372-d0f4-4e5d-8bd0-\
86ad4bb1c818"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"outu", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"CreateOperationFromGateList", "[", 
     RowBox[{"gatelist", ",", 
      RowBox[{"FullSimp", "\[Rule]", "False"}]}], "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.757517791334187*^9, 3.7575177971941433`*^9}, {
   3.75751791116462*^9, 3.757517914146551*^9}, {3.757517966513151*^9, 
   3.757518012126622*^9}, {3.757527421860982*^9, 3.757527448884226*^9}, {
   3.7576903468701153`*^9, 3.757690347405953*^9}, {3.758114490079777*^9, 
   3.758114491540743*^9}, {3.759155269298643*^9, 3.759155303454887*^9}, {
   3.759210463447526*^9, 3.7592104871533833`*^9}, {3.7592105461439543`*^9, 
   3.7592105493430243`*^9}, 
   3.7617127325619*^9},ExpressionUUID->"3ec59178-d225-421a-9b38-5c64d13aa439"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"72.359349`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"5", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"7", "/", "8"}]]}], 
        RowBox[{"3", " ", 
         SqrtBox["26"]}]], ",", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"7", "/", "8"}]], 
        RowBox[{"3", " ", 
         SqrtBox["26"]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"7", "/", "8"}]], 
         SqrtBox["26"]]}], ",", 
       FractionBox[
        RowBox[{"5", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"7", "/", "8"}]]}], 
        SqrtBox["26"]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["5", "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"7", "/", "8"}]], " ", 
        SqrtBox[
         FractionBox["2", "13"]]}], ",", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"7", "/", "8"}]], " ", 
        SqrtBox[
         FractionBox["2", "13"]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["5", "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"7", "/", "8"}]], " ", 
        SqrtBox[
         FractionBox["2", "13"]]}], ",", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"7", "/", "8"}]], " ", 
        SqrtBox[
         FractionBox["2", "13"]]}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.757517857540578*^9, 3.757517946809888*^9, {3.7575180062854643`*^9, 
   3.7575180297050657`*^9}, 3.7575274844022293`*^9, 3.757527921317398*^9, 
   3.757581526720655*^9, 3.7576077913273697`*^9, 3.757610064978269*^9, 
   3.757611761915456*^9, 3.757612001702941*^9, 3.757690162654256*^9, 
   3.757690273429384*^9, 3.757690396857648*^9, 3.757692878810514*^9, 
   3.7577134617399197`*^9, 3.7581145385670233`*^9, 3.7581268026775637`*^9, 
   3.7581272193035803`*^9, 3.758128739279351*^9, 3.75817560001845*^9, 
   3.759144615285377*^9, 3.759152177823197*^9, 3.759153503800137*^9, {
   3.759155267756576*^9, 3.7591552975417356`*^9}, 3.759155328264407*^9, 
   3.759210499050232*^9, 3.759210578113213*^9, 3.759212316846307*^9, 
   3.759212445534724*^9, 3.759224891599806*^9, 3.7592918603475857`*^9, 
   3.7592939435508327`*^9, 3.7592971010645943`*^9, 3.7593123116221743`*^9, 
   3.75937408267607*^9, 3.759376046683025*^9, 3.759381787108696*^9, 
   3.759385978105028*^9, 3.759404658528708*^9, 3.759405810323612*^9, 
   3.759408163275795*^9, 3.759409364698781*^9, 3.759472941014838*^9, 
   3.760692364127619*^9, 3.76432762109207*^9, 3.764782389967379*^9, 
   3.764783322013526*^9},ExpressionUUID->"de873c4b-59b3-465c-b222-\
f5a15e231669"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"outu", "/", 
      RowBox[{"outu", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"u", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "u"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7592104951287193`*^9, 
  3.759210497462816*^9}},ExpressionUUID->"8c171959-ef67-47b9-8dd0-\
b6154ecb8ac7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"},
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7592105204724607`*^9, 3.75921062359542*^9, 
  3.759212316897695*^9, 3.759212445585866*^9, 3.7592248917233877`*^9, 
  3.7592918604558773`*^9, 3.75929394358785*^9, 3.7592971011469793`*^9, 
  3.759312311707424*^9, 3.759376046860503*^9, 3.759381787197873*^9, 
  3.759385978205949*^9, 3.759404658563242*^9, 3.75940581039876*^9, 
  3.759408163359228*^9, 3.759409364834792*^9, 3.7594729411391487`*^9, 
  3.7606923642909927`*^9, 3.764327621140719*^9, 3.764782389990355*^9, 
  3.7647833220522947`*^9},ExpressionUUID->"7b8943fd-1abc-44e7-8ace-\
c6bc82564e7f"]
}, Open  ]],

Cell["\<\
Using the option Simp->False can be faster (but gives a longer sequence):\
\>", "Text",
 CellChangeTimes->{{3.759212259057592*^9, 
  3.7592122723773823`*^9}},ExpressionUUID->"e36dfdf6-6bfb-43ab-aa50-\
7dc5ea635818"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"gatelist", "=", 
   RowBox[{"ColumnByColumnDec", "[", 
    RowBox[{"u", ",", 
     RowBox[{"Simp", "\[Rule]", "False"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.759212279569315*^9, 
  3.759212281961297*^9}},ExpressionUUID->"51e0f199-e429-4df8-8464-\
61d1cdd42eaf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.665365`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["\[Pi]", "2"], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["\[Pi]", "4"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"-", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"2", " ", 
          SqrtBox["2"]}], "]"}]}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "+", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"2", " ", 
          SqrtBox["2"]}], "]"}]}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["\[Pi]", "2"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        RowBox[{"ArcTan", "[", 
         FractionBox["15", "8"], "]"}]}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ArcTan", "[", 
          FractionBox["15", "8"], "]"}]}]}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"ArcCot", "[", 
          FractionBox["10", 
           SqrtBox["17"]], "]"}]}]}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "\[Pi]", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"-", 
        RowBox[{"ArcTan", "[", "4", "]"}]}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "+", 
        RowBox[{"ArcCot", "[", "4", "]"}]}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["\[Pi]", "2"], ",", "2"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7592122867279882`*^9, 3.759224896073977*^9, 
  3.759291863914653*^9, 3.759293947032214*^9, 3.759297104630793*^9, 
  3.759312315722117*^9, 3.7593760509529552`*^9, 3.7593818725894117`*^9, 
  3.759385982939828*^9, 3.759404662023727*^9, 3.759405813681487*^9, 
  3.759408166674362*^9, 3.759409368137401*^9, 3.7594729452933817`*^9, 
  3.76069236891955*^9, 3.764327625746622*^9, 3.764782393687909*^9, 
  3.764783325642193*^9},ExpressionUUID->"a250afe4-8616-4c22-ab31-\
c6c24bc6ff40"]
}, Open  ]],

Cell["By comparison, the numerical version is almost instantaneous", "Text",
 CellChangeTimes->{{3.757517760853202*^9, 3.757517779216269*^9}, {
  3.7576100452867727`*^9, 
  3.757610047677294*^9}},ExpressionUUID->"6c30a8a5-8126-4490-805a-\
c3e3cf8eee38"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"gatelist", "=", 
   RowBox[{"ColumnByColumnDec", "[", 
    RowBox[{"N", "[", "u", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.75751774546321*^9, 
  3.7575177470810833`*^9}},ExpressionUUID->"005494a5-f91b-4946-ad53-\
80681cb74459"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.026088`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3.141592653589794`", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2.3561944901923426`", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.33983690945412365`", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3.1415926535897962`", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.3398369094541249`", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4.171969480114106`", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3.141592653589793`", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3.926990816987236`", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3.9237400087827283`", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1.3258176636680334`", ",", "2"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQB+JA32dVT/+9dpS3vjkHRJte3mH7CkjLfNPJA9E8C2/N
Yvn/2vFxwrtcQSBtn6TUJQSknYsd4oSBtJGeZQ2IvrElfJklkL6jbrAFRFtp
zz8Mpifc/WkFpIvqdrK5AukY6wX3OBjeOM59En6LD0j/E8vh4wfSk+Syz4Do
NQlM69SAtPBj73v/Gd84rhZNF1JgeuN4iHv7ZxBtIcPKoQ6kdd7/2+UOpM9w
Je/3ANK7fop6eQHpC0ertgcCab/spGsFQHpGqfm6YiBttf/R+lIgzbfw0Lk6
kL6w7XH1QLou8npLA5D+xsMm3Qikly3VVlsApI9NVZ70meWNo1eK1cxH3G8c
/ReZLz/A88bxhdc26YNAGgBxqJiR
  
  "],ExpressionUUID->"e842bc6c-bce2-4ddc-be1c-07411f0b6446"]
}, Open  ]],

Cell["Again, the output matches:", "Text",
 CellChangeTimes->{{3.757518164804246*^9, 3.757518174813162*^9}, {
  3.759210661900838*^9, 
  3.759210665964275*^9}},ExpressionUUID->"509fcb14-ae28-48af-8666-\
3349f200ef3b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"outu", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}]}], ";", 
  RowBox[{
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"outu", "/", 
      RowBox[{"outu", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"u", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], "//", 
   "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.757517824317189*^9, 3.757517845120234*^9}, {
   3.757518063003933*^9, 3.757518087860969*^9}, {3.757527468492317*^9, 
   3.757527481117812*^9}, {3.7575275188628263`*^9, 3.757527518987133*^9}, {
   3.757690371126337*^9, 3.757690371637314*^9}, {3.75812671950355*^9, 
   3.75812672038701*^9}, 
   3.76171273257434*^9},ExpressionUUID->"d5f9cea0-3d19-4461-8f59-\
4a499e6037de"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.3268602252303068`", "0.06537204504605881`"},
     {
      RowBox[{"-", "0.19611613513818285`"}], "0.9805806756909181`"},
     {"0.6537204504606137`", "0.13074409009212465`"},
     {"0.6537204504606101`", "0.1307440900921201`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.757518056853923*^9, 3.757518095149229*^9}, 
   3.75752749402919*^9, {3.757527527870659*^9, 3.75752753547694*^9}, 
   3.7575279214329977`*^9, 3.7575815268656597`*^9, 3.757607791486538*^9, 
   3.75761006510433*^9, 3.7576117620490847`*^9, 3.757612001812752*^9, 
   3.757690162776029*^9, 3.757690273543844*^9, 3.7576903970014687`*^9, 
   3.757692878955358*^9, 3.75771346181423*^9, 3.758114550751543*^9, 
   3.758126802765472*^9, 3.758127219398197*^9, 3.758128739367339*^9, 
   3.758175600091704*^9, 3.759144692217051*^9, 3.7592106478614063`*^9, 
   3.759212445766473*^9, 3.759224896193346*^9, 3.7592918639891148`*^9, 
   3.759293947125163*^9, 3.759297104712324*^9, 3.759312315890663*^9, 
   3.759376051143828*^9, 3.759381879547105*^9, 3.759385983155951*^9, 
   3.759404662108684*^9, 3.759405813750471*^9, 3.759408166758236*^9, 
   3.759409368211051*^9, 3.759472945396517*^9, 3.7606923692016478`*^9, 
   3.764327625857222*^9, 3.764782393753641*^9, 
   3.7647833257201242`*^9},ExpressionUUID->"0f775a32-2ef8-401d-9814-\
b7a8a1c9542a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "[", "u", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.75751809586983*^9, 
  3.757518104756298*^9}},ExpressionUUID->"de9a51f9-57fa-4149-a05b-\
de70f7d37295"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.3268602252303068`", "0.06537204504606134`"},
     {
      RowBox[{"-", "0.19611613513818404`"}], "0.9805806756909202`"},
     {"0.6537204504606136`", "0.13074409009212268`"},
     {"0.6537204504606136`", "0.13074409009212268`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.75751809914774*^9, 3.757518104990717*^9}, 
   3.757527921461173*^9, 3.757581526898368*^9, 3.7576077915232487`*^9, 
   3.7576100651322937`*^9, 3.75761176208151*^9, 3.757612001837592*^9, 
   3.757690162784181*^9, 3.7576902735504103`*^9, 3.7576903970320053`*^9, 
   3.757692878961402*^9, 3.75771346183144*^9, 3.758114552194706*^9, 
   3.758126802783579*^9, 3.758127219418426*^9, 3.758128739386724*^9, 
   3.758175600108143*^9, 3.759144693514737*^9, 3.7592106758116217`*^9, 
   3.759212446542272*^9, 3.759224896199326*^9, 3.75929186401236*^9, 
   3.75929394715476*^9, 3.759297104735509*^9, 3.759312315956355*^9, 
   3.759376051227788*^9, 3.759381880769497*^9, 3.759385983228841*^9, 
   3.7594046621356897`*^9, 3.759405813771734*^9, 3.759408166786558*^9, 
   3.759409368231216*^9, 3.7594729454031467`*^9, 3.76069236926202*^9, 
   3.764327625863515*^9, 3.764782393769207*^9, 
   3.7647833257437963`*^9},ExpressionUUID->"582d994d-3423-44f1-817b-\
72287c427001"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", "gatelist", "]"}]], "Input",ExpressionUUID->"b352c0be-600f-4ae3-b9a7-4c56fef915ed"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -1.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -1.}, {11., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -1.}, {12., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {10., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -2.}, {11., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -2.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {12., -2.}}]}}, {
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -1.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -1.2}, {3.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -1.2}, {5., -0.8}}], 
       LineBox[{{4.8, -1.}, {5.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -1.2}, {6.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -1.}]}}, 
     {GrayLevel[0], DiskBox[{7., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{7.8, -1.2}, {8.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {8., -1.}]}}, {}, 
     {GrayLevel[0], DiskBox[{10., -1.}, 0.1]}, {}, {}, 
     {GrayLevel[0], DiskBox[{5., -2.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -2.}]}}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -2.2}, {6.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{7., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{7., -2.2}, {7., -1.8}}], 
       LineBox[{{6.8, -2.}, {7.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{7.8, -2.2}, {8.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {8., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -2.2}, {9.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{10., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{10., -2.2}, {10., -1.8}}], 
       LineBox[{{9.8, -2.}, {10.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{10.8, -2.2}, {11.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {11., -2.}]}}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGCQAGIQDQEf7KH0fqiAAyqfA40vgMYXQeNLoPFl0PgKaHwl
NL4KGl8Nja+Bw36GA6j+gfEZ0OQ50PgCaHwJNL4MGl8Bja+ExldB46uh8TXg
fAAD/ikA
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{598., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.759212482074594*^9, 3.759224896245932*^9, 
  3.7592918640440617`*^9, 3.759293947187152*^9, 3.759297104760734*^9, 
  3.759312316004382*^9, 3.759376051308824*^9, 3.7593818938220863`*^9, 
  3.759385983313426*^9, 3.7594046621663*^9, 3.759405813795094*^9, 
  3.759408166816585*^9, 3.7594093682605352`*^9, 3.75947294544951*^9, 
  3.760692369311124*^9, 3.764327625910861*^9, 3.764782393787812*^9, 
  3.764783325770329*^9},ExpressionUUID->"cf8c8a0a-0318-4236-a64c-\
dfffa9587243"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using the Knill decomposition for analytic calculations", \
"Subsubsection",
 CellChangeTimes->{{3.759212793965579*^9, 3.759212803368713*^9}, {
  3.75940830554987*^9, 
  3.759408305872514*^9}},ExpressionUUID->"6f886d0a-44f3-4125-9941-\
8fd2ab433932"],

Cell["\<\
The Knill decomposition is not good at handling analytic calculations at \
present. However, unitaries of a very simple form can be decomposed within a \
reasonable time.\
\>", "Text",
 CellChangeTimes->{{3.759291896045805*^9, 3.759291950395205*^9}, {
  3.7593820917033587`*^9, 3.759382156244179*^9}, {3.759383413552103*^9, 
  3.759383439054613*^9}, {3.7593834759267597`*^9, 3.7593835017830772`*^9}, {
  3.759383940223324*^9, 
  3.7593839933175287`*^9}},ExpressionUUID->"887d1e71-2938-4f08-8c0a-\
cb004cfb5c0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "5"]], ",", "0", 
       ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]], ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "5"]], ",", "0"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "15"]]}], "}"}]}],
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.759292139600416*^9, 3.7592921413004503`*^9}, {
   3.759292175941436*^9, 3.7592922725304193`*^9}, {3.759292398950659*^9, 
   3.759292424486721*^9}, {3.7592924546928883`*^9, 3.759292494610663*^9}, {
   3.759292702108334*^9, 3.759292702177084*^9}, 3.7592928259939938`*^9, 
   3.759383897306394*^9},ExpressionUUID->"f5bc932a-43a4-4412-b9b9-\
839659f7c478"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"gatelist", "=", 
   RowBox[{"KnillDec", "[", "u", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.759292155394019*^9, 3.7592921570814953`*^9}, 
   3.763036577675901*^9},ExpressionUUID->"0c0aa691-acf5-48c0-a00c-\
1a3d078a9f41"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.151672`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "\[Pi]", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "\[Pi]", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "\[Pi]", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "\[Pi]", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox[
        RowBox[{"7", " ", "\[Pi]"}], "30"], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox[
        RowBox[{"7", " ", "\[Pi]"}], "30"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox[
        RowBox[{"7", " ", "\[Pi]"}], "30"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "\[Pi]", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "\[Pi]", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox[
        RowBox[{"3", " ", "\[Pi]"}], "10"], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox[
        RowBox[{"3", " ", "\[Pi]"}], "10"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox[
        RowBox[{"3", " ", "\[Pi]"}], "10"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "\[Pi]", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "\[Pi]", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "\[Pi]", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "\[Pi]", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["\[Pi]", "3"], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["\[Pi]", "3"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["\[Pi]", "3"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "\[Pi]", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "\[Pi]", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]"}], "5"], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]"}], "5"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]"}], "5"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.759383793603362*^9, 3.759383902285207*^9, {3.7593840687992268`*^9, 
   3.7593840742664433`*^9}, 3.7593859836154537`*^9, 3.759404662326709*^9, 
   3.759405813980912*^9, 3.75940816701024*^9, 3.7594093684630013`*^9, 
   3.7594729456661263`*^9, 3.760692369617832*^9, 3.7643276261285887`*^9, 
   3.764782393956649*^9, 
   3.764783325927199*^9},ExpressionUUID->"98ad346e-2faf-4095-8ca9-\
66a2dc66bffc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sparse states analytically", "Subsubsection",
 CellChangeTimes->{{3.814891741679371*^9, 
  3.814891751744697*^9}},ExpressionUUID->"552eb4c6-a07c-406d-ac82-\
6bababe2bc37"],

Cell["\<\
For sparse states we can generate an exact one using FPickRandomSparsePsi\
\>", "Text",
 CellChangeTimes->{{3.8148884961230087`*^9, 
  3.814888527824849*^9}},ExpressionUUID->"17c0145a-4c34-4535-8214-\
dbb61298c9af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"state", "=", 
   RowBox[{"FPickRandomSparsePsi", "[", 
    RowBox[{"32", ",", "4", ",", "3"}], "]"}]}], ";", 
  RowBox[{"Normal", "[", "state", "]"}]}]], "Input",
 CellChangeTimes->{{3.814888518116873*^9, 3.8148885646723213`*^9}},
 CellLabel->
  "In[486]:=",ExpressionUUID->"80b7b5c4-933d-4d4c-88d8-7d1887067ded"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", " ", 
     SqrtBox[
      FractionBox["2", "79"]]}], "}"}], ",", 
   RowBox[{"{", 
    FractionBox["9", 
     SqrtBox["158"]], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", " ", 
     SqrtBox[
      FractionBox["2", "79"]]}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    FractionBox["5", 
     SqrtBox["158"]], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8148885356472797`*^9, 3.814888564857183*^9}},
 CellLabel->
  "Out[486]=",ExpressionUUID->"91736a38-b766-4d33-9b4c-461c74ff83ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"SparseStatePreparation", "[", "state", "]"}]}]], "Input",
 CellChangeTimes->{{3.814888569546302*^9, 3.8148885832585907`*^9}},
 CellLabel->
  "In[488]:=",ExpressionUUID->"10d81b3c-69a6-4b9d-a16d-5af86c9893fb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{
      RowBox[{"2", " ", "\[Pi]"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"ArcTan", "[", 
        SqrtBox[
         FractionBox[
          RowBox[{"79", "-", 
           RowBox[{"10", " ", 
            SqrtBox["58"]}]}], 
          RowBox[{"79", "+", 
           RowBox[{"10", " ", 
            SqrtBox["58"]}]}]]], "]"}]}]}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     FractionBox[
      RowBox[{"7", " ", "\[Pi]"}], "4"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\[Pi]", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\[Pi]", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"\[Pi]", "-", 
      RowBox[{"2", " ", 
       RowBox[{"ArcCot", "[", 
        RowBox[{
         FractionBox["1", "37"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "9"}], "+", 
           RowBox[{"5", " ", 
            SqrtBox["58"]}]}], ")"}]}], "]"}]}]}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"\[Pi]", "-", 
        RowBox[{"ArcTan", "[", 
         FractionBox["627", "364"], "]"}]}], ")"}]}], ",", "4"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"3", ",", "\[Pi]", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     FractionBox[
      RowBox[{"7", " ", "\[Pi]"}], "4"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     FractionBox["\[Pi]", "4"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\[Pi]", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     FractionBox["\[Pi]", "4"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8148885798198357`*^9, 3.8148885897327347`*^9}},
 CellLabel->
  "Out[488]=",ExpressionUUID->"093f2587-b236-44be-960a-3034b6283e97"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"CreateOperationFromGateList", "[", 
    RowBox[{"gatelist", ",", 
     RowBox[{"FullSimp", "\[Rule]", "False"}]}], "]"}]}], ";", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"out", "*", 
     RowBox[{
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Normal", "[", "state", "]"}], "]"}], ",", "0"}], "]"}], 
       "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Normal", "[", "out", "]"}], "]"}], ",", "0"}], "]"}], "[", 
       
       RowBox[{"[", "1", "]"}], "]"}]}]}], "-", "state"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8148886329114733`*^9, 3.814888644118106*^9}, {
  3.814888764229238*^9, 3.81488879753314*^9}},
 CellLabel->
  "In[493]:=",ExpressionUUID->"ac3bebda-cc11-44c7-a3c7-ea8c9705e7f7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.814888761252796*^9, 3.814888816457302*^9}},
 CellLabel->
  "Out[493]=",ExpressionUUID->"ca464287-8b8d-4663-aa51-b19de878c3f8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Performance for different system sizes", "Subsection",
 CellChangeTimes->{{3.7591447021482477`*^9, 
  3.7591447131958714`*^9}},ExpressionUUID->"6a2b2590-e8d2-4953-be08-\
7c786bc21851"],

Cell["Numerically we are able to work with large systems quickly", "Text",
 CellChangeTimes->{{3.757518077920445*^9, 3.757518080867519*^9}, {
  3.757518272907434*^9, 
  3.757518287027038*^9}},ExpressionUUID->"618f243f-8ad9-4f19-83e8-\
fcba9a0c0e2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"PickRandomUnitary", "[", 
    RowBox[{"2", "^", "5"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.757518295611693*^9, 3.757518309269421*^9}, {
  3.7575183457315817`*^9, 3.75751834598177*^9}, {3.759294670447521*^9, 
  3.759294671255643*^9}},ExpressionUUID->"d82e3224-3869-40dd-a6a0-\
61d315bc11c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"gatelist", "=", 
    RowBox[{"DecIsometryGeneric", "[", "u", "]"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757518314536619*^9, 3.757518336119945*^9}, {
  3.7575349901618013`*^9, 3.757534991797017*^9}, {3.757535984069079*^9, 
  3.757535984870933*^9}},ExpressionUUID->"649d4cc5-26ec-47e6-81a2-\
f097d1e4e6ad"],

Cell[BoxData["3.320984`"], "Output",
 CellChangeTimes->{{3.7575183388582087`*^9, 3.7575183521653*^9}, 
   3.757527925751918*^9, 3.757535070445567*^9, 3.757581531051758*^9, 
   3.757607795747138*^9, 3.757610069591707*^9, 3.75761176629408*^9, 
   3.757612006131886*^9, 3.757690167921603*^9, 3.757690278761177*^9, 
   3.7576904021363993`*^9, 3.757692884047241*^9, 3.7577134657009573`*^9, 
   3.7581145599709263`*^9, 3.75812680642314*^9, 3.758127223053397*^9, 
   3.758128743095393*^9, 3.758175603685899*^9, 3.7592939861670094`*^9, 
   3.759294674696766*^9, 3.759297159203257*^9, 3.7593127811352987`*^9, 
   3.75938598706824*^9, 3.7594046641800423`*^9, 3.759405815846348*^9, 
   3.75940816888927*^9, 3.7594093703106337`*^9, 3.7594729481678457`*^9, 
   3.76069237227258*^9, 3.76432762870938*^9, 3.764782395855646*^9, 
   3.764783327836565*^9},ExpressionUUID->"7b96daa3-cbf3-41c5-a2e2-\
4f64909b6920"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.7575183561689*^9, 
  3.7575183652637587`*^9}},ExpressionUUID->"259c2137-70df-4849-9c89-\
c85117e24587"],

Cell[BoxData["1677"], "Output",
 CellChangeTimes->{3.757518365625622*^9, 3.757527925792719*^9, 
  3.757535070496414*^9, 3.757581531088323*^9, 3.757607795796691*^9, 
  3.757610069637836*^9, 3.7576117663276577`*^9, 3.757612006160398*^9, 
  3.757690167969932*^9, 3.757690278793432*^9, 3.757690402182863*^9, 
  3.757692884093461*^9, 3.757713465723588*^9, 3.758114560014694*^9, 
  3.7581268064465523`*^9, 3.758127223077376*^9, 3.75812874312008*^9, 
  3.758175603709738*^9, 3.759293986193644*^9, 3.75929467473525*^9, 
  3.759297159238559*^9, 3.759312781696307*^9, 3.759385987164411*^9, 
  3.7594046642101603`*^9, 3.759405815875649*^9, 3.759408168919455*^9, 
  3.759409370332608*^9, 3.759472948219317*^9, 3.760692372428862*^9, 
  3.764327628757654*^9, 3.764782395876801*^9, 
  3.764783327865226*^9},ExpressionUUID->"51b0204b-2f79-4476-8e69-\
85ca071b2810"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", "gatelist", "]"}]], "Input",ExpressionUUID->"99c7f96c-ac09-44b4-8ed5-872e3b324668"],

Cell[BoxData["444"], "Output",
 CellChangeTimes->{3.7575279258198853`*^9, 3.757535070557679*^9, 
  3.757581531124834*^9, 3.757607795837702*^9, 3.757610069670147*^9, 
  3.7576117663577423`*^9, 3.757612006182374*^9, 3.757690168004045*^9, 
  3.757690278817274*^9, 3.757690402217667*^9, 3.757692884132044*^9, 
  3.7577134657463408`*^9, 3.7581145600628853`*^9, 3.758126806463488*^9, 
  3.758127223095551*^9, 3.7581287431391563`*^9, 3.758175603726235*^9, 
  3.759293986278112*^9, 3.759294675387186*^9, 3.75929715927011*^9, 
  3.7593127821816187`*^9, 3.759385987238934*^9, 3.7594046642358007`*^9, 
  3.7594058159023952`*^9, 3.759408168944718*^9, 3.759409370357758*^9, 
  3.759472948270735*^9, 3.76069237248236*^9, 3.764327628819868*^9, 
  3.764782395907503*^9, 
  3.7647833278996563`*^9},ExpressionUUID->"97bd5c69-6de8-4ccb-ab66-\
e098821c0db0"]
}, Open  ]],

Cell["\<\
Note that DecIsometryGeneric is faster than DecIsometry and with the same \
CNOT count for our generic unitary\
\>", "Text",
 CellChangeTimes->{{3.757535010535365*^9, 3.757535059027505*^9}, {
  3.757535093260561*^9, 3.7575351007098713`*^9}, {3.757535989974615*^9, 
  3.757535991175363*^9}, {3.759295104879986*^9, 3.7592951086335278`*^9}, {
  3.759295170974556*^9, 
  3.759295176616844*^9}},ExpressionUUID->"e76b2d28-0899-4691-9c48-\
825c5094e9bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"gatelist", "=", 
    RowBox[{"DecIsometry", "[", "u", "]"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757535038895626*^9, 
  3.7575350408068037`*^9}},ExpressionUUID->"63fcd6ba-42b0-4422-b325-\
dbe775d6fe74"],

Cell[BoxData["139.898487`"], "Output",
 CellChangeTimes->{3.7575351219472017`*^9, 3.757581585947294*^9, 
  3.7576078460059357`*^9, 3.757610118574977*^9, 3.757611772586339*^9, 
  3.757612055407282*^9, 3.757690213887018*^9, 3.757690282291168*^9, 
  3.7576904578924026`*^9, 3.757692940144538*^9, 3.757713511611259*^9, 
  3.75811460964999*^9, 3.758126857209587*^9, 3.758127273406837*^9, 
  3.758128790457732*^9, 3.7581756509685297`*^9, 3.759294441870469*^9, 
  3.7592949008755608`*^9, 3.759297275047563*^9, 3.759312944011429*^9, 
  3.759384393268373*^9, 3.759386148014323*^9, 3.759404787574729*^9, 
  3.759405938562069*^9, 3.759408292928411*^9, 3.759409494206367*^9, 
  3.759473106932659*^9, 3.7606925337972593`*^9, 3.764327794021367*^9, 
  3.764782527194852*^9, 
  3.7647834577639723`*^9},ExpressionUUID->"107a2903-3fa5-46b7-a96b-\
2eaabe4c4772"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.7575183561689*^9, 
  3.7575183652637587`*^9}},ExpressionUUID->"3417cb8e-9ecd-4b98-9abf-\
79749780c69d"],

Cell[BoxData["1551"], "Output",
 CellChangeTimes->{3.757518365625622*^9, 3.757527925792719*^9, 
  3.757535122002372*^9, 3.757581585986512*^9, 3.757607846037167*^9, 
  3.757610118615809*^9, 3.757612055437922*^9, 3.757690457943623*^9, 
  3.75769294018598*^9, 3.757713511690796*^9, 3.758114609679036*^9, 
  3.758126857254071*^9, 3.7581272734317408`*^9, 3.758128790482031*^9, 
  3.7581756510144997`*^9, 3.759295078658752*^9, 3.7592972750893993`*^9, 
  3.7593129440882797`*^9, 3.7593861485696507`*^9, 3.759404787604457*^9, 
  3.759405938591875*^9, 3.7594082929595203`*^9, 3.7594094942381487`*^9, 
  3.7594731069785347`*^9, 3.7606925339613113`*^9, 3.764327794067624*^9, 
  3.764782527218557*^9, 
  3.764783457791936*^9},ExpressionUUID->"3815311b-8c1b-4a5d-a428-\
fdacbc481566"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{
  3.7593842805524473`*^9, {3.7593844639336023`*^9, 
   3.759384464827828*^9}},ExpressionUUID->"2680aedd-2f83-481f-a134-\
b661e77f1c84"],

Cell[BoxData["444"], "Output",
 CellChangeTimes->{3.7575279258198853`*^9, 3.757535122053522*^9, 
  3.757581586017227*^9, 3.757607846063389*^9, 3.757610118646483*^9, 
  3.7576120554649553`*^9, 3.757690457985655*^9, 3.7576929402220297`*^9, 
  3.757713511707529*^9, 3.758114609718072*^9, 3.758126857288177*^9, 
  3.758127273450382*^9, 3.758128790500957*^9, 3.758175651031641*^9, 
  3.7592950821879387`*^9, 3.7592972751228933`*^9, 3.759312944143526*^9, 
  3.759384469842626*^9, 3.759386149108079*^9, 3.759404787627791*^9, 
  3.7594059386183357`*^9, 3.759408292984921*^9, 3.7594094942624483`*^9, 
  3.7594731070259047`*^9, 3.7606925340109177`*^9, 3.7643277941197166`*^9, 
  3.764782527247141*^9, 
  3.764783457821293*^9},ExpressionUUID->"5e8ef522-62d8-4c2a-a16a-\
298a53ffddc4"]
}, Open  ]],

Cell["\<\
The run time of DecIsometry can be lowered using the option SpeedUp->True \
(which may lead to higher gate counts in very rare cases)\
\>", "Text",
 CellChangeTimes->{{3.757535010535365*^9, 3.757535059027505*^9}, {
  3.757535093260561*^9, 3.7575351007098713`*^9}, {3.757535989974615*^9, 
  3.757535991175363*^9}, {3.759295104879986*^9, 3.7592951086335278`*^9}, {
  3.759295170974556*^9, 3.759295176616844*^9}, {3.759384181122316*^9, 
  3.759384224792283*^9}},ExpressionUUID->"269c8dc1-cfd8-4847-a863-\
f0b5d7768812"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"gatelist", "=", 
    RowBox[{"DecIsometry", "[", 
     RowBox[{"u", ",", 
      RowBox[{"SpeedUp", "\[Rule]", "True"}]}], "]"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.759384261384066*^9, 
  3.759384266967269*^9}},ExpressionUUID->"501ab072-2ee5-4399-964f-\
7b88997cd6c9"],

Cell[BoxData["29.796653`"], "Output",
 CellChangeTimes->{3.759384423691077*^9, 3.759386185069625*^9, 
  3.7594048116030293`*^9, 3.759405962664775*^9, 3.759408317282505*^9, 
  3.759409518209672*^9, 3.759473138786703*^9, 3.760692566280349*^9, 
  3.764327826749546*^9, 3.764782552461842*^9, 
  3.764783482790633*^9},ExpressionUUID->"cb4ad6ea-ddc2-45e8-8f65-\
a50701ce8ebf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "gatelist", "]"}]], "Input",ExpressionUUID->"df5e3658-a258-480b-8d99-d69ceb573688"],

Cell[BoxData["1551"], "Output",
 CellChangeTimes->{3.7593844238037*^9, 3.7593861851348543`*^9, 
  3.7594048116342793`*^9, 3.759408317312441*^9, 3.759409518236768*^9, 
  3.7594731388348837`*^9, 3.760692566436614*^9, 3.76432782679902*^9, 
  3.7647825524841413`*^9, 
  3.7647834828232393`*^9},ExpressionUUID->"42fc5b5a-f2be-491f-9afb-\
b9f621577a55"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{
  3.759384476145259*^9},ExpressionUUID->"c96ff858-3aa0-490d-be59-\
84a41e1d819c"],

Cell[BoxData["444"], "Output",
 CellChangeTimes->{3.7593844239371567`*^9, 3.759384476938027*^9, 
  3.759386185200439*^9, 3.759404811659202*^9, 3.759408317337044*^9, 
  3.759409518259845*^9, 3.759473138885179*^9, 3.760692566489085*^9, 
  3.764327826852159*^9, 3.764782552512343*^9, 
  3.7647834828524103`*^9},ExpressionUUID->"474a9cbb-83e3-41fb-b842-\
37f02ec0fe65"]
}, Open  ]],

Cell["Increasing the number of qubits...", "Text",
 CellChangeTimes->{{3.757535010535365*^9, 3.757535059027505*^9}, {
  3.757535093260561*^9, 3.7575351007098713`*^9}, {3.757535989974615*^9, 
  3.757535991175363*^9}, {3.759295104879986*^9, 3.7592951086335278`*^9}, {
  3.759295170974556*^9, 3.759295176616844*^9}, {3.759384181122316*^9, 
  3.759384224792283*^9}, {3.759384305600696*^9, 
  3.759384343039908*^9}},ExpressionUUID->"c3ec02ec-cc44-4bab-a002-\
da22aab80cf9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"PickRandomUnitary", "[", 
    RowBox[{"2", "^", "6"}], "]"}]}], ";"}]], "Input",ExpressionUUID->\
"50a46953-1be2-4aa6-9894-d7c2440e35a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"gatelist", "=", 
    RowBox[{"DecIsometryGeneric", "[", "u", "]"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",ExpressionUUID->"5040d044-5139-\
4fa9-beba-84dd1f5a137a"],

Cell[BoxData["13.709718`"], "Output",
 CellChangeTimes->{3.759295135768504*^9, 3.759297282685604*^9, 
  3.759312954135672*^9, 3.759386195264427*^9, 3.7594048193039837`*^9, 
  3.759405970329968*^9, 3.759408325093264*^9, 3.759409525722436*^9, 
  3.759473148991894*^9, 3.7606925768671417`*^9, 3.7643278371836433`*^9, 
  3.7647825602638407`*^9, 
  3.764783490492145*^9},ExpressionUUID->"d7b99895-75da-4e57-8029-\
3d8787901aff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "gatelist", "]"}]], "Input",ExpressionUUID->"c1e0625f-c740-49de-978a-0a8d85e519a4"],

Cell[BoxData["6893"], "Output",
 CellChangeTimes->{3.7592972827221193`*^9, 3.7593129541983767`*^9, 
  3.7593861953543797`*^9, 3.759404819330885*^9, 3.759405970362812*^9, 
  3.759408325128869*^9, 3.759409525749625*^9, 3.759473149033835*^9, 
  3.760692577025642*^9, 3.7643278372291203`*^9, 3.764782560286274*^9, 
  3.7647834905211563`*^9},ExpressionUUID->"a7c42542-a4ad-430a-87ac-\
849f81accb5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", "gatelist", "]"}]], "Input",ExpressionUUID->"943b1eb1-dabf-4192-a77c-61f2fd3b5fb7"],

Cell[BoxData["1868"], "Output",
 CellChangeTimes->{3.7592972828191223`*^9, 3.759312954357493*^9, 
  3.759386195490855*^9, 3.759404819417589*^9, 3.75940597046443*^9, 
  3.759408325234614*^9, 3.759409525835164*^9, 3.7594731491584797`*^9, 
  3.760692577152441*^9, 3.764327837370564*^9, 3.764782560398046*^9, 
  3.764783490632022*^9},ExpressionUUID->"bbcee5c6-8635-4f08-8028-\
2d62a8cd1d67"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"PickRandomUnitary", "[", 
    RowBox[{"2", "^", "7"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.757518295611693*^9, 3.757518309269421*^9}, {
  3.7575183457315817`*^9, 3.75751834598177*^9}, {3.7575183767461843`*^9, 
  3.757518377080249*^9}},ExpressionUUID->"6d74c389-13f3-40cc-a28e-\
0f82653529a0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"gatelist", "=", 
    RowBox[{"DecIsometryGeneric", "[", "u", "]"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757518314536619*^9, 3.757518336119945*^9}, {
  3.7576079290092688`*^9, 
  3.757607930023511*^9}},ExpressionUUID->"9138623c-06ec-4b55-8a9a-\
1ab921a3ec21"],

Cell[BoxData["58.462813`"], "Output",
 CellChangeTimes->{{3.7575183388582087`*^9, 3.7575183521653*^9}, 
   3.7575184025079317`*^9, 3.757527947509609*^9, 3.757582714686551*^9, {
   3.757607946975255*^9, 3.757607973929122*^9}, 3.757610140431614*^9, 
   3.75761207711862*^9, 3.757690483210937*^9, 3.757692965323637*^9, 
   3.7577135313439207`*^9, 3.7581146245226517`*^9, 3.758126872146826*^9, 
   3.75812728810788*^9, 3.7581288052559147`*^9, 3.758175665983817*^9, 
   3.759295165942864*^9, 3.7592973128227253`*^9, 3.759312995883655*^9, 
   3.759386237722106*^9, 3.759404850330883*^9, 3.759406001641259*^9, 
   3.759408356747629*^9, 3.759409557069591*^9, 3.759473190809264*^9, 
   3.760692619638598*^9, 3.7643278801093607`*^9, 3.7647825922154417`*^9, 
   3.764783522236946*^9},ExpressionUUID->"f0440dbc-78c8-4ba3-aeaa-\
58c6f944f81e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.7575183561689*^9, 
  3.7575183652637587`*^9}},ExpressionUUID->"bc4d48e6-14ff-415f-9631-\
69a190243f21"],

Cell[BoxData["27949"], "Output",
 CellChangeTimes->{3.757518365625622*^9, 3.757518402546393*^9, 
  3.7575279475522223`*^9, 3.75758271472752*^9, 3.757607973968553*^9, 
  3.757610140475313*^9, 3.757612077147784*^9, 3.757690483257*^9, 
  3.757692965366865*^9, 3.757713531365552*^9, 3.7581146245535183`*^9, 
  3.758126872189331*^9, 3.758127288132271*^9, 3.7581288052828407`*^9, 
  3.758175666001895*^9, 3.7592951659737253`*^9, 3.759297312854122*^9, 
  3.759312995945215*^9, 3.759386237781888*^9, 3.759404850363508*^9, 
  3.759406001671587*^9, 3.7594083567786303`*^9, 3.7594095570992517`*^9, 
  3.759473190855744*^9, 3.7606926198007097`*^9, 3.764327880159521*^9, 
  3.7647825922382936`*^9, 
  3.764783522265923*^9},ExpressionUUID->"9f6da126-6b4f-4740-87bc-\
b9074270a162"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.757518658405164*^9, 
  3.757518662276268*^9}},ExpressionUUID->"dd926822-4e96-4e61-b04c-\
ac2afe3d93ea"],

Cell[BoxData["7660"], "Output",
 CellChangeTimes->{3.757518662805108*^9, 3.757527947605194*^9, 
  3.757582714774555*^9, 3.7576079740490437`*^9, 3.757610140526086*^9, 
  3.7576120771954937`*^9, 3.757690483321982*^9, 3.757692965428802*^9, 
  3.757713531401808*^9, 3.75811462461691*^9, 3.75812687223077*^9, 
  3.758127288173121*^9, 3.7581288053241568`*^9, 3.75817566604047*^9, 
  3.7592951663185062`*^9, 3.759297313186261*^9, 3.759312996444254*^9, 
  3.7593862382817917`*^9, 3.7594048506824102`*^9, 3.7594060019977293`*^9, 
  3.759408357098678*^9, 3.759409557421688*^9, 3.759473191272846*^9, 
  3.760692620226487*^9, 3.7643278806844788`*^9, 3.76478259266955*^9, 
  3.764783522682942*^9},ExpressionUUID->"152e922b-6425-4d7e-9b1e-\
a256a276e164"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposing channels", "Subsection",
 CellChangeTimes->{{3.759144725011591*^9, 
  3.759144728427412*^9}},ExpressionUUID->"220c1b8e-9559-4683-bc61-\
0d7fcca233c4"],

Cell["\<\
We can also decompose channels. Take a channel from 1 qubit to 2 qubits with \
10 Kraus operators\
\>", "Text",
 CellChangeTimes->{{3.757518748193034*^9, 3.7575187532374697`*^9}, {
  3.757585600844584*^9, 3.757585627121422*^9}, {3.757585787690319*^9, 
  3.757585788024984*^9}},ExpressionUUID->"c9e8898e-0297-4b76-bdb2-\
8199d2de0899"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chan", "=", 
   RowBox[{"RPickRandomChannel", "[", 
    RowBox[{"2", ",", "4", ",", "10"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.757585586082509*^9, 3.757585592640111*^9}, {
  3.7575856319802933`*^9, 3.757585633822791*^9}, {3.7575857830485687`*^9, 
  3.7575857848789883`*^9}},ExpressionUUID->"ce76813e-a994-4ac6-a879-\
cc5afeead1d5"],

Cell["Check that it is a valid channel", "Text",
 CellChangeTimes->{{3.757585640595986*^9, 
  3.7575856468814783`*^9}},ExpressionUUID->"0bd3a0ee-3fab-4d0f-91dd-\
5478e640f017"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CT", "[", 
      RowBox[{"chan", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", 
     RowBox[{"chan", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757585648337248*^9, 3.757585675726248*^9}, {
  3.757585791880088*^9, 
  3.757585792335401*^9}},ExpressionUUID->"eca659d2-f70f-4055-a605-\
00bc8910012f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.0000000000000004`", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.9999999999999998`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7575856708552313`*^9, 3.757585676072983*^9}, 
   3.75758579886654*^9, 3.757607974141788*^9, 3.7576101405691233`*^9, 
   3.757612077225666*^9, 3.7576904833576393`*^9, 3.7576905480500298`*^9, 
   3.757691177351416*^9, 3.7576925952626123`*^9, 3.75769296545745*^9, 
   3.757713531421904*^9, 3.7581146246632557`*^9, 3.758126872268401*^9, 
   3.758127288196329*^9, 3.758128805345759*^9, 3.758175666053014*^9, 
   3.75929731320752*^9, 3.759312996505876*^9, 3.7593862383248243`*^9, 
   3.759404850713009*^9, 3.75940600202713*^9, 3.759408357137179*^9, 
   3.759409557449772*^9, 3.759473191305282*^9, 3.7606926203654737`*^9, 
   3.764327880722374*^9, 3.764782592693399*^9, 
   3.76478352271246*^9},ExpressionUUID->"9b69aa3f-cde9-414b-8825-\
306058aff8fc"]
}, Open  ]],

Cell["Its action on a density operator rho is", "Text",
 CellChangeTimes->{{3.757585679404714*^9, 
  3.757585694286035*^9}},ExpressionUUID->"33a126ac-53de-40e6-994a-\
db76d5330197"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"RPickRandomRho", "[", "2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.757585698556102*^9, 
  3.7575857125155067`*^9}},ExpressionUUID->"dbabb4a0-93a7-432e-aa9d-\
a4ae3de8726c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhoout", "=", 
  RowBox[{"Chop", "[", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"chan", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", "rho", ".", 
      RowBox[{"CT", "[", 
       RowBox[{"chan", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.757585714907935*^9, 3.757585744734107*^9}, {
  3.7575857949200573`*^9, 
  3.7575857952539883`*^9}},ExpressionUUID->"6f229c0b-6504-4961-a0e9-\
c1bb48c102d8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.15661199395303774`", ",", 
     RowBox[{"-", "0.032262941789151664`"}], ",", 
     RowBox[{"-", "0.07303267052321652`"}], ",", 
     RowBox[{"-", "0.09399913705673696`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.03226294178915167`"}], ",", "0.19345868017597478`", ",", 
     "0.056905678599592294`", ",", 
     RowBox[{"-", "0.06814604441429128`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.07303267052321658`"}], ",", "0.056905678599592266`", ",",
      "0.35853285937251494`", ",", 
     RowBox[{"-", "0.10507600221861398`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.09399913705673697`"}], ",", 
     RowBox[{"-", "0.0681460444142913`"}], ",", 
     RowBox[{"-", "0.10507600221861393`"}], ",", "0.2913964664984728`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.757585745635805*^9, 3.7575858027196083`*^9, 
  3.757607974245329*^9, 3.757610140608596*^9, 3.757612077256151*^9, 
  3.757690483393401*^9, 3.757690549493411*^9, 3.757691177421876*^9, 
  3.7576925953253183`*^9, 3.75769296548425*^9, 3.75771353144283*^9, 
  3.758114624714427*^9, 3.758126872305225*^9, 3.758127288217032*^9, 
  3.7581288053669157`*^9, 3.7581756660629263`*^9, 3.759297313244425*^9, 
  3.759312996586117*^9, 3.7593862383693647`*^9, 3.759404850742709*^9, 
  3.7594060020554667`*^9, 3.759408357174737*^9, 3.759409557474818*^9, 
  3.7594731913371077`*^9, 3.760692620446212*^9, 3.764327880755122*^9, 
  3.7647825927049294`*^9, 
  3.764783522738921*^9},ExpressionUUID->"9ea7d5b5-0de0-41b0-b31b-\
bd0a5c69d3c7"]
}, Open  ]],

Cell["\<\
This channel has more than the maximum number of Kraus operators, so we can \
compress it to a smaller representation of the same channel\
\>", "Text",
 CellChangeTimes->{{3.757585808083173*^9, 
  3.757585838135792*^9}},ExpressionUUID->"4b10a7ac-4dce-4b45-b70c-\
0081c3234223"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"chan2", "=", 
   RowBox[{"MinimizeKrausRank", "[", "chan", "]"}]}], ";", 
  RowBox[{"Length", "[", "chan2", "]"}]}]], "Input",
 CellChangeTimes->{{3.757585759136159*^9, 3.757585776514241*^9}, 
   3.7614722496788816`*^9},ExpressionUUID->"b83ac6f7-05ec-4495-ab2e-\
5c923e6a5809"],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{{3.7575857655891933`*^9, 3.7575858044978647`*^9}, 
   3.757607974312459*^9, 3.757610140637417*^9, 3.757612077280757*^9, 
   3.757690483416697*^9, 3.75769055187598*^9, 3.757691177464835*^9, 
   3.7576925953640833`*^9, 3.757692965506115*^9, 3.757713531458726*^9, 
   3.758114624745184*^9, 3.75812687233136*^9, 3.758127288235503*^9, 
   3.758128805383894*^9, 3.758175666071135*^9, 3.7592973132705603`*^9, 
   3.759312996625022*^9, 3.7593862384066277`*^9, 3.759404850769148*^9, 
   3.759406002080737*^9, 3.759408357201703*^9, 3.7594095574966917`*^9, 
   3.7594731913610353`*^9, 3.7606926205287247`*^9, 3.764327880780923*^9, 
   3.764782592714779*^9, 
   3.764783522761997*^9},ExpressionUUID->"3efa27ec-733d-4a4a-9429-\
af41e0c77788"]
}, Open  ]],

Cell["The action on rho is the same:", "Text",
 CellChangeTimes->{{3.7575858573987226`*^9, 
  3.75758586266341*^9}},ExpressionUUID->"72e2b56d-a666-43a3-a0d3-\
5d51bee8133d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"rhoout", "-", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"chan2", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", "rho", ".", 
      RowBox[{"CT", "[", 
       RowBox[{"chan2", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "chan2", "]"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.757585871100419*^9, 
  3.757585896064855*^9}},ExpressionUUID->"09e58ba9-00e3-4f34-b5fa-\
54c9a769705a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7575858970576153`*^9, 3.7576079743806887`*^9, 
  3.75761014066634*^9, 3.7576120773076487`*^9, 3.757690483438218*^9, 
  3.757690553565279*^9, 3.757691177506957*^9, 3.757692595403791*^9, 
  3.7576929655272913`*^9, 3.7577135314777946`*^9, 3.758114624780767*^9, 
  3.758126872356431*^9, 3.758127288254119*^9, 3.758128805401782*^9, 
  3.758175666079273*^9, 3.7592973133002234`*^9, 3.7593129966679363`*^9, 
  3.7593862384446707`*^9, 3.759404850796707*^9, 3.759406002105166*^9, 
  3.759408357230413*^9, 3.7594095575202303`*^9, 3.7594731913842993`*^9, 
  3.76069262060529*^9, 3.764327880812261*^9, 3.764782592724051*^9, 
  3.7647835227867727`*^9},ExpressionUUID->"fec0f48d-43d7-464a-88ca-\
8a47996c31a0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"gatelist", "=", 
   RowBox[{"DecChannelInQCM", "[", "chan2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.757585937941409*^9, 
  3.757585953758494*^9}},ExpressionUUID->"cd96b01f-11db-4ae4-b401-\
71331329d86c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.757585956976549*^9, 
  3.757585959886723*^9}},ExpressionUUID->"cde0741f-aa31-42fe-82e0-\
844a27646649"],

Cell[BoxData["165"], "Output",
 CellChangeTimes->{3.757585960222032*^9, 3.757607975733945*^9, 
  3.757610141948411*^9, 3.7576120785750504`*^9, 3.757690569182622*^9, 
  3.757692600188883*^9, 3.757692967037425*^9, 3.757713532618318*^9, 
  3.7581146261632013`*^9, 3.758126873746154*^9, 3.7581272896092863`*^9, 
  3.758128806751465*^9, 3.7581756674422083`*^9, 3.759297318951133*^9, 
  3.7593130042921457`*^9, 3.7593862461819353`*^9, 3.759404856682069*^9, 
  3.7594060079080477`*^9, 3.759408362984013*^9, 3.7594095633631496`*^9, 
  3.759473199102688*^9, 3.760692628381342*^9, 3.764327888974292*^9, 
  3.764782598854692*^9, 
  3.764783528758374*^9},ExpressionUUID->"def8e7c3-17fa-47be-b9be-\
4a3218f4e7e9"]
}, Open  ]],

Cell["\<\
The output is quite long, but the first and last 20 gates are displayed \
below. Note the trace out circuit elements, and the indication of ancilla.\
\>", "Text",
 CellChangeTimes->{{3.757586243089588*^9, 3.75758626299652*^9}, {
   3.757586420964432*^9, 3.7575864371897917`*^9}, {3.758114593469762*^9, 
   3.758114594534267*^9}, {3.7581146328960867`*^9, 3.758114639204967*^9}, 
   3.759382908041518*^9, 
   3.759473259175753*^9},ExpressionUUID->"bb358190-dee5-4e27-9aac-\
c04afb0c206b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", 
  RowBox[{"Take", "[", 
   RowBox[{"gatelist", ",", "20"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.7581145904008837`*^9},ExpressionUUID->"a41ac9d1-17d1-4a83-88b5-\
a24bc1d412d2"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {5., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -5.}, {6., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -3.}, {2., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {3., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -3.}, {4., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -3.}, {7., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -3.}, {8., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -3.}, {9., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -4.}, {2., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -4.}, {3., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -4.}, {4., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -4.}, {5., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -4.}, {6., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -4.}, {7., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -4.}, {8., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -4.}, {9., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -5.}, {2., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -5.}, {3., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -5.}, {4., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -5.}, {5., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -5.}, {7., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -5.}, {8., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -5.}, {9., -5.}}]}}, {
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -1.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -1.2}, {3.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -1.2}, {5., -0.8}}], 
       LineBox[{{4.8, -1.}, {5.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -1.2}, {6.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -1.}]}}, 
     {GrayLevel[0], DiskBox[{7., -1.}, 0.1]}, {}, {}, 
     {GrayLevel[0], DiskBox[{5., -5.}, 0.1]}, 
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -2.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -2.2}, {3.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -2.2}, {4.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -2.}]}}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{7., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{7., -2.2}, {7., -1.8}}], 
       LineBox[{{6.8, -2.}, {7.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{7.8, -2.2}, {8.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {8., -2.}]}}, {}, 
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -3.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -3.2}, {2.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -3.2}, {3.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -3.2}, {4.2, -2.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"Rz\"\>", {4., -3.}]}}, {}, {}, {}, {}, {}, 
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -4.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -4.2}, {2.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -4.2}, {3.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -4.2}, {4.2, -3.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"Rz\"\>", {4., -4.}]}}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJx10TEKAkEMQNHBKmWKFClSZNN7Bj2DRxC29ojukfYIKm6E+eDAEN4Uw4cs
98dtPY0xzu/7md+zX475PB6uswVW2GCHA064/vxn29w3trmvLbDCBjsccMIF
d4+gpy2wwgY7HHDCBXePoqctsMIGOxxwwgV3T++ve9oCK+xwwAnXzy+fKUCj

     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{558., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.758114626265348*^9, 3.758126873781683*^9, 
  3.758127289637735*^9, 3.758128806782764*^9, 3.758175667468557*^9, 
  3.759297318977338*^9, 3.759313004353032*^9, 3.759386246230629*^9, 
  3.759404856714759*^9, 3.759406007937251*^9, 3.7594083630140047`*^9, 
  3.75940956339287*^9, 3.7594731991540813`*^9, 3.760692628437936*^9, 
  3.764327889032456*^9, 3.764782598886743*^9, 
  3.764783528785776*^9},ExpressionUUID->"6a233814-54d3-4e36-91b4-\
fdee04715b4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", 
  RowBox[{"Take", "[", 
   RowBox[{"gatelist", ",", 
    RowBox[{"-", "20"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7575861481301003`*^9, 
  3.75758622815431*^9}},ExpressionUUID->"d7874432-e9fc-4a69-bf40-\
a394ed813c19"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -1.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -1.}, {11., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -1.}, {12., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -1.}, {13., -1.}}]}, 
     {GrayLevel[1], Thickness[Large], LineBox[{{13., -1.}, {14., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {10., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -2.}, {11., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {12., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -2.}, {13., -2.}}]}, 
     {GrayLevel[1], Thickness[Large], LineBox[{{13., -2.}, {14., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -3.}, {2., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {3., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {2., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -3.}, {4., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {4., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {5., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -3.}, {7., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -3.}, {8., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -3.}, {9., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -3.}, {10., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -3.}, {11., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -3.}, {12., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -3.}, {13., -3.}}]}, 
     {GrayLevel[1], Thickness[Large], LineBox[{{13., -3.}, {14., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -4.}, {3., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -5.}, {5., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -4.}, {6., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -4.}, {2., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -4.}, {4., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -4.}, {5., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -4.}, {7., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -4.}, {8., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -4.}, {9., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -4.}, {8., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -4.}, {10., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -4.}, {11., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -4.}, {12., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -4.}, {11., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -4.}, {13., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{13., -4.}, {14., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -5.}, {9., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -5.}, {12., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -5.}, {2., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -5.}, {3., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -5.}, {4., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -5.}, {6., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -5.}, {7., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -5.}, {8., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -5.}, {10., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -5.}, {11., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -5.}, {13., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], 
      LineBox[{{13., -5.}, {
       14., -5.}}]}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.8, -1.2}, {13.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"Tr\"\>", {13., -1.}]}}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.8, -2.2}, {13.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Tr\"\>", {13., -2.}]}}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{2., -3.}, 0.2], 
      {GrayLevel[0], LineBox[{{2., -3.2}, {2., -2.8}}], 
       LineBox[{{1.8, -3.}, {2.2, -3.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -3.2}, {3.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {3., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{4., -3.}, 0.2], 
      {GrayLevel[0], LineBox[{{4., -3.2}, {4., -2.8}}], 
       LineBox[{{3.8, -3.}, {4.2, -3.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -3.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -3.2}, {5., -2.8}}], 
       LineBox[{{4.8, -3.}, {5.2, -3.}}]}}, {}, {}, {}, {}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.8, -3.2}, {13.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Tr\"\>", {13., -3.}]}}, {}, 
     {GrayLevel[0], DiskBox[{2., -4.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{4., -5.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{5., -4.}, 0.1]}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -4.2}, {6.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -4.2}, {7.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {7., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{8., -4.}, 0.2], 
      {GrayLevel[0], LineBox[{{8., -4.2}, {8., -3.8}}], 
       LineBox[{{7.8, -4.}, {8.2, -4.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -4.2}, {9.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {9., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -4.2}, {10.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {10., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{11., -4.}, 0.2], 
      {GrayLevel[0], LineBox[{{11., -4.2}, {11., -3.8}}], 
       LineBox[{{10.8, -4.}, {11.2, -4.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{11.8, -4.2}, {12.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {12., -4.}]}}, {}, {}, 
     {GrayLevel[0], DiskBox[{8., -5.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{11., -5.}, 0.1]}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.8, -5.2}, {5.2, -4.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {5., -5.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -5.2}, {6.2, -4.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {6., -5.}]}}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -5.2}, {9.2, -4.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {9., -5.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -5.2}, {10.2, -4.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {10., -5.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{11.8, -5.2}, {12.2, -4.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {12., -5.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.8, -5.2}, {13.2, -4.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {13., -5.}]}}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxd0DEOQiEQRVFiNSUFBQUFEkIIYQ/+ygW4BBNrl6hLcglq5Jn8S0ImZ6Zg
Hsfr/XI7OOfOn/utv/M6rfpYjW1vgz0c4AgnOMMFrnCDOzzgCSufe6667W2w
hwMc4QRnuMAVbnCHBzxh5bNl5ZMN9nCAI5zgDBe4wg3u8IAnrDwe+wfsr7n+
QzbMPRzhBGe4wBVucIcHPGG9p3wNVj7ZYW5wgCOc4AJXuMMDnn+/AY1JYys=

     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{717., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.7575861536674843`*^9, 3.757586228520976*^9}, 
   3.757607982050507*^9, 3.757610141998786*^9, 3.7576120786190434`*^9, {
   3.757692636977285*^9, 3.757692665270897*^9}, 3.757692967092753*^9, 
   3.757713532655912*^9, 3.758114626222608*^9, 3.758126873813752*^9, 
   3.758127289675036*^9, 3.75812880682024*^9, 3.758175667502886*^9, 
   3.759297319014772*^9, 3.759313004543611*^9, 3.759386246293632*^9, 
   3.7594048567547493`*^9, 3.7594060079709187`*^9, 3.759408363052782*^9, 
   3.7594095634278727`*^9, 3.759473199213746*^9, 3.7606926285493727`*^9, 
   3.764327889094616*^9, 3.764782598970359*^9, 
   3.7647835288217773`*^9},ExpressionUUID->"2ff49722-b8c5-4239-89ff-\
340a5f8910a9"]
}, Open  ]],

Cell["We can reconstruct the channel as follows.", "Text",
 CellChangeTimes->{{3.757608009635152*^9, 
  3.757608017790694*^9}},ExpressionUUID->"ca73d366-e7ac-4e75-9b97-\
2abf3d8a8e73"],

Cell["First remove the traces from the gatelist", "Text",
 CellChangeTimes->{{3.757608021230851*^9, 
  3.757608028084757*^9}},ExpressionUUID->"b40118b4-8957-4589-9c03-\
7da2f077f735"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gatelist2", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{"gatelist", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"TrOut", "[", "1", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "_", ",", "_"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.757607984154738*^9, 3.757607995380987*^9}, {
  3.757608043411541*^9, 3.7576080788851633`*^9}, {3.764782937739283*^9, 
  3.7647829620695133`*^9}},ExpressionUUID->"4310a499-d5d0-415e-820e-\
00b984fb69e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "gatelist2", "]"}]], "Input",
 CellChangeTimes->{{3.757608080440956*^9, 
  3.75760808430816*^9}},ExpressionUUID->"f98e72e7-d0b0-4223-a4cf-\
9ec4967bec4a"],

Cell[BoxData["162"], "Output",
 CellChangeTimes->{3.757608084737838*^9, 3.757610142019814*^9, 
  3.757612078636766*^9, 3.757692669540979*^9, 3.757692967117072*^9, 
  3.757713532671677*^9, 3.7581146540598097`*^9, 3.758126873825938*^9, 
  3.75812728970408*^9, 3.75812880684411*^9, 3.758175667527279*^9, 
  3.759297319041375*^9, 3.759313004573193*^9, 3.759386246319375*^9, 
  3.759404856772086*^9, 3.759406007982703*^9, 3.759408363078743*^9, 
  3.7594095634408407`*^9, 3.759473199234161*^9, 3.760692628680832*^9, 
  3.764327889123763*^9, 3.7647825989876337`*^9, 
  3.764783528832179*^9},ExpressionUUID->"5f5d377f-5d5d-4382-b97d-\
69e884d8905b"]
}, Open  ]],

Cell["\<\
We have a channel from 1 to 2 qubits, so the first 4 qubits of the input \
start in state 0. The partial traces can be used to generate Kraus operators \
by taking the projectors onto the computational basis:\
\>", "Text",
 CellChangeTimes->{{3.757608096864211*^9, 3.757608122605728*^9}, {
  3.757608159361423*^9, 
  3.7576082374975977`*^9}},ExpressionUUID->"b17f1da4-b11a-44b8-a3a0-\
8d758723374c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chanout", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ",", 
    RowBox[{"i", "\[LessEqual]", "7"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"chanout", "=", 
     RowBox[{"Insert", "[", 
      RowBox[{"chanout", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"BraV", "[", 
           RowBox[{"i", ",", 
            RowBox[{"2", "^", "3"}]}], "]"}], "\[CircleTimes]", 
          RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ")"}], ".", 
        RowBox[{"CreateOperationFromGateList", "[", "gatelist2", "]"}]}], ",", 
       RowBox[{"-", "1"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.757608243677867*^9, 3.757608428791143*^9}, {
   3.757608909706316*^9, 3.75760894167222*^9}, 3.7576904770763397`*^9, {
   3.758127172980113*^9, 3.758127174165045*^9}, 
   3.7617127325895357`*^9},ExpressionUUID->"ffbb014f-ddad-4d4e-a20e-\
6d9c71c90c2e"],

Cell["Check that it has the same action", "Text",
 CellChangeTimes->{{3.7576090002124577`*^9, 
  3.757609006739901*^9}},ExpressionUUID->"6efef395-1f52-4f27-97f4-\
3bc29ddcf579"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"rhoout", "-", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"chanout", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", "rho", ".", 
      RowBox[{"CT", "[", 
       RowBox[{"chanout", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "chanout", "]"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.757608982892445*^9, 
  3.757608990015526*^9}},ExpressionUUID->"75cd1d46-aed9-4690-aead-\
a6f67f9f2bfe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.757608990505986*^9, 3.757610142666757*^9, 
  3.7576120792923613`*^9, 3.75769267472119*^9, 3.7576929674199266`*^9, 
  3.757713532872342*^9, 3.75811465786055*^9, 3.758126874016967*^9, 
  3.758127289910866*^9, 3.758128807053441*^9, 3.758175667731019*^9, 
  3.7592973192894297`*^9, 3.759313004827116*^9, 3.7593862465636587`*^9, 
  3.75940485699652*^9, 3.759406008228191*^9, 3.759408363303684*^9, 
  3.759409563679119*^9, 3.759473199567882*^9, 3.760692629136313*^9, 
  3.7643278894915247`*^9, 3.76478259956464*^9, 
  3.764783529093918*^9},ExpressionUUID->"13529875-e3c9-4507-8284-\
e39781c50760"]
}, Open  ]],

Cell["We can also use CreateOperationFromGateList", "Text",
 CellChangeTimes->{{3.7581146626832533`*^9, 3.758114672044177*^9}, 
   3.761712732620388*^9},ExpressionUUID->"3a20c2af-357c-40e3-adf4-\
efdd04df470e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chanout2", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.758114673238865*^9, 3.7581146891805983`*^9}, 
   3.761712732657559*^9},ExpressionUUID->"a246e259-9477-4356-8a8e-\
ed9f23ab2c44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"chanout2", "-", "chanout"}], "]"}]], "Input",
 CellChangeTimes->{{3.758114690336035*^9, 
  3.7581146984751577`*^9}},ExpressionUUID->"845fed52-0ab6-49d8-8266-\
475f1fa57c40"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.758114693234387*^9, 3.7581146988001957`*^9}, 
   3.758126874123008*^9, 3.758127289966105*^9, 3.758128807104848*^9, 
   3.758175667781125*^9, 3.759297319346595*^9, 3.759313004919992*^9, 
   3.75938624663752*^9, 3.7594048570560303`*^9, 3.7594060082858763`*^9, 
   3.7594083633614902`*^9, 3.7594095637364683`*^9, 3.759473199663581*^9, 
   3.760692629419258*^9, 3.764327889592359*^9, 3.764782599676549*^9, 
   3.76478352915242*^9},ExpressionUUID->"89b256ea-af60-413e-9aaa-\
0d24ca17b949"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposing POVMs", "Subsection",
 CellChangeTimes->{{3.759144746627219*^9, 
  3.7591447499707203`*^9}},ExpressionUUID->"d15ae2db-d663-4b27-b7d9-\
4f8da93f1a46"],

Cell["\<\
Similarly we can implement a POVM. Choose a random POVM on 1 qubit with 3 \
elements\
\>", "Text",
 CellChangeTimes->{{3.757586443504318*^9, 3.757586449589665*^9}, {
  3.7575866619626713`*^9, 3.757586674047276*^9}, {3.757586781605012*^9, 
  3.7575867850226088`*^9}},ExpressionUUID->"1661435d-1cc2-4789-a226-\
14f29912dbd3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"POVM", "=", 
  RowBox[{"RPickRandomPOVM", "[", 
   RowBox[{"2", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7575866214020233`*^9, 3.7575866770494547`*^9}, {
  3.7575867876035957`*^9, 
  3.7575867986051407`*^9}},ExpressionUUID->"a6acc86e-e869-4de2-bfc1-\
7b89628cdfa1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.3405412479121661`", ",", 
       RowBox[{"-", "0.050688533299314276`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.050688533299314276`"}], ",", "0.33129585501055964`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0018629890306534052`", ",", "0.013792111519554992`"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0.013792111519554992`", ",", "0.11964924809063093`"}], "}"}]}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.6575957630571805`", ",", "0.036896421779759284`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.036896421779759284`", ",", "0.5490548968988095`"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.757586638633604*^9, 3.757586677504743*^9}, {
   3.75758678819771*^9, 3.757586799017398*^9}, 3.757609015491626*^9, 
   3.757609095801758*^9, 3.757610142696644*^9, 3.757612079318514*^9, 
   3.757692676292466*^9, 3.757692967440476*^9, 3.757713532891609*^9, 
   3.7581147091387663`*^9, 3.758126874150366*^9, 3.7581272899879*^9, 
   3.758128807124419*^9, 3.7581756677992992`*^9, 3.759297319362562*^9, 
   3.7593130049882507`*^9, 3.7593862466763773`*^9, 3.759404857086162*^9, 
   3.759406008311296*^9, 3.7594083633819637`*^9, 3.7594090710158033`*^9, 
   3.7594095637581987`*^9, 3.759472131628953*^9, 3.759472165577693*^9, 
   3.759472282792992*^9, 3.759473199685915*^9, 3.760692629446265*^9, 
   3.764327889620088*^9, 3.7647825996898127`*^9, 
   3.7647835291596947`*^9},ExpressionUUID->"dcf1a11f-632e-4a40-b722-\
bbc8ec6085bd"]
}, Open  ]],

Cell["\<\
Check that it is a valid POVM: its elements should sum to identity and all \
operators should be positive\
\>", "Text",
 CellChangeTimes->{{3.757586700255928*^9, 3.757586705489801*^9}, {
  3.758114721195492*^9, 
  3.758114738333713*^9}},ExpressionUUID->"c5d5d36e-fd77-49b1-9bd5-\
f441b82dc9f4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"POVM", "[", 
     RowBox[{"[", "i", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757586680643815*^9, 
  3.757586695693577*^9}},ExpressionUUID->"4f5b3bb6-8f66-438f-b8b3-\
cd58280b045f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.757586696276599*^9, 3.757586802279509*^9, 
  3.7576090178792257`*^9, 3.757609099182414*^9, 3.757610142724914*^9, 
  3.757612079342512*^9, 3.757692677963374*^9, 3.757692967460536*^9, 
  3.757713532912191*^9, 3.758114711162819*^9, 3.758126874175826*^9, 
  3.7581272900091963`*^9, 3.758128807145607*^9, 3.758175667816968*^9, 
  3.759297319379059*^9, 3.759313005051882*^9, 3.759386246714119*^9, 
  3.759404857115396*^9, 3.759406008337531*^9, 3.759408363402021*^9, 
  3.759409071918933*^9, 3.759409563780054*^9, 3.759472132645563*^9, 
  3.759472166587495*^9, 3.759472283412552*^9, 3.7594731997071247`*^9, 
  3.760692629522192*^9, 3.764327889624547*^9, 3.7647825997019053`*^9, 
  3.7647835291832323`*^9},ExpressionUUID->"18d6438f-f173-4a7e-87f0-\
f1d4b89672d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "3"}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Print", "[", 
    RowBox[{"Min", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"POVM", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.757586709165852*^9, 
  3.7575867266678534`*^9}},ExpressionUUID->"5451ed0b-b5ee-4cd9-b9aa-\
2a2f46508fca"],

Cell[CellGroupData[{

Cell[BoxData["0.28501966414040114`"], "Print",
 CellChangeTimes->{3.75758672755686*^9, 3.757586804742548*^9, 
  3.757609020042636*^9, 3.757609100995466*^9, 3.757610142754232*^9, 
  3.757612079367413*^9, 3.7576926794432783`*^9, 3.757692967481316*^9, 
  3.7577135329303102`*^9, 3.758114712718787*^9, 3.758126874202313*^9, 
  3.758127290031005*^9, 3.7581288071678457`*^9, 3.7581756678358583`*^9, 
  3.759297319396559*^9, 3.759313005102232*^9, 3.759386246754181*^9, 
  3.759404857144175*^9, 3.7594060083646603`*^9, 3.759408363424168*^9, 
  3.759409073184853*^9, 3.759409563803266*^9, 3.759472133740367*^9, 
  3.7594721674500027`*^9, 3.759472284170322*^9, 3.759473199728588*^9, 
  3.760692629605445*^9, 3.764327889645877*^9, 3.7647825997145777`*^9, 
  3.7647835292091208`*^9},ExpressionUUID->"1acc42aa-abcc-45cc-8ae7-\
9ef3b1e56336"],

Cell[BoxData["0.0002695659559195547`"], "Print",
 CellChangeTimes->{3.75758672755686*^9, 3.757586804742548*^9, 
  3.757609020042636*^9, 3.757609100995466*^9, 3.757610142754232*^9, 
  3.757612079367413*^9, 3.7576926794432783`*^9, 3.757692967481316*^9, 
  3.7577135329303102`*^9, 3.758114712718787*^9, 3.758126874202313*^9, 
  3.758127290031005*^9, 3.7581288071678457`*^9, 3.7581756678358583`*^9, 
  3.759297319396559*^9, 3.759313005102232*^9, 3.759386246754181*^9, 
  3.759404857144175*^9, 3.7594060083646603`*^9, 3.759408363424168*^9, 
  3.759409073184853*^9, 3.759409563803266*^9, 3.759472133740367*^9, 
  3.7594721674500027`*^9, 3.759472284170322*^9, 3.759473199728588*^9, 
  3.760692629605445*^9, 3.764327889645877*^9, 3.7647825997145777`*^9, 
  3.764783529210374*^9},ExpressionUUID->"db466d79-31e2-455c-b002-\
d8dcaf57baed"],

Cell[BoxData["0.5377004425742649`"], "Print",
 CellChangeTimes->{3.75758672755686*^9, 3.757586804742548*^9, 
  3.757609020042636*^9, 3.757609100995466*^9, 3.757610142754232*^9, 
  3.757612079367413*^9, 3.7576926794432783`*^9, 3.757692967481316*^9, 
  3.7577135329303102`*^9, 3.758114712718787*^9, 3.758126874202313*^9, 
  3.758127290031005*^9, 3.7581288071678457`*^9, 3.7581756678358583`*^9, 
  3.759297319396559*^9, 3.759313005102232*^9, 3.759386246754181*^9, 
  3.759404857144175*^9, 3.7594060083646603`*^9, 3.759408363424168*^9, 
  3.759409073184853*^9, 3.759409563803266*^9, 3.759472133740367*^9, 
  3.7594721674500027`*^9, 3.759472284170322*^9, 3.759473199728588*^9, 
  3.760692629605445*^9, 3.764327889645877*^9, 3.7647825997145777`*^9, 
  3.7647835292132673`*^9},ExpressionUUID->"ddd81631-bc4d-42ee-b2b9-\
ed821134fd5b"]
}, Open  ]]
}, Open  ]],

Cell["We now decompose it into a list of gates", "Text",
 CellChangeTimes->{{3.758114744507955*^9, 
  3.7581147526409473`*^9}},ExpressionUUID->"0f81594e-beb8-41c0-9e27-\
6cd0c4ffd3be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gatelist", "=", 
   RowBox[{"DecPOVMInQCM", "[", "POVM", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7575867405575943`*^9, 
  3.757586756276743*^9}},ExpressionUUID->"0afa16ff-eb55-4e25-a78a-\
686ba8f17c30"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.7575867594128857`*^9, 
  3.757586763873467*^9}},ExpressionUUID->"9e07807e-8af9-4c00-96c5-\
e083744ab40c"],

Cell[BoxData["43"], "Output",
 CellChangeTimes->{3.757586764311289*^9, 3.757586808908332*^9, 
  3.757609031196619*^9, 3.757609105279978*^9, 3.7576101429521217`*^9, 
  3.757612079555612*^9, 3.757692681732789*^9, 3.7576929676914577`*^9, 
  3.7577135330847387`*^9, 3.7581147558553047`*^9, 3.758126874378522*^9, 
  3.758127290213097*^9, 3.758128807347679*^9, 3.7581756680215063`*^9, 
  3.7592973200690613`*^9, 3.759313006015579*^9, 3.759386247633223*^9, 
  3.759404857826343*^9, 3.759406009081276*^9, 3.759408364187394*^9, 
  3.7594090810944777`*^9, 3.7594095645001087`*^9, 3.7594721368830843`*^9, 
  3.759472170150985*^9, 3.759472286584291*^9, 3.759473200556499*^9, 
  3.760692630696488*^9, 3.7643278905078497`*^9, 3.76478260050543*^9, 
  3.764783529915432*^9},ExpressionUUID->"ca5a1fc4-234c-44aa-a820-\
22cbab2fa0b1"]
}, Open  ]],

Cell["\<\
Printing the last  part of the circuit shows the measured qubits\
\>", "Text",
 CellChangeTimes->{{3.757586871394744*^9, 
  3.7575869027502604`*^9}},ExpressionUUID->"f86ff5d2-5d1a-464b-91ef-\
0debc10c8a55"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", 
  RowBox[{"Take", "[", 
   RowBox[{"gatelist", ",", 
    RowBox[{"-", "17"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.757586812263975*^9, 3.757586852722555*^9}, {
  3.757586990875058*^9, 
  3.757587004996065*^9}},ExpressionUUID->"f5c2cc8c-2c2f-4033-a82e-\
f85cad5ae313"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], LineBox[{{5., -0.95}, {6., -0.95}}], 
      LineBox[{{5., -1.05}, {6., -1.05}}]}, 
     {GrayLevel[0], LineBox[{{6., -0.95}, {7., -0.95}}], 
      LineBox[{{6., -1.05}, {7., -1.05}}]}, 
     {GrayLevel[0], LineBox[{{7., -0.95}, {8., -0.95}}], 
      LineBox[{{7., -1.05}, {8., -1.05}}]}, 
     {GrayLevel[0], LineBox[{{8., -0.95}, {9., -0.95}}], 
      LineBox[{{8., -1.05}, {9., -1.05}}]}, 
     {GrayLevel[0], LineBox[{{9., -0.95}, {10., -0.95}}], 
      LineBox[{{9., -1.05}, {10., -1.05}}]}, 
     {GrayLevel[0], LineBox[{{10., -0.95}, {11., -0.95}}], 
      LineBox[{{10., -1.05}, {11., -1.05}}]}, 
     {GrayLevel[0], LineBox[{{11., -0.95}, {12., -0.95}}], 
      LineBox[{{11., -1.05}, {12., -1.05}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {8., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {10., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -2.}, {11., -2.}}]}, 
     {GrayLevel[0], LineBox[{{11., -1.95}, {12., -1.95}}], 
      LineBox[{{11., -2.05}, {12., -2.05}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -3.}, {9., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -3.}, {2., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {3., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -3.}, {4., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -3.}, {7., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -3.}, {8., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -3.}, {10., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -3.}, {11., -3.}}]}, 
     {GrayLevel[1], Thickness[Large], 
      LineBox[{{11., -3.}, {12., -3.}}]}}, {{}, 
     {GrayLevel[0], DiskBox[{2., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -1.2}, {3.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.8, -1.2}, {5.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"Mmt\"\>", {5., -1.}]}}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -2.2}, {5., -1.8}}], 
       LineBox[{{4.8, -2.}, {5.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -2.2}, {6.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {6., -2.}]}}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{8., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{8., -2.2}, {8., -1.8}}], 
       LineBox[{{7.8, -2.}, {8.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -2.2}, {9.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {9., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -2.2}, {10.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {10., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{10.8, -2.2}, {11.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Mmt\"\>", {11., -2.}]}}, {}, 
     {GrayLevel[0], DiskBox[{5., -3.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{8., -3.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{2., -3.}, 0.2], 
      {GrayLevel[0], LineBox[{{2., -3.2}, {2., -2.8}}], 
       LineBox[{{1.8, -3.}, {2.2, -3.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -3.2}, {3.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -3.2}, {4.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {4., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -3.2}, {6.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -3.2}, {7.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {7., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -3.2}, {9.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -3.2}, {10.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {10., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{10.8, -3.2}, {11.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Tr\"\>", {11., -3.}]}}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxdz0EKgCAQheGhlUsXLly4MBHxFnWGjhC07oh1pI5QkRP4D8jwKThvxnVf
tkFE8nPe/tU1tX60i7m3gS3sYA8HOMIJznCBK6z55ezzqw1sYQd7OMARTnCG
C1xhnW/wv1r3UwveDWxhDwc4wRkucP19AzQ5N28=
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{711., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.7575868174055443`*^9, 3.757586853283784*^9, {3.757586991908227*^9, 
   3.757587005414833*^9}, 3.7576090384247627`*^9, 3.757609107224616*^9, 
   3.757610142987976*^9, 3.757612079589333*^9, 3.7576926839717627`*^9, 
   3.757692967745042*^9, 3.7577135331096287`*^9, 3.7581147573026342`*^9, 
   3.758126874408527*^9, 3.758127290237946*^9, 3.758128807371871*^9, 
   3.758175668046562*^9, 3.759297320095676*^9, 3.7593130060695744`*^9, 
   3.759386247686576*^9, 3.759404857856399*^9, 3.7594060091276283`*^9, 
   3.7594083642170067`*^9, 3.759409083165436*^9, 3.759409564527933*^9, 
   3.759472171741233*^9, 3.759472287296495*^9, 3.75947320060789*^9, 
   3.7606926307569036`*^9, 3.764327890560771*^9, 3.76478260058346*^9, 
   3.764783529942481*^9},ExpressionUUID->"dc40b5c3-ce0b-40b1-b90f-\
89553071338d"]
}, Open  ]],

Cell["To get back the POVM from the gatelist:", "Text",
 CellChangeTimes->{{3.7581147676501627`*^9, 
  3.758114775222784*^9}},ExpressionUUID->"2c67deac-b8bd-47f9-9562-\
4c9838d2881b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pt1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"BraV", "[", 
       RowBox[{"0", ",", "2"}], "]"}], "\[CircleTimes]", 
      RowBox[{"BraV", "[", 
       RowBox[{"0", ",", "2"}], "]"}], "\[CircleTimes]", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ")"}], ".", 
    RowBox[{"CreateOperationFromGateList", "[", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"gatelist", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"TrOut", "[", "1", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "_", ",", "_"}], "}"}]}], 
      "]"}], "]"}]}]}], ";", 
  RowBox[{"pt2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"BraV", "[", 
       RowBox[{"0", ",", "2"}], "]"}], "\[CircleTimes]", 
      RowBox[{"BraV", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[CircleTimes]", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ")"}], ".", 
    RowBox[{"CreateOperationFromGateList", "[", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"gatelist", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"TrOut", "[", "1", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "_", ",", "_"}], "}"}]}], 
      "]"}], "]"}]}]}], ";", 
  RowBox[{"pt3", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"BraV", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[CircleTimes]", 
      RowBox[{"BraV", "[", 
       RowBox[{"0", ",", "2"}], "]"}], "\[CircleTimes]", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ")"}], ".", 
    RowBox[{"CreateOperationFromGateList", "[", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"gatelist", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"TrOut", "[", "1", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "_", ",", "_"}], "}"}]}], 
      "]"}], "]"}]}]}], ";", 
  RowBox[{"pt4", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"BraV", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[CircleTimes]", 
      RowBox[{"BraV", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[CircleTimes]", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ")"}], ".", 
    RowBox[{"CreateOperationFromGateList", "[", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"gatelist", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"TrOut", "[", "1", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "_", ",", "_"}], "}"}]}], 
      "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.757587331723624*^9, 3.757587360290834*^9}, {
  3.757587402024128*^9, 3.7575874276161413`*^9}, {3.757587487953822*^9, 
  3.757587643838791*^9}, {3.757587777473034*^9, 3.757587798548997*^9}, {
  3.7575878675342712`*^9, 3.757587877779756*^9}, {3.757588738902174*^9, 
  3.757588747377803*^9}, {3.7575889300041523`*^9, 3.757589026405182*^9}, {
  3.7576088730892887`*^9, 3.757608877714477*^9}, {3.757609048432375*^9, 
  3.7576090657937717`*^9}, {3.757692704831562*^9, 3.7576927123735*^9}, {
  3.758127136836282*^9, 3.75812715438356*^9}, {3.7617127326684303`*^9, 
  3.7617127326781197`*^9}, {3.7647830048265343`*^9, 3.764783016955195*^9}, {
  3.764783062590218*^9, 
  3.764783075761529*^9}},ExpressionUUID->"8690df70-b78d-4374-9387-\
d09c9df64e39"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"POVMout", "=", 
  RowBox[{"Chop", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pt1", ".", 
      RowBox[{"CT", "[", "pt1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"CT", "[", "pt2", "]"}], ".", "pt2"}], ",", 
     RowBox[{
      RowBox[{"CT", "[", "pt3", "]"}], ".", "pt3"}], ",", 
     RowBox[{
      RowBox[{"CT", "[", "pt4", "]"}], ".", "pt4"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.757587666568719*^9, 3.757587710031775*^9}, {
  3.757587820798579*^9, 
  3.757587827720263*^9}},ExpressionUUID->"6ff91d12-f2bd-443c-a20d-\
d907f3fb5575"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.3405412479121658`", ",", 
       RowBox[{"-", "0.050688533299319`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.050688533299319`"}], ",", "0.33129585501056025`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0018629890306536686`", ",", "0.013792111519555911`"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0.013792111519555911`", ",", "0.11964924809062978`"}], "}"}]}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.6575957630571806`", ",", "0.03689642177976311`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.03689642177976311`", ",", "0.5490548968988093`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.757587710439982*^9, 3.757587801949464*^9, 3.757588752672876*^9, {
   3.757589003275737*^9, 3.757589030031211*^9}, 3.757609128410267*^9, 
   3.757610143057909*^9, 3.757612079677875*^9, 3.7576927174846487`*^9, 
   3.757692967805904*^9, 3.757713533148851*^9, 3.7581147818820343`*^9, 
   3.758126874427826*^9, 3.758127290263632*^9, 3.758128807399716*^9, 
   3.7581756680756607`*^9, 3.759297320129595*^9, 3.7593130061357927`*^9, 
   3.7593862477477293`*^9, 3.759404857890922*^9, 3.759406009159585*^9, 
   3.7594083642507353`*^9, 3.759409086876552*^9, 3.759409564557795*^9, 
   3.75947217662462*^9, 3.7594722903861933`*^9, 3.7594732006494303`*^9, 
   3.7606926309097652`*^9, 3.7643278906213512`*^9, 3.7647826007280693`*^9, 
   3.7647835299759693`*^9},ExpressionUUID->"44cb0785-c0df-4652-aa1a-\
9a32042c7aa4"]
}, Open  ]],

Cell["\<\
The zero POVM element can be dropped. We then get the same POVM as we started \
with\
\>", "Text",
 CellChangeTimes->{{3.757609168551147*^9, 
  3.7576091850094213`*^9}},ExpressionUUID->"a4dc0a6a-e1a9-4106-ac52-\
47d2d2392a1f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"Drop", "[", 
    RowBox[{"POVMout", ",", 
     RowBox[{"-", "1"}]}], "]"}], "-", "POVM"}], "]"}]], "Input",
 CellChangeTimes->{{3.7575878081844254`*^9, 3.7575878148251667`*^9}, {
  3.757589038953846*^9, 3.757589041616246*^9}, {3.757609146047949*^9, 
  3.757609151354135*^9}, {3.7576091892240562`*^9, 
  3.7576091923317947`*^9}},ExpressionUUID->"403b7bd8-28c6-4ff9-839c-\
03466f83c59d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.75758781532635*^9, 3.7575887866678667`*^9, {3.757589011321776*^9, 
   3.757589042292273*^9}, 3.757609151982327*^9, 3.757609192948476*^9, 
   3.757610143089245*^9, 3.757612079687141*^9, 3.757692719097664*^9, 
   3.757692967829092*^9, 3.757713533166979*^9, 3.75811478623973*^9, 
   3.758126874470291*^9, 3.75812729028811*^9, 3.7581288074226017`*^9, 
   3.758175668098192*^9, 3.759297320145727*^9, 3.75931300617708*^9, 
   3.759386247800385*^9, 3.759404857917285*^9, 3.7594060091844254`*^9, 
   3.759408364270673*^9, 3.7594090879484167`*^9, 3.7594095645790787`*^9, 
   3.7594721787188663`*^9, 3.759472291339534*^9, 3.759473200671541*^9, 
   3.7606926309934263`*^9, 3.76432789064507*^9, 3.76478260077378*^9, 
   3.764783529984704*^9},ExpressionUUID->"28471a0f-7387-4dc9-9c92-\
dcaba6cd7345"]
}, Open  ]],

Cell["We could also use CreatePOVMFromGateList", "Text",
 CellChangeTimes->{{3.758114789686878*^9, 3.758114827363637*^9}, 
   3.761712613079821*^9},ExpressionUUID->"03e496d3-5867-4a24-ab16-\
604beccbff80"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"CreatePOVMFromGateList", "[", "gatelist", "]"}], "-", "POVM"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.758114798520226*^9, 3.758114820336701*^9}, {
   3.759408768540565*^9, 3.759408771931535*^9}, 3.759472186119154*^9, 
   3.761712613114489*^9},ExpressionUUID->"ece1a7c4-2c93-466b-a250-\
514cfbfbcaa4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.758114814736992*^9, 3.758114820832735*^9}, 
   3.75812687450743*^9, 3.75812729031022*^9, 3.758128807444377*^9, 
   3.758175668122425*^9, 3.759297320162094*^9, 3.7593130062375927`*^9, 
   3.7593862478629303`*^9, 3.759404857944766*^9, 3.759406009210682*^9, 
   3.759408364291058*^9, 3.7594090904606943`*^9, 3.759409564601667*^9, 
   3.759472186694092*^9, 3.759472292773555*^9, 3.759473200704401*^9, 
   3.760692631082955*^9, 3.764327890680882*^9, 3.764782600795759*^9, 
   3.764783529998714*^9},ExpressionUUID->"c2643e63-9143-42b4-b741-\
d932bb6056e3"]
}, Open  ]],

Cell["\<\
CreatePOVMFromGateList automatically removes zero POVM elements if they occur \
at the end of the list of POVM elements. To avoid this, use the option \
DropZero->\[CloseCurlyDoubleQuote]None\[CloseCurlyDoubleQuote].\
\>", "Text",
 CellChangeTimes->{{3.7581148326562777`*^9, 3.758114866949037*^9}, {
   3.759408784975614*^9, 3.7594088053786917`*^9}, {3.7594091264589357`*^9, 
   3.7594091607255507`*^9}, {3.759472303876474*^9, 3.7594723660909977`*^9}, 
   3.761712613140925*^9},ExpressionUUID->"8bbcfa2f-7412-49a3-b5f5-\
f263fa9a8af4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"CreatePOVMFromGateList", "[", 
   RowBox[{"gatelist", ",", 
    RowBox[{"DropZero", "\[Rule]", "\"\<None\>\""}]}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.7581148766423807`*^9, 3.758114881940686*^9}, 
   3.759408779996728*^9, {3.7594723563240757`*^9, 3.759472357859391*^9}, 
   3.761712613161722*^9},ExpressionUUID->"78aea2f4-a1c9-4913-af71-\
13790053eee2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.3405412479121658`", ",", 
       RowBox[{"-", "0.050688533299318994`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.050688533299318994`"}], ",", "0.33129585501056025`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0018629890306536686`", ",", "0.013792111519555911`"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0.013792111519555911`", ",", "0.11964924809062978`"}], "}"}]}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.6575957630571806`", ",", "0.03689642177976311`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.03689642177976311`", ",", "0.5490548968988093`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.758114882413622*^9, 3.758126874531562*^9, 
  3.758127290331986*^9, 3.758128807467268*^9, 3.75817566814756*^9, 
  3.759297320178763*^9, 3.759313006432131*^9, 3.759386247912038*^9, 
  3.759404857972402*^9, 3.759406009237336*^9, 3.7594083643128223`*^9, 
  3.759409093113328*^9, 3.759409564623608*^9, 3.7594723583640823`*^9, 
  3.7594732007391367`*^9, 3.760692631172385*^9, 3.7643278907219*^9, 
  3.764782600809805*^9, 
  3.764783530024251*^9},ExpressionUUID->"5befc15b-2f29-4114-a0e9-\
e68d61613515"]
}, Open  ]],

Cell["\<\
The option DropZero->\[CloseCurlyDoubleQuote]All\[CloseCurlyDoubleQuote] \
removes all POVM elements.  Note that this can make it difficult to identify \
POVM elements with outcomes (in the case where zero elements are in the \
middle of the list of POVM elements).\
\>", "Text",
 CellChangeTimes->{{3.759472369044052*^9, 
  3.7594723978261023`*^9}},ExpressionUUID->"91f55a76-3668-42aa-b465-\
42d3b6438870"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"POVM2", "=", 
  RowBox[{"Insert", "[", 
   RowBox[{"POVM", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "2"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.759472708662435*^9, 3.759472718956218*^9}, 
   3.759472789652341*^9},ExpressionUUID->"04c70313-a730-489b-a292-\
17d135ad29d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.3405412479121661`", ",", 
       RowBox[{"-", "0.050688533299314276`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.050688533299314276`"}], ",", "0.33129585501055964`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0018629890306534052`", ",", "0.013792111519554992`"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0.013792111519554992`", ",", "0.11964924809063093`"}], "}"}]}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.6575957630571805`", ",", "0.036896421779759284`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.036896421779759284`", ",", "0.5490548968988095`"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.759472719255019*^9, 3.7594727899231157`*^9, 
  3.759473200764674*^9, 3.760692631249692*^9, 3.7643278907283087`*^9, 
  3.7647826008227177`*^9, 
  3.764783530049058*^9},ExpressionUUID->"eef37c81-d36c-4c24-ad6f-\
552a685c2430"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"gatelist2", "=", 
   RowBox[{"DecPOVMInQCM", "[", "POVM2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.75947243017353*^9, 3.759472457112883*^9}, {
  3.759472504185601*^9, 3.75947253170373*^9}, {3.7594725859757032`*^9, 
  3.7594725864385433`*^9}, {3.759472622238379*^9, 3.75947264962143*^9}, {
  3.759472728676963*^9, 
  3.75947273674771*^9}},ExpressionUUID->"14976b93-1477-4332-9e30-\
36a0ecc86e29"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"CreatePOVMFromGateList", "[", 
   RowBox[{"gatelist2", ",", 
    RowBox[{"DropZero", "\[Rule]", "\"\<All\>\""}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.759472767490901*^9, 3.759472767827058*^9}, 
   3.761712613170559*^9},ExpressionUUID->"b0f73c52-2525-4d6c-a325-\
821cae2fc26e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.3405412479121669`", ",", 
       RowBox[{"-", "0.050688533299314456`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.050688533299314456`"}], ",", "0.33129585501056025`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.001862989030653829`", ",", "0.013792111519554513`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.013792111519554513`", ",", "0.11964924809063002`"}], "}"}]}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.6575957630571797`", ",", "0.03689642177976012`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.03689642177976012`", ",", "0.5490548968988098`"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7594727681377907`*^9, 3.759472792911304*^9}, 
   3.759473201647521*^9, 3.759473813144834*^9, 3.760692632318919*^9, 
   3.764327891647243*^9, 3.7647826015925617`*^9, 
   3.764783530700439*^9},ExpressionUUID->"22d92aef-df71-4210-92c8-\
59863cd56d07"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"CreatePOVMFromGateList", "[", "gatelist2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7594724665688553`*^9, 3.759472471280469*^9}, {
   3.75947260104636*^9, 3.759472606078227*^9}, {3.759472744620871*^9, 
   3.759472749963492*^9}, 3.759473424741453*^9, 
   3.761712613179501*^9},ExpressionUUID->"75ceb39b-b86e-4c97-99d2-\
c9f7eec1bc7c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.3405412479121669`", ",", 
       RowBox[{"-", "0.050688533299314456`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.050688533299314456`"}], ",", "0.33129585501056025`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.001862989030653829`", ",", "0.013792111519554513`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.013792111519554513`", ",", "0.11964924809063002`"}], "}"}]}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.6575957630571797`", ",", "0.03689642177976012`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.03689642177976012`", ",", "0.5490548968988098`"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.75947246705488*^9, 3.759472471564242*^9}, 
   3.7594725396062803`*^9, {3.759472588498322*^9, 3.759472651667377*^9}, {
   3.7594727411126127`*^9, 3.75947275037818*^9}, 3.759472794096842*^9, 
   3.759473201689049*^9, {3.759473787651284*^9, 3.759473813901104*^9}, 
   3.760692632413419*^9, 3.7643278916793957`*^9, 3.764782601609613*^9, 
   3.7647835307277403`*^9},ExpressionUUID->"5ecd4a21-7067-485e-a3a4-\
c599252c5a5f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constructing circuits", "Subsection",
 CellChangeTimes->{{3.7591447743066874`*^9, 
  3.759144782610339*^9}},ExpressionUUID->"00be9a5d-6e47-49f4-8c12-\
dd0ff0fcd6a7"],

Cell["\<\
We can also build our own circuits and use the code to simplify them\
\>", "Text",
 CellChangeTimes->{{3.757610325689752*^9, 
  3.757610341345042*^9}},ExpressionUUID->"ddd110aa-d3a7-4f4d-9c9d-\
446a7dbe0470"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{"1", ",", "2"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    RowBox[{"Rz", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "2"}], ",", "3"}], "]"}], ",", 
    RowBox[{"Rz", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "2"}], ",", "1"}], "]"}], ",", 
    RowBox[{"Rx", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "4"}], ",", "2"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{"1", ",", "2"}], "]"}], ",", 
    RowBox[{"Rz", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "4"}], ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{"3", ",", "2"}], "]"}], ",", 
    RowBox[{"Rx", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "8"}], ",", "2"}], "]"}], ",", 
    RowBox[{"Ry", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "3"}], ",", "3"}], "]"}], ",", 
    RowBox[{"Rx", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "4"}], ",", "3"}], "]"}], ",", 
    RowBox[{"Rz", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "6"}], ",", "3"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7576103438945827`*^9, 3.757610419544932*^9}, {
  3.757610617280759*^9, 3.757610645195834*^9}, {3.757610676334146*^9, 
  3.757610779597756*^9}, {3.757610820375698*^9, 3.757610831429715*^9}, {
  3.7576108773712807`*^9, 3.757610927700643*^9}, {3.7576109849315233`*^9, 
  3.757610985808168*^9}},ExpressionUUID->"1271d227-cf3d-4583-9b7e-\
c2dfbe8c0baf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "2"], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "2"], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["\[Pi]", "4"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "4"], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["\[Pi]", "8"], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     FractionBox["\[Pi]", "3"], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["\[Pi]", "4"], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["\[Pi]", "6"], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.757610349200461*^9, 3.7576103526048813`*^9}, 
   3.757610409419736*^9, {3.7576106203372507`*^9, 3.757610645670766*^9}, {
   3.757610695830809*^9, 3.757610780010274*^9}, 3.757610831874714*^9, {
   3.757610878586617*^9, 3.7576109285807467`*^9}, 3.757610986391431*^9, 
   3.757612079714033*^9, 3.757692721344544*^9, 3.757692967856257*^9, 
   3.757713533184863*^9, 3.758114902600553*^9, 3.7581268745592327`*^9, 
   3.758127290355329*^9, 3.7581288074892282`*^9, 3.758175668173127*^9, 
   3.7591447945129766`*^9, 3.759145884476169*^9, 3.759146101338922*^9, 
   3.759146501869831*^9, 3.759146781321645*^9, 3.7591472989370213`*^9, 
   3.759147573968011*^9, 3.759147693816361*^9, 3.759148366920669*^9, 
   3.7591550037187862`*^9, 3.7592109839630003`*^9, 3.7592952487302723`*^9, 
   3.759297320195997*^9, 3.759298476184825*^9, 3.7592987751109*^9, 
   3.759298919456978*^9, 3.7593130065207872`*^9, 3.759384852042742*^9, 
   3.759384978737102*^9, 3.759386247956502*^9, 3.759391355569838*^9, 
   3.759404858000658*^9, 3.759406009263805*^9, 3.759408364333632*^9, 
   3.759409564646144*^9, 3.7594732017200336`*^9, 3.760692632500622*^9, 
   3.764327891704411*^9, 3.764782601622423*^9, 
   3.764783530753124*^9},ExpressionUUID->"4d7e16a2-9949-4014-a162-\
04648744c516"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{{3.75761065001544*^9, 
  3.757610655702881*^9}},ExpressionUUID->"55104d62-31b1-40c2-84fb-\
b190f811169e"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -1.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {10., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -3.}, {7., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -3.}, {2., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {3., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -3.}, {4., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -3.}, {8., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -3.}, {9., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -3.}, {10., -3.}}]}}, {{}, 
     {GrayLevel[0], DiskBox[{2., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{3., -1.2}, {3., -0.8}}], 
       LineBox[{{2.8, -1.}, {3.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -1.}]}}, 
     {GrayLevel[0], DiskBox[{5., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -1.2}, {6.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {6., -1.}]}}, {}, 
     {GrayLevel[0], DiskBox[{8., -1.}, 0.1]}, {}, {}, 
     {GrayLevel[0], DiskBox[{3., -2.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{2., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{2., -2.2}, {2., -1.8}}], 
       LineBox[{{1.8, -2.}, {2.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -2.2}, {4.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {4., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -2.2}, {5., -1.8}}], 
       LineBox[{{4.8, -2.}, {5.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{6., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{6., -2.2}, {6., -1.8}}], 
       LineBox[{{5.8, -2.}, {6.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -2.2}, {7.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {7., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{8., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{8., -2.2}, {8., -1.8}}], 
       LineBox[{{7.8, -2.}, {8.2, -2.}}]}}, {}, {}, 
     {GrayLevel[0], DiskBox[{6., -3.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -3.2}, {2.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -3.}]}}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -3.2}, {7.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {7., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{7.8, -3.2}, {8.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {8., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -3.2}, {9.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {9., -3.}]}}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJx1zsEJgDAMQNHgKcceeuihSC3dQ2dwBMGzI+pIjqBiI/SDgRBeAkmGZZvX
TkT6O5/6xjnWutfG1FphB3s4wBFOcIbLz3052n/NgrmDPRzgCCc4wwW2fYr/
zIK5wg72cIQTnOHy+QK/rS6R
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{528., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.757610656016385*^9, {3.757610698852139*^9, 3.757610716696424*^9}, {
   3.757610747210848*^9, 3.757610781818118*^9}, 3.7576108344050703`*^9, {
   3.75761088116187*^9, 3.7576109312699003`*^9}, 3.7576109884265347`*^9, 
   3.7576120797438307`*^9, 3.7576927228382998`*^9, 3.757692967885502*^9, 
   3.7577135332072163`*^9, 3.758114903548053*^9, 3.758126874587571*^9, 
   3.758127290379592*^9, 3.758128807514492*^9, 3.7581756681974907`*^9, 
   3.759144795349783*^9, 3.759148368606007*^9, 3.7591550043798428`*^9, 
   3.759210984940648*^9, 3.759295250719316*^9, 3.759297320219829*^9, 
   3.759313006683879*^9, 3.759386248003911*^9, 3.7593913564564342`*^9, 
   3.75940485803193*^9, 3.7594060092930813`*^9, 3.759408364357091*^9, 
   3.7594095646698647`*^9, 3.759473201745281*^9, 3.7606926325896883`*^9, 
   3.764327891729702*^9, 3.764782601640522*^9, 
   3.764783530780943*^9},ExpressionUUID->"f0c958c5-7bca-4d85-889b-\
5e62e8932a9b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"gatelist2", "=", 
   RowBox[{"NSimplifyGateList", "[", "gatelist", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7591458875027237`*^9, 3.759145925996479*^9}, {
   3.759147365348275*^9, 3.759147366665769*^9}, {3.759147581060704*^9, 
   3.759147583406156*^9}, {3.759298294833798*^9, 3.7592982951692667`*^9}, {
   3.7593913486802797`*^9, 3.759391352005307*^9}, {3.761367155917823*^9, 
   3.761367172544011*^9}, 
   3.761712802860484*^9},ExpressionUUID->"3c218d11-f03d-413b-813c-\
8d59fe60c6cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.004316`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0.7137243789447655`", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2.356194490192345`", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1.1780972450961724`", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1.2094292028881888`", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0.9111954622534798`", ",", "3"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7591460887125177`*^9, 3.759146111249045*^9}, 
   3.759146200376472*^9, 3.7591466436874313`*^9, 3.7591467826308947`*^9, 
   3.759147300806327*^9, 3.759147439623184*^9, {3.75914756967446*^9, 
   3.759147584036165*^9}, 3.759147766148986*^9, 3.759155006239333*^9, 
   3.759155084577792*^9, 3.759211459478078*^9, 3.759295509420704*^9, 
   3.759297455462132*^9, 3.759298180988269*^9, 3.759298326453497*^9, {
   3.7592984707286386`*^9, 3.759298489895183*^9}, 3.7592989352991343`*^9, 
   3.7593851599868*^9, 3.759386878822784*^9, 3.759391357804793*^9, 
   3.7593917097277527`*^9, 3.75940485804348*^9, 3.759406009302327*^9, 
   3.7594083643678217`*^9, 3.759409564678855*^9, 3.759473201760089*^9, 
   3.7606926326008368`*^9, 3.764327891759001*^9, 3.764782601655608*^9, 
   3.764783530790408*^9},ExpressionUUID->"fbc32646-aba7-495f-964b-\
93b7d2ce90a9"]
}, Open  ]],

Cell["\<\
We could also simplify the gate sequence analytically, by calling \
SimplifyGateList[gatelist]]. But this takes much longer:\
\>", "Text",
 CellChangeTimes->{{3.757610325689752*^9, 3.757610341345042*^9}, {
   3.7593914820944023`*^9, 3.759391521244656*^9}, {3.7613671559660892`*^9, 
   3.761367172576445*^9}, 
   3.7617128028851843`*^9},ExpressionUUID->"163b658f-cb2c-4708-86da-\
c05a9cd67d87"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"gatelist2", "=", 
   RowBox[{"SimplifyGateList", "[", "gatelist", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.761367156074109*^9, 3.761367172592923*^9}, 
   3.761712802912055*^9},ExpressionUUID->"676705f2-1aa3-4312-9371-\
d076804c155a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.440024`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"4", " ", 
          SqrtBox["3"]}], "]"}]}], ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox[
        RowBox[{"3", " ", "\[Pi]"}], "4"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       FractionBox[
        RowBox[{"3", " ", "\[Pi]"}], "8"], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"\[Pi]", "-", 
        RowBox[{"2", " ", 
         RowBox[{"ArcTan", "[", 
          SqrtBox[
           RowBox[{
            FractionBox["1", "7"], " ", 
            RowBox[{"(", 
             RowBox[{"9", "+", 
              RowBox[{"4", " ", 
               SqrtBox["2"]}]}], ")"}]}]], "]"}]}]}], ",", "3"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"3", ",", 
       RowBox[{"ArcCot", "[", 
        FractionBox["17", 
         SqrtBox[
          RowBox[{"243", "+", 
           RowBox[{"168", " ", 
            SqrtBox["2"]}]}]]], "]"}], ",", "3"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.759211373896865*^9, 3.759295265440196*^9, 3.759297333793139*^9, 
   3.759298115705028*^9, 3.7592984843013277`*^9, 3.759298832304789*^9, 
   3.759298935082924*^9, {3.759384976516267*^9, 3.7593849840302553`*^9}, 
   3.759386565663184*^9, 3.759391708378872*^9, 3.7594048618078213`*^9, 
   3.759406012908883*^9, 3.7594083682371597`*^9, 3.759409568313881*^9, 
   3.759473516021304*^9, 3.760692947308655*^9, 3.764328206002859*^9, 
   3.764782605517407*^9, 
   3.764783534171743*^9},ExpressionUUID->"2d35d985-de64-4e0b-aa2a-\
e19a858eed56"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", "gatelist2", "]"}]], "Input",
 CellChangeTimes->{{3.7576107878604803`*^9, 3.7576108024066677`*^9}, {
  3.757611111716605*^9, 
  3.757611116363168*^9}},ExpressionUUID->"73c5cc67-de14-4add-b14d-\
a2cc49cfbabf"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -3.}, {2., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {3., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -3.}, {4., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -3.}, {7., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], 
      LineBox[{{7., -3.}, {8., -3.}}]}}, {{}, 
     {GrayLevel[0], DiskBox[{2., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{3., -1.2}, {3., -0.8}}], 
       LineBox[{{2.8, -1.}, {3.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -1.}]}}, {}, {}, {}, {}, 
     {GrayLevel[0], DiskBox[{3., -2.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{2., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{2., -2.2}, {2., -1.8}}], 
       LineBox[{{1.8, -2.}, {2.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -2.2}, {4.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {4., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -2.2}, {5., -1.8}}], 
       LineBox[{{4.8, -2.}, {5.2, -2.}}]}}, {}, {}, {}, 
     {GrayLevel[0], DiskBox[{5., -3.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -3.2}, {2.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -3.}]}}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -3.2}, {6.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -3.2}, {7.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {7., -3.}]}}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGCQAGIQDQEf7KH0fqiAAyqfA40vgMYXQeNLoPFl0PgKOMxn
OIDqHhifAU1eAI0vgsaXQOPLoPEV0Pgw/Rxo9sP4DGjyHGh8ATS+BBpfBo2v
AOcDACLcJcs=
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.7576108028599787`*^9, 3.757610836740749*^9, 3.757610982670725*^9, 
   3.7576110179642057`*^9, 3.757611132742955*^9, 3.757611362495373*^9, 
   3.757612105656725*^9, 3.75769272810779*^9, 3.757692972081697*^9, 
   3.757713554619885*^9, 3.758114928294742*^9, 3.7581268960174503`*^9, 
   3.7581273118709383`*^9, 3.758128829047825*^9, 3.758175689798424*^9, 
   3.7591451690785646`*^9, 3.759211459539562*^9, 3.759295513099448*^9, 
   3.759298546853293*^9, 3.759298935403125*^9, 3.759386879070211*^9, {
   3.759391359334684*^9, 3.759391360702442*^9}, 3.75940486185609*^9, 
   3.759406013004237*^9, 3.759408368329295*^9, 3.759409568355838*^9, 
   3.759473516094068*^9, 3.7606929474820557`*^9, 3.764328206078147*^9, 
   3.764782605554961*^9, 
   3.7647835342157297`*^9},ExpressionUUID->"78c404e3-c264-4463-9bc0-\
c2bda65cc265"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"N", "[", 
    RowBox[{"CreateOperationFromGateList", "[", 
     RowBox[{"gatelist", ",", 
      RowBox[{"FullSimp", "\[Rule]", "False"}]}], "]"}], "]"}]}], ";", 
  RowBox[{"out2", "=", 
   RowBox[{"N", "[", 
    RowBox[{"CreateOperationFromGateList", "[", 
     RowBox[{"gatelist2", ",", 
      RowBox[{"FullSimp", "\[Rule]", "False"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.759211448812872*^9, 3.759211476939416*^9}, {
  3.759211511032996*^9, 3.759211522024602*^9}, {3.759211570530267*^9, 
  3.759211573792707*^9}, {3.76171273227735*^9, 
  3.7617127322804737`*^9}},ExpressionUUID->"343fa44a-e15d-467e-91bd-\
4aba2211b238"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"out2", "/", 
     RowBox[{"out2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
    RowBox[{"out", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "out"}], "]"}]], "Input",
 CellChangeTimes->{{3.7592114825719957`*^9, 3.759211499714663*^9}, {
  3.759211577122204*^9, 
  3.759211577551053*^9}},ExpressionUUID->"3e9d5ebe-f2a9-4693-8245-\
ae34df009d80"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.759211524238846*^9, 3.75921158027794*^9, 3.7592955217369204`*^9, 
   3.7592985488662033`*^9, 3.759298839904954*^9, {3.759298887539904*^9, 
   3.759298892271165*^9}, 3.759298936956649*^9, 3.759386880375475*^9, 
   3.7593917124494658`*^9, 3.7594048635920467`*^9, 3.759406014671941*^9, 
   3.759408370036296*^9, 3.759409570016931*^9, 3.759473517247377*^9, 
   3.760692948821744*^9, 3.764328207266467*^9, 3.7647826073240547`*^9, 
   3.764783535941359*^9},ExpressionUUID->"14298fbd-806c-4ed0-9de2-\
75209da14f37"]
}, Open  ]],

Cell["For simple constructions, ColumnByColumnDec is often best", "Text",
 CellChangeTimes->{{3.75929562689392*^9, 
  3.759295649778162*^9}},ExpressionUUID->"31ef9e26-a2d1-4bf0-9a42-\
a9a6c35dcfa3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"u", "=", 
  RowBox[{"NCreateOperationFromGateList", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"Ry", "[", 
      RowBox[{
       FractionBox["\[Pi]", "4"], ",", "3"}], "]"}], ",", 
     RowBox[{"Rx", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "8"}], ",", "3"}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{"2", ",", "3"}], "]"}], ",", 
     RowBox[{"Ry", "[", 
      RowBox[{
       FractionBox["\[Pi]", "4"], ",", "2"}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.759295672594904*^9, 3.7592957896464767`*^9}, 
   3.7617127322932043`*^9, {3.764782277808543*^9, 
   3.764782322263393*^9}},ExpressionUUID->"1ef13335-0561-4670-8cd5-\
4d560f7c9e82"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.837152601532152`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.06897484482073575`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.3467599613305369`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.16652000582879986`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.14363267887107836`"}], "+", 
      RowBox[{"0.06897484482073576`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.3467599613305368`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.028570316187328384`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.3467599613305369`"}], "+", 
      RowBox[{"0.1665200058287999`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.8371526015321519`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.06897484482073575`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.3467599613305368`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.028570316187328384`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.14363267887107836`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.06897484482073575`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.3467599613305368`"}], "+", 
      RowBox[{"0.028570316187328384`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.14363267887107836`"}], "-", 
      RowBox[{"0.06897484482073575`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3467599613305368`"}], "+", 
      RowBox[{"0.1665200058287999`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.8371526015321518`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.06897484482073575`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.14363267887107836`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.06897484482073576`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3467599613305368`"}], "-", 
      RowBox[{"0.028570316187328384`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.8371526015321519`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.06897484482073575`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.3467599613305368`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.16652000582879986`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3467599613305368`"}], "+", 
      RowBox[{"0.1665200058287999`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.8371526015321518`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.06897484482073575`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3467599613305368`"}], "+", 
      RowBox[{"0.028570316187328384`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.14363267887107836`"}], "-", 
      RowBox[{"0.06897484482073575`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.8371526015321519`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.06897484482073575`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.3467599613305368`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.16652000582879986`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.14363267887107836`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.06897484482073576`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3467599613305368`"}], "-", 
      RowBox[{"0.028570316187328384`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.14363267887107836`"}], "+", 
      RowBox[{"0.06897484482073576`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.3467599613305368`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.028570316187328384`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.837152601532152`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.06897484482073575`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.3467599613305369`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.16652000582879986`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.3467599613305368`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.028570316187328384`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.14363267887107836`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.06897484482073575`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3467599613305369`"}], "+", 
      RowBox[{"0.1665200058287999`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.8371526015321519`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.06897484482073575`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.759295703869923*^9, 3.75929579054075*^9}, 
   3.759298548895228*^9, 3.7593868806100388`*^9, 3.759391715519061*^9, 
   3.759404863624452*^9, 3.759406014697136*^9, 3.759408370059238*^9, 
   3.759409570041985*^9, 3.759473517277568*^9, 3.760692948854862*^9, 
   3.7643282072984333`*^9, 3.764782607340773*^9, 
   3.764783535966794*^9},ExpressionUUID->"cc03cc90-e3bc-4d1a-8e20-\
0f030f3d70ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"ColumnByColumnDec", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.759295821673894*^9, 
  3.7592958242261457`*^9}},ExpressionUUID->"cfa094ca-cee9-4e80-adfa-\
6969afa25d1d"],

Cell[BoxData["14"], "Output",
 CellChangeTimes->{3.75929582481702*^9, 3.759298549002812*^9, 
  3.759386880822137*^9, 3.7594048637329884`*^9, 3.759406014804306*^9, 
  3.759408370175497*^9, 3.759409570150474*^9, 3.75947351741943*^9, 
  3.760692949058268*^9, 3.764328207461067*^9, 3.764782607460376*^9, 
  3.7647835360790367`*^9},ExpressionUUID->"e125bbc1-e31a-4f89-945b-\
8c9b9f537f99"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"QSD", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.759295796696266*^9, 
  3.759295816709737*^9}},ExpressionUUID->"6f7f8f3c-534c-4acd-847d-\
befd3ad42a51"],

Cell[BoxData["18"], "Output",
 CellChangeTimes->{{3.759295806431654*^9, 3.759295817027623*^9}, 
   3.75929854918274*^9, 3.759386881114963*^9, 3.7594048638925047`*^9, 
   3.7594060149636793`*^9, 3.75940837034503*^9, 3.759409570317648*^9, 
   3.759473517654385*^9, 3.760692949347782*^9, 3.764328207702916*^9, 
   3.7647826076256857`*^9, 
   3.764783536245713*^9},ExpressionUUID->"d43ade35-71e9-494a-b3d5-\
5334a8dc38ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", 
  RowBox[{"KnillDec", "[", "u", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7592958307116747`*^9, 3.75929583252348*^9}, 
   3.763036577725753*^9},ExpressionUUID->"5deebde4-b215-4153-8efa-\
8bb1fbdf6279"],

Cell[BoxData["91"], "Output",
 CellChangeTimes->{3.7592958350991793`*^9, 3.759298551350469*^9, 
  3.759386884014572*^9, 3.759404866082151*^9, 3.759406017132718*^9, 
  3.75940837253384*^9, 3.7594095725609426`*^9, 3.7594735205832*^9, 
  3.76069295236047*^9, 3.764328210725297*^9, 3.76478260997443*^9, 
  3.7647835385777483`*^9},ExpressionUUID->"fe743e21-6b94-456b-9818-\
01d48a519370"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["We can also generate quantum instruments", "Subsection",
 CellChangeTimes->{{3.759147779738634*^9, 
  3.7591477860502663`*^9}},ExpressionUUID->"6c97637c-6551-4cbf-b3f0-\
ee541fbdaa9c"],

Cell["\<\
If we both trace out and measure, we get a quantum instrument\
\>", "Text",
 CellChangeTimes->{{3.758114917585091*^9, 
  3.758114931191354*^9}},ExpressionUUID->"85f84324-f7bf-480f-a8a9-\
6c91d84ad7dc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gatelist", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{"2", ",", "1"}], "]"}], ",", 
     RowBox[{"Rz", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], ",", "3"}], "]"}], ",", 
     RowBox[{"Rz", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], ",", "1"}], "]"}], ",", 
     RowBox[{"Rx", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "4"}], ",", "2"}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"Rz", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "4"}], ",", "1"}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{"3", ",", "2"}], "]"}], ",", 
     RowBox[{"Rx", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "8"}], ",", "2"}], "]"}], ",", 
     RowBox[{"Ry", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "3"}], ",", "3"}], "]"}], ",", 
     RowBox[{"Rx", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "4"}], ",", "3"}], "]"}], ",", 
     RowBox[{"Rz", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "6"}], ",", "3"}], "]"}], ",", 
     RowBox[{"CNOT", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"TrOut", "[", "1", "]"}], ",", 
     RowBox[{"Mmt", "[", "2", "]"}]}], "}"}]}], ";", 
  RowBox[{"gatelist", "=", 
   RowBox[{"NGateList", "[", "gatelist", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.758114944337512*^9, 3.758114954507184*^9}, 
   3.758114996312128*^9, {3.7581150507350903`*^9, 3.758115056901775*^9}, {
   3.764782390239044*^9, 
   3.764782443975432*^9}},ExpressionUUID->"2b2f8276-0446-489d-86e0-\
057bcfd87ce5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.5707963267948966`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.5707963267948966`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.7853981633974483`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.7853981633974483`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.39269908169872414`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.0471975511965976`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.7853981633974483`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.5235987755982988`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.758114958380333*^9, 3.7581149974215717`*^9, 
  3.758115057284898*^9, 3.7581268960294743`*^9, 3.758127311893194*^9, 
  3.7581288290650063`*^9, 3.758175689821644*^9, 3.759298551393861*^9, 
  3.759386884216569*^9, 3.759404866120063*^9, 3.759406017163931*^9, 
  3.759408372563843*^9, 3.759409572591772*^9, 3.759473520634128*^9, 
  3.7606929525213013`*^9, 3.764328210780806*^9, 3.764328504363948*^9, 
  3.764782609997444*^9, 3.764783538609036*^9, 
  3.772275589461001*^9},ExpressionUUID->"33d3783e-71e0-473c-8fae-\
3ffdd0d5cdb9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{
  3.758115003980455*^9},ExpressionUUID->"306f788b-fb41-47df-a4da-\
dad4a1e037a1"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[1], Thickness[Large], LineBox[{{9., -1.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {8., -1.}}]}, 
     {GrayLevel[0], LineBox[{{9., -1.95}, {10., -1.95}}], 
      LineBox[{{9., -2.05}, {10., -2.05}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -3.}, {7., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -3.}, {2., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {3., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -3.}, {4., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -3.}, {8., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -3.}, {9., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -3.}, {10., -3.}}]}}, {{}, 
     {GrayLevel[0], DiskBox[{2., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{3., -1.2}, {3., -0.8}}], 
       LineBox[{{2.8, -1.}, {3.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -1.}]}}, 
     {GrayLevel[0], DiskBox[{5., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -1.2}, {6.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {6., -1.}]}}, {}, 
     {GrayLevel[0], DiskBox[{8., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -1.2}, {9.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Tr\"\>", {9., -1.}]}}, {}, 
     {GrayLevel[0], DiskBox[{3., -2.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{2., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{2., -2.2}, {2., -1.8}}], 
       LineBox[{{1.8, -2.}, {2.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -2.2}, {4.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {4., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -2.2}, {5., -1.8}}], 
       LineBox[{{4.8, -2.}, {5.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{6., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{6., -2.2}, {6., -1.8}}], 
       LineBox[{{5.8, -2.}, {6.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -2.2}, {7.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {7., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{8., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{8., -2.2}, {8., -1.8}}], 
       LineBox[{{7.8, -2.}, {8.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -2.2}, {9.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Mmt\"\>", {9., -2.}]}}, {}, 
     {GrayLevel[0], DiskBox[{6., -3.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -3.2}, {2.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -3.}]}}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -3.2}, {7.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {7., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{7.8, -3.2}, {8.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {8., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -3.2}, {9.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {9., -3.}]}}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJx1zsEJgDAMQNHgKcceeuihSC3dQ2dwBMGzI+pIjqBiI/SDgRBeAkmGZZvX
TkT6O5/6xjnWutfG1FphB3s4wBFOcIbLz3052n/NgrmDPRzgCCc4wwW2fYr/
zIK5wg72cIQTnOHy+QK/rS6R
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{582., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.7581150044349337`*^9, 3.758115059229808*^9, 
  3.758126896062106*^9, 3.758127311916114*^9, 3.75812882908778*^9, 
  3.758175689847611*^9, 3.759298551426277*^9, 3.759386884412631*^9, 
  3.759404866169684*^9, 3.7594060171921864`*^9, 3.759408372588305*^9, 
  3.759409572617571*^9, 3.7594735206642857`*^9, 3.760692952554083*^9, 
  3.7643282108095217`*^9, 3.764782610070665*^9, 3.764783538636054*^9, 
  3.7722755910278254`*^9},ExpressionUUID->"fdb1fc1c-50ad-4893-aff2-\
22f488560fb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"inst", "=", 
  RowBox[{"Chop", "[", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.758114961614356*^9, 3.7581149712937937`*^9}, {
   3.758115084755925*^9, 3.7581150861267138`*^9}, {3.7581151940513353`*^9, 
   3.758115211052903*^9}, 3.75811559202029*^9, {3.758117010039863*^9, 
   3.7581170193434677`*^9}, {3.758128696622505*^9, 3.7581286984612103`*^9}, 
   3.761712732302416*^9},ExpressionUUID->"e0bbfba7-de19-46b6-ae12-\
7ad9d42b6fa5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.2787671032336736`"}], "+", 
          RowBox[{"0.624638186595596`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.3023075300280762`"}], "+", 
          RowBox[{"0.09151889317441637`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "0.4173698927118263`"}], "-", 
          RowBox[{"0.1862662233353846`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.1369677029175988`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.45243519153718903`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.22306920044680234`"}], "-", 
          RowBox[{"0.4167707835199594`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.16341497177317568`"}], "+", 
          RowBox[{"0.4268351910260925`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0", ",", 
         RowBox[{"0.2784773344569256`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.14905007451629154`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.6388040065980748`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.24456778846155286`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"0.16341497177317565`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.4268351910260925`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.22306920044680234`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.4167707835199594`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0", ",", 
         RowBox[{"0.6388040065980749`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.24456778846155294`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.2784773344569256`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.14905007451629154`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "0.30230753002807614`"}], "-", 
          RowBox[{"0.09151889317441635`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.27876710323367343`"}], "-", 
          RowBox[{"0.6246381865955958`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "0.13696770291759874`"}], "+", 
          RowBox[{"0.4524351915371891`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.41736989271182623`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.18626622333538456`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.4173698927118263`"}], "-", 
          RowBox[{"0.1862662233353846`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.1369677029175988`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.45243519153718914`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "0.27876710323367354`"}], "+", 
          RowBox[{"0.6246381865955959`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.3023075300280762`"}], "+", 
          RowBox[{"0.09151889317441637`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.2784773344569256`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.14905007451629154`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.6388040065980748`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.24456778846155292`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "0.22306920044680234`"}], "-", 
          RowBox[{"0.41677078351995933`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.16341497177317568`"}], "+", 
          RowBox[{"0.4268351910260925`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"0.6388040065980748`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.24456778846155286`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.2784773344569256`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.14905007451629154`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0", ",", 
         RowBox[{"0.16341497177317565`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.4268351910260925`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.2230692004468024`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.4167707835199595`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "0.13696770291759874`"}], "+", 
          RowBox[{"0.45243519153718903`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.41736989271182623`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.18626622333538456`", " ", "\[ImaginaryI]"}]}], ",", "0", 
         ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "0.30230753002807614`"}], "-", 
          RowBox[{"0.09151889317441635`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.2787671032336735`"}], "-", 
          RowBox[{"0.6246381865955959`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.758114981035969*^9, {3.758115047203721*^9, 3.7581150864470787`*^9}, {
   3.758115196019088*^9, 3.758115211934247*^9}, 3.758115480135594*^9, 
   3.758115592918578*^9, 3.758116107687028*^9, {3.758116695875039*^9, 
   3.758116708530336*^9}, 3.758116803391542*^9, {3.758116985655406*^9, 
   3.7581170215366507`*^9}, 3.758126896073422*^9, 3.758127311931983*^9, 
   3.7581288291145353`*^9, 3.7581756898714*^9, 3.759298551447978*^9, 
   3.759386884517042*^9, 3.759404866184917*^9, 3.759406017206025*^9, 
   3.759408372603364*^9, 3.75940957263271*^9, 3.759473520685738*^9, 
   3.760692952631855*^9, 3.764328210845269*^9, 3.764782610087504*^9, 
   3.764783538649983*^9, 
   3.772275591911213*^9},ExpressionUUID->"f9755b3d-784d-48cf-a4b1-\
08c2874b55fa"]
}, Open  ]],

Cell["\<\
Each part of this should be a trace decreasing completely positive map such \
that the combined channel is trace preserving:\
\>", "Text",
 CellChangeTimes->{{3.7581170506641417`*^9, 3.758117063932863*^9}, {
  3.7581171698269663`*^9, 3.758117190887327*^9}, {3.758117259181191*^9, 
  3.7581172696945267`*^9}},ExpressionUUID->"fd628671-bef3-4e40-b23b-\
1567ed6febb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"chan1", ",", "chan2"}], "}"}], "=", "inst"}], ";"}]], "Input",
 CellChangeTimes->{{3.7581170665895348`*^9, 
  3.758117081256105*^9}},ExpressionUUID->"cc7d44d6-c315-44bb-8ee2-\
6406832dcdc6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CT", "[", 
       RowBox[{"chan1", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", 
      RowBox[{"chan1", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "chan1", "]"}]}], "}"}]}], "]"}], "+", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CT", "[", 
       RowBox[{"chan2", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", 
      RowBox[{"chan2", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "chan1", "]"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.75811708274375*^9, 3.758117132868374*^9}, {
  3.75811720232275*^9, 3.758117209662406*^9}, {3.7581172822163258`*^9, 
  3.758117287301502*^9}},ExpressionUUID->"7f95456d-9a0d-41c4-aa0e-\
4c1a2b2b109e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0.9999999999999998`", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0.9999999999999997`", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0.9999999999999996`", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0.9999999999999998`", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0.9999999999999998`", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0.9999999999999999`", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0.9999999999999998`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.758117093698144*^9, {3.758117128354142*^9, 3.758117133173616*^9}, 
   3.758117209844009*^9, 3.758117287758492*^9, 3.758126896102889*^9, 
   3.7581273119545107`*^9, 3.75812882913608*^9, 3.758175689897393*^9, 
   3.759298551492807*^9, 3.759386884776078*^9, 3.7594048662198887`*^9, 
   3.7594060172372417`*^9, 3.759408372631051*^9, 3.759409572661745*^9, 
   3.759473520726276*^9, 3.760692952779405*^9, 3.764328210877494*^9, 
   3.764782610107635*^9, 
   3.764783538679633*^9},ExpressionUUID->"e4af81fe-bccf-4c44-8c5b-\
6b09c4a0d209"]
}, Open  ]],

Cell["\<\
If we care about the measurement, we can instead construct the POVM\
\>", "Text",
 CellChangeTimes->{{3.758117310003169*^9, 
  3.758117328517786*^9}},ExpressionUUID->"5e093caf-a4c8-431f-88a5-\
d3052438174c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"POVM", "=", 
  RowBox[{"Chop", "[", 
   RowBox[{"CreatePOVMFromGateList", "[", "gatelist", "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.758117331001227*^9, 3.75811735615005*^9}, 
   3.7617126131917353`*^9},ExpressionUUID->"531b8b99-8008-4e82-8c85-\
ba9edbfb6ec7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.6913417161825448`", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.46193976625564337`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0.30865828381745514`", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.46193976625564326`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0.3086582838174551`", ",", "0", ",", "0", ",", "0",
        ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.4619397662556433`", " ", "\[ImaginaryI]"}]}], ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0.6913417161825444`", ",", "0", ",", "0",
        ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.46193976625564326`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.46193976625564337`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.3086582838174552`", ",", "0", ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.46193976625564326`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.6913417161825446`", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.4619397662556433`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.6913417161825448`", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.46193976625564326`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.30865828381745514`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.3086582838174552`", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.4619397662556433`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0.6913417161825447`", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.46193976625564326`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0.6913417161825446`", ",", "0", ",", "0", ",", "0",
        ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.46193976625564326`", " ", "\[ImaginaryI]"}]}], ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0.30865828381745514`", ",", "0", ",", 
       "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.46193976625564337`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.4619397662556433`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.6913417161825446`", ",", "0", ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.46193976625564326`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.30865828381745514`", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.46193976625564326`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.3086582838174551`", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.46193976625564337`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.6913417161825447`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.75811734204743*^9, 3.7581173564408493`*^9}, 
   3.758126896128071*^9, 3.758127311974326*^9, 3.758128829153976*^9, 
   3.758175689925003*^9, 3.75929855151869*^9, 3.7593868849721737`*^9, 
   3.759404866250374*^9, 3.7594060172632647`*^9, 3.759408372660449*^9, 
   3.759409572685687*^9, 3.75947352075448*^9, 3.760692952869787*^9, 
   3.7643282109037437`*^9, 3.764782610123568*^9, 
   3.764783538704661*^9},ExpressionUUID->"d0f63aa0-f34e-4ddd-ac64-\
508733226bf5"]
}, Open  ]],

Cell["These agree with the channels", "Text",
 CellChangeTimes->{{3.758117394894535*^9, 
  3.75811740467785*^9}},ExpressionUUID->"282ba5b7-8cc8-48c5-a21c-\
14d88c65ef65"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"POVM", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "-", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CT", "[", 
       RowBox[{"chan1", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", 
      RowBox[{"chan1", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "chan1", "]"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7581173806998*^9, 
  3.7581173907323103`*^9}},ExpressionUUID->"038216d1-2671-48e0-814f-\
dfba8b431d88"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7581173911001997`*^9, 3.758126896153216*^9, 
  3.758127311994073*^9, 3.7581288291733227`*^9, 3.75817568994808*^9, 
  3.759298551544159*^9, 3.759386885169312*^9, 3.759404866279935*^9, 
  3.759406017291675*^9, 3.759408372684717*^9, 3.759409572709813*^9, 
  3.759473520787107*^9, 3.760692952949728*^9, 3.764328210929577*^9, 
  3.764782610141356*^9, 
  3.764783538730885*^9},ExpressionUUID->"595879e2-dbd7-4d2a-94bb-\
0bd909fff0fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"POVM", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "-", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CT", "[", 
       RowBox[{"chan2", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", 
      RowBox[{"chan2", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "chan2", "]"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.75811741066818*^9, 
  3.758117415806919*^9}},ExpressionUUID->"a2fcc405-c97f-49a2-82fc-\
3716cfe89448"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.758117416052176*^9, 3.7581268961793537`*^9, 
  3.758127312013077*^9, 3.758128829192648*^9, 3.758175689970702*^9, 
  3.759298551568699*^9, 3.75938688541488*^9, 3.759404866308606*^9, 
  3.759406017317398*^9, 3.759408372707848*^9, 3.759409572733605*^9, 
  3.759473520812776*^9, 3.760692953030808*^9, 3.764328210958939*^9, 
  3.76478261015757*^9, 
  3.764783538754722*^9},ExpressionUUID->"6144186c-97ff-451d-b753-\
527683ce58b4"]
}, Open  ]],

Cell["\<\
The following command provides a convenient way to see the action of an \
instrument:\
\>", "Text",
 CellChangeTimes->{{3.772275547620594*^9, 
  3.7722755779299603`*^9}},ExpressionUUID->"df5b36b0-98a4-445f-b78a-\
38f813f519ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InstrumentActionOnRho", "[", 
   RowBox[{"instr_", ",", " ", "rho_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "j", ",", " ", "proba", ",", " ", "out", ",", " ", 
      RowBox[{"listProba", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"listOut", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", "chan"}], "}"}], ",", "\n", "  ", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", "<=", 
       RowBox[{"Length", "[", "instr", "]"}]}], ",", " ", 
      RowBox[{"i", "++"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"chan", " ", "=", " ", 
        RowBox[{"instr", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"out", " ", "=", " ", 
        RowBox[{"Chop", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"chan", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ".", "rho", ".", 
            RowBox[{"CT", "[", 
             RowBox[{"chan", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "chan", "]"}]}], "}"}]}], "]"}], "]"}]}], 
       ";", "\n", "    ", 
       RowBox[{"proba", " ", "=", " ", 
        RowBox[{"Tr", "[", "out", "]"}]}], ";", "\n", "    ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"proba", " ", "==", " ", "0"}], ")"}]}], ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Output state: \>\"", ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"out", "/", "proba"}], ")"}], "//", "MatrixForm"}], ",", 
           " ", "\"\< with probability: \>\"", ",", " ", "proba"}], "]"}]}], 
        "]"}]}]}], "\n", "  ", "]"}]}], "\n", "]"}]}]], "Input",
 CellChangeTimes->{{3.772275535252236*^9, 3.7722755423799963`*^9}, {
  3.7722756572346563`*^9, 
  3.7722756598258*^9}},ExpressionUUID->"1a11ad10-bf23-4614-9dd1-39d907c783bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"PickRandomRho", "[", 
    RowBox[{"2", "^", "3"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772275603314995*^9, 
  3.772275638649222*^9}},ExpressionUUID->"2da782b2-ca78-483e-91b5-\
af4fd6c36255"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InstrumentActionOnRho", "[", 
  RowBox[{"inst", ",", "rho"}], "]"}]], "Input",
 CellChangeTimes->{{3.7722756004337254`*^9, 
  3.772275602378162*^9}},ExpressionUUID->"6d9dbed6-64ae-4f0b-941d-\
8cedaaf22935"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Output state: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.43738401836484786`", 
        RowBox[{"0.07064022709707643`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.13019095703888234`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.07064022709707644`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.13019095703888225`", " ", "\[ImaginaryI]"}]}], 
        "0.562615981635152`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" with probability: \"\>", "\[InvisibleSpace]", 
   "0.36232340872593116`"}],
  SequenceForm["Output state: ", 
   MatrixForm[{{0.43738401836484786`, 
      Complex[0.07064022709707643, 0.13019095703888234`]}, {
      Complex[0.07064022709707644, -0.13019095703888225`], 
      0.562615981635152}}], " with probability: ", 0.36232340872593116`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7722756403258677`*^9, 
  3.772275661292218*^9}},ExpressionUUID->"2a2216e6-c51d-4118-9c94-\
0891303dd2c7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Output state: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.5313264980849335`", 
        RowBox[{
         RowBox[{"-", "0.04103895624039962`"}], "+", 
         RowBox[{"0.0025761740634621336`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.04103895624039962`"}], "-", 
         RowBox[{"0.0025761740634621336`", " ", "\[ImaginaryI]"}]}], 
        "0.46867350191506646`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" with probability: \"\>", "\[InvisibleSpace]", 
   "0.6376765912740687`"}],
  SequenceForm["Output state: ", 
   MatrixForm[{{0.5313264980849335, 
      Complex[-0.04103895624039962, 0.0025761740634621336`]}, {
      Complex[-0.04103895624039962, -0.0025761740634621336`], 
      0.46867350191506646`}}], " with probability: ", 0.6376765912740687],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7722756403258677`*^9, 
  3.772275661294772*^9}},ExpressionUUID->"8800e53a-9a7c-47aa-9888-\
e2bfa79e6823"]
}, Open  ]]
}, Open  ]],

Cell["\<\
We can also generate random instruments. The following gives an instrument \
from 1 qubit to 2 qubits comprising two channels each with 4 Kraus operators\
\>", "Text",
 CellChangeTimes->{{3.772275670886531*^9, 3.7722756761762457`*^9}, {
  3.772275732390933*^9, 3.772275759686459*^9}, {3.772275838531478*^9, 
  3.772275847868588*^9}, {3.772276225901729*^9, 
  3.772276227349914*^9}},ExpressionUUID->"50200bde-217e-482c-bae5-\
80337ad70cb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"inst", "=", 
   RowBox[{"PickRandomInstrument", "[", 
    RowBox[{
     RowBox[{"2", "^", "1"}], ",", 
     RowBox[{"2", "^", "2"}], ",", "2", ",", "4"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7722756781443033`*^9, 3.772275712680604*^9}, {
  3.7722758202145557`*^9, 3.772275820309306*^9}, {3.772276222887329*^9, 
  3.7722762229326468`*^9}},ExpressionUUID->"69832550-2c4d-4ef4-9973-\
e57ca67eec1b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "inst", "]"}]], "Input",
 CellChangeTimes->{{3.772275713891447*^9, 
  3.7722757166636143`*^9}},ExpressionUUID->"879f3755-4d14-4cf0-ae68-\
886c9b23a002"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.772275716979886*^9, 3.772275822022444*^9, 
  3.77227623081503*^9},ExpressionUUID->"b8d6ad8d-127a-4a37-a32f-737ebc36d0f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", " ", 
  RowBox[{"DecInstrumentInQCM", "[", "inst", "]"}]}]], "Input",
 CellChangeTimes->{{3.77227578932651*^9, 
  3.7722757897422*^9}},ExpressionUUID->"311407b3-a08e-43d8-bda6-2ef83e093ecc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.343372207656466`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2.4251497430164775`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.194511104240091`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.445734172773023`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.278747715977881`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.4846051965662315`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.2005274153452072`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.7977394049689973`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.6885661468081674`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.1392061914624314`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.1628571969357635`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.2789811779218672`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2.568615356857197`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.2274696528662101`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.737251387310401`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.8474375150500489`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.240630336944082`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.2978480147096745`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.06832407406956023`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.22130835160380835`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.1399295574951252`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.30403423693139`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.6986655675665792`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.8775211253442878`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4.286766295563139`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.1106536534841345`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.8872819269718591`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.3431613488034491`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "6.218463429247237`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.05971111580353026`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "6.199242544754654`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.40961478472501023`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.463131039723683`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.6084132971579701`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.299062405615827`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.4491968484275071`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.6412884213557644`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.7034494138629198`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.335711411370314`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.239584679817278`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.0995697637865582`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.4948341823988764`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.2495826746174465`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.482915415437894`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.567768856739103`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.17043949848956508`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4.86572189364877`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.17360555551668333`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "6.188889963131921`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.3324112514710118`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.44026707183863595`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.3612910408134296`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.22980136194146`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.2380224196994524`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.537579744657206`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.23007312340965644`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4.912838441033404`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.08076438966199267`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.239726692403874`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.2915421960523832`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.34773729616442123`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "5.539215255010551`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.01635383017716083`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.224362235901322`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.427770490534792`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.080697266506421`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.56903273229134`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.7560044191502924`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.45414279377084604`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.2534617728786794`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.9524747414539245`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.852352575528882`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.6199623128103376`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.0506361291554558`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4.301261541083971`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4.9770671982308645`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.6995876829446273`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.510946654818701`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.9297753563945146`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.0382619406824203`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2.995115526451602`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.5811671402095017`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.1575456749251003`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.39637102207010133`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4.182242353913507`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.866965008466549`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6.273259732055129`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.7642959671402977`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.552932086982533`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.590740827663357`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6.1552001779907135`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.0737343256435259`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.089564671680044`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.3949582970875858`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.2789986109590843`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.1241305847516454`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.13094903320760073`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.558736074920688`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.030086636920458`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.287540288582165`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2.676774148535047`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.491238373277613`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.336136041665888`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.192948827692364`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.102799566686373`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.0959279640031916`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.818926272549181`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6.089692580505568`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.8933614084186354`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.7761801828817771`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.972226908932635`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.4154311443894829`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.9686632883696978`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.13665026501603977`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.596219519439295`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.3118367415346857`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.039234870840142`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.165890967340105`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.4087872166213598`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.664197672535928`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.276993114236088`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.1151040380761055`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.8222570828498273`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.6909180249295206`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.3340998076969347`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.4463617089785115`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.292985533689244`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.2080310672155253`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.3916636165535696`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.14185268638620782`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.463461848688183`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.27705494422362137`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4.873809707279836`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.2203196061652988`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2.2124453809796027`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.926421230600976`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.0487387720553147`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.2747642053048325`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.02838934698417821`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7722758064804173`*^9, 3.77227584233082*^9, 
  3.772276240772203*^9},ExpressionUUID->"7207a000-1bb7-4f29-aeee-\
ae962876a322"]
}, Open  ]],

Cell["The start of the circuit is shown below", "Text",
 CellChangeTimes->{{3.7722759230993853`*^9, 
  3.7722759338599663`*^9}},ExpressionUUID->"c22f08c8-e681-4ed7-98d2-\
5e45e7922b02"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", 
  RowBox[{"Take", "[", 
   RowBox[{"gatelist", ",", "25"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.772275853046832*^9, 3.772275878868548*^9}, {
  3.772276317044334*^9, 
  3.7722763263885193`*^9}},ExpressionUUID->"6a7558c3-054b-4e17-a8a4-\
613869f35495"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {5., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -1.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -1.}, {11., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -1.}, {12., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -1.}, {13., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -5.}, {6., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {10., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -2.}, {11., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {12., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {11., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -2.}, {13., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -5.}, {12., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -3.}, {2., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {3., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -3.}, {4., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {6., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -3.}, {7., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -3.}, {8., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -3.}, {9., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -3.}, {10., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -3.}, {11., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -3.}, {12., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -3.}, {13., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -4.}, {2., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -4.}, {3., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -4.}, {4., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -4.}, {5., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -4.}, {6., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -4.}, {7., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -4.}, {8., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -4.}, {9., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -4.}, {10., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -4.}, {11., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -4.}, {12., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -4.}, {13., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -5.}, {2., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -5.}, {3., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -5.}, {4., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -5.}, {5., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -5.}, {7., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -5.}, {8., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -5.}, {9., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -5.}, {10., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -5.}, {11., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -5.}, {13., -5.}}]}}, {
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -1.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -1.2}, {3.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -1.2}, {5., -0.8}}], 
       LineBox[{{4.8, -1.}, {5.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -1.2}, {6.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -1.2}, {7.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {7., -1.}]}}, 
     {GrayLevel[0], DiskBox[{8., -1.}, 0.1]}, {}, {}, {}, {}, {}, 
     {GrayLevel[0], DiskBox[{5., -5.}, 0.1]}, 
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -2.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -2.2}, {3.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -2.2}, {4.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -2.}]}}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{8., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{8., -2.2}, {8., -1.8}}], 
       LineBox[{{7.8, -2.}, {8.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -2.2}, {9.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -2.2}, {10.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {10., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{11., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{11., -2.2}, {11., -1.8}}], 
       LineBox[{{10.8, -2.}, {11.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{11.8, -2.2}, {12.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {12., -2.}]}}, {}, 
     {GrayLevel[0], DiskBox[{11., -5.}, 0.1]}, 
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -3.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -3.2}, {2.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -3.2}, {3.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -3.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -3.2}, {4.2, -2.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"Rz\"\>", {4., -3.}]}}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, 
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -4.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -4.2}, {2.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -4.2}, {3.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -4.2}, {4.2, -3.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"Rz\"\>", {4., -4.}]}}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -5.2}, {2.2, -4.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"Rz\"\>", {2., -5.}]}}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJx10UEKgiEURWFp9IZv4MCBAxMRcRPVFlpC0Lgl1pJaQkXe4D+QII9PHHhw
f7mdr7sQwum9P/O7noc17+vguLXBDkc4wRkucIUb3OEBzz/viY9tX1hWn2yw
wxFOcIYLXOEGd3jAE9Z99tmy+mSDHY5wgjNc4Ao3uMMDnrB6fFk9ssEORzjB
GS5whRvc4QFPWD36L/XIBjuc4AwXuMINHvD8+QUBslwv
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{607., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.7722758578889503`*^9, 3.772275879074583*^9}, 
   3.772276245989415*^9, {3.772276317356183*^9, 
   3.772276326663118*^9}},ExpressionUUID->"40dc58df-0b11-4b81-afcd-\
510ffbefffa9"]
}, Open  ]],

Cell["And here is the end of the circuit", "Text",
 CellChangeTimes->{{3.7722759369471407`*^9, 
  3.772275942274782*^9}},ExpressionUUID->"73e441dc-374b-401e-bd9a-\
d59ebb4bb20f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", 
  RowBox[{"Take", "[", 
   RowBox[{"gatelist", ",", 
    RowBox[{"-", "10"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7722758890122232`*^9, 3.772275909580124*^9}, {
  3.772276257630515*^9, 3.772276261997135*^9}, {3.772276305461911*^9, 
  3.7722763113633823`*^9}},ExpressionUUID->"980c117e-2904-411a-9aca-\
cded303f3536"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], LineBox[{{2., -0.95}, {3., -0.95}}], 
      LineBox[{{2., -1.05}, {3., -1.05}}]}, 
     {GrayLevel[0], LineBox[{{3., -0.95}, {4., -0.95}}], 
      LineBox[{{3., -1.05}, {4., -1.05}}]}, 
     {GrayLevel[0], LineBox[{{4., -0.95}, {5., -0.95}}], 
      LineBox[{{4., -1.05}, {5., -1.05}}]}, 
     {GrayLevel[0], LineBox[{{5., -0.95}, {6., -0.95}}], 
      LineBox[{{5., -1.05}, {6., -1.05}}]}, 
     {GrayLevel[0], LineBox[{{6., -0.95}, {7., -0.95}}], 
      LineBox[{{6., -1.05}, {7., -1.05}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[1], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -3.}, {2., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -3.}, {3., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -3.}, {4., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -3.}, {5., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -3.}, {6., -3.}}]}, 
     {GrayLevel[1], Thickness[Large], LineBox[{{6., -3.}, {7., -3.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -4.}, {2., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -4.}, {3., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -4.}, {2., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -4.}, {4., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -4.}, {5., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -4.}, {6., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -4.}, {7., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -5.}, {3., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -5.}, {2., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -5.}, {4., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -5.}, {5., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -5.}, {6., -5.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -5.}, {5., -4.}}]}, 
     {GrayLevel[0], Thickness[Large], 
      LineBox[{{6., -5.}, {7., -5.}}]}}, {{}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"Mmt\"\>", {2., -1.}]}}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -2.2}, {6.2, -1.8}], 
      {GrayLevel[0], 
       InsetBox["\<\"Tr\"\>", {6., -2.}]}}, {}, {}, {}, {}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -3.2}, {6.2, -2.8}], 
      {GrayLevel[0], InsetBox["\<\"Tr\"\>", {6., -3.}]}}, {}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{2., -4.}, 0.2], 
      {GrayLevel[0], LineBox[{{2., -4.2}, {2., -3.8}}], 
       LineBox[{{1.8, -4.}, {2.2, -4.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -4.2}, {3.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -4.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -4.2}, {4.2, -3.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {4., -4.}]}}, 
     {GrayLevel[0], DiskBox[{5., -4.}, 0.1]}, {}, {}, 
     {GrayLevel[0], DiskBox[{2., -5.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -5.2}, {3.2, -4.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -5.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -5.2}, {4.2, -4.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -5.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -5.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -5.2}, {5., -4.8}}], 
       LineBox[{{4.8, -5.}, {5.2, -5.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -5.2}, {6.2, -4.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {6., -5.}]}}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxdzbEJgEAMQNFglTJFihRpxEF0BkcQrB1RR3IEFS+C/+AILwf3+2Wb105E
hvs+8z3n2ObeFtPfChvscMAJV0+Of6+ssMEOB5xw9RS9ssIGOxxwwtUz9MoK
G+xwwAnX/45+WfFusMMB5+cL3X4zGQ==
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{390., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.772275889345565*^9, 3.772275909877503*^9}, {
  3.772276247799025*^9, 3.772276262246739*^9}, {3.7722763067511683`*^9, 
  3.772276311691022*^9}},ExpressionUUID->"82f76bdc-0522-4f0a-817b-\
bc7156cd4699"]
}, Open  ]],

Cell["To get back the instrument", "Text",
 CellChangeTimes->{{3.772275948914851*^9, 
  3.772275957699253*^9}},ExpressionUUID->"bf7c4511-8747-463a-bf59-\
217332110a0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"instout", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.772275960000885*^9, 
  3.7722759951873817`*^9}},ExpressionUUID->"0849ed08-042c-404e-ac88-\
addbeac5dfd1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "instout", "]"}]], "Input",
 CellChangeTimes->{{3.772275997971705*^9, 
  3.7722760025304937`*^9}},ExpressionUUID->"be8f5b4d-86d4-41eb-ab4b-\
429579f36a12"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.772276002829319*^9, 
  3.77227634465618*^9},ExpressionUUID->"79f12447-d235-4988-8884-363f1b132979"]
}, Open  ]],

Cell["\<\
To check these are the same instrument we can extract the individual channels \
and confirm that they have the same Choi states:\
\>", "Text",
 CellChangeTimes->{{3.772276009313925*^9, 3.772276023601997*^9}, {
  3.772276077880568*^9, 
  3.772276090808182*^9}},ExpressionUUID->"1f315442-c8e6-4c6b-b52f-\
910fd81fcaef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"chan1", ",", "chan2"}], "}"}], "=", "inst"}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"chanout1", ",", "chanout2"}], "}"}], "=", "instout"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.772276027453226*^9, 
  3.772276048305599*^9}},ExpressionUUID->"8da1ad8c-5cc8-415a-a2dd-\
93ce2bb1d9cc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"KrausToChoi", "[", "chan1", "]"}], "-", 
   RowBox[{"KrausToChoi", "[", "chanout1", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772276050244372*^9, 
  3.772276065137001*^9}},ExpressionUUID->"d065c1e2-9741-47dd-b6f4-\
7d11380010f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.772276065453532*^9, 
  3.7722763470266333`*^9},ExpressionUUID->"ff823c27-e4c2-42c4-860e-\
40a4347e74e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"KrausToChoi", "[", "chan2", "]"}], "-", 
   RowBox[{"KrausToChoi", "[", "chanout2", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772276072672721*^9, 
  3.772276074206986*^9}},ExpressionUUID->"38e50b46-df69-4676-aa02-\
3efe13f3e490"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.77227607439438*^9, 
  3.7722763484747343`*^9},ExpressionUUID->"84c1d7a7-2ea6-45d2-97f6-\
94d07352eb48"]
}, Open  ]],

Cell["\<\
We can also observe the same action on a randomly chosen input\
\>", "Text",
 CellChangeTimes->{{3.772276387858491*^9, 
  3.772276403146358*^9}},ExpressionUUID->"a4601121-e6f4-45ee-94a0-\
293864477b6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"PickRandomRho", "[", "2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772276372235304*^9, 
  3.7722763723872137`*^9}},ExpressionUUID->"818fb037-97f6-4cf2-822e-\
18489a3c399a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InstrumentActionOnRho", "[", 
  RowBox[{"inst", ",", "rho"}], "]"}]], "Input",ExpressionUUID->"d81ba6f7-\
8524-415b-bbc1-a7c3425a8e96"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Output state: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.1090746149777163`", 
        RowBox[{"0.06058158467744051`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.03144885091625294`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.05491659072697394`"}], "+", 
         RowBox[{"0.05397023738294961`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.01650137819958981`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.06266662788476188`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.06058158467744051`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.03144885091625294`", " ", "\[ImaginaryI]"}]}], 
        "0.21726901416557526`", 
        RowBox[{
         RowBox[{"-", "0.12019021447681211`"}], "-", 
         RowBox[{"0.08731994653513844`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.07078720722054688`"}], "+", 
         RowBox[{"0.06368278151817673`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.05491659072697395`"}], "-", 
         RowBox[{"0.053970237382949614`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.12019021447681211`"}], "+", 
         RowBox[{"0.08731994653513844`", " ", "\[ImaginaryI]"}]}], 
        "0.337591187260298`", 
        RowBox[{"0.1263359190836503`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.20074645826247023`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.016501378199589804`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.06266662788476188`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.07078720722054686`"}], "-", 
         RowBox[{"0.06368278151817673`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.1263359190836503`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.20074645826247028`", " ", "\[ImaginaryI]"}]}], 
        "0.3360651835964105`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" with probability: \"\>", "\[InvisibleSpace]", 
   "0.37543090096094833`"}],
  SequenceForm["Output state: ", 
   MatrixForm[{{0.1090746149777163, 
      Complex[0.06058158467744051, -0.03144885091625294], 
      Complex[-0.05491659072697394, 0.05397023738294961], 
      Complex[0.01650137819958981, 0.06266662788476188]}, {
      Complex[0.06058158467744051, 0.03144885091625294], 0.21726901416557526`, 
      Complex[-0.12019021447681211`, -0.08731994653513844], 
      Complex[-0.07078720722054688, 0.06368278151817673]}, {
      Complex[-0.05491659072697395, -0.053970237382949614`], 
      Complex[-0.12019021447681211`, 0.08731994653513844], 0.337591187260298, 
      
      Complex[0.1263359190836503, -0.20074645826247023`]}, {
      Complex[0.016501378199589804`, -0.06266662788476188], 
      Complex[-0.07078720722054686, -0.06368278151817673], 
      Complex[0.1263359190836503, 0.20074645826247028`], 
      0.3360651835964105}}], " with probability: ", 0.37543090096094833`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.772276374281054*^9},ExpressionUUID->"775199f1-1074-4e56-9ca5-\
3773b4e5a330"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Output state: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.19008490568591677`", 
        RowBox[{
         RowBox[{"-", "0.0767030866789163`"}], "+", 
         RowBox[{"0.11152623457471529`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.05722491719325763`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.05095821401411998`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.0060106370511532545`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.1680523457564394`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.07670308667891629`"}], "-", 
         RowBox[{"0.1115262345747153`", " ", "\[ImaginaryI]"}]}], 
        "0.24404948691015022`", 
        RowBox[{"0.004457296771951868`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.06089089030272766`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.10897961538996342`"}], "+", 
         RowBox[{"0.06347012121351008`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.05722491719325763`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.05095821401411997`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.004457296771951871`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.06089089030272766`", " ", "\[ImaginaryI]"}]}], 
        "0.08744781098496365`", 
        RowBox[{
         RowBox[{"-", "0.027174858897676096`"}], "+", 
         RowBox[{"0.030301199010317054`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.006010637051153248`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.1680523457564394`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.10897961538996347`"}], "-", 
         RowBox[{"0.06347012121351009`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.027174858897676107`"}], "-", 
         RowBox[{"0.030301199010317036`", " ", "\[ImaginaryI]"}]}], 
        "0.4784177964189694`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" with probability: \"\>", "\[InvisibleSpace]", 
   "0.6245690990390522`"}],
  SequenceForm["Output state: ", 
   MatrixForm[{{0.19008490568591677`, 
      Complex[-0.0767030866789163, 0.11152623457471529`], 
      Complex[0.05722491719325763, 0.05095821401411998], 
      Complex[0.0060106370511532545`, -0.1680523457564394]}, {
      Complex[-0.07670308667891629, -0.1115262345747153], 
      0.24404948691015022`, 
      Complex[0.004457296771951868, -0.06089089030272766], 
      Complex[-0.10897961538996342`, 0.06347012121351008]}, {
      Complex[0.05722491719325763, -0.05095821401411997], 
      Complex[0.004457296771951871, 0.06089089030272766], 0.08744781098496365, 
      Complex[-0.027174858897676096`, 0.030301199010317054`]}, {
      Complex[0.006010637051153248, 0.1680523457564394], 
      Complex[-0.10897961538996347`, -0.06347012121351009], 
      Complex[-0.027174858897676107`, -0.030301199010317036`], 
      0.4784177964189694}}], " with probability: ", 0.6245690990390522],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.772276374283965*^9},ExpressionUUID->"1b7bfcb0-db95-41f9-a86f-\
ed18c75dfa7e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InstrumentActionOnRho", "[", 
  RowBox[{"instout", ",", "rho"}], "]"}]], "Input",
 CellChangeTimes->{{3.772276380395322*^9, 
  3.7722763805773897`*^9}},ExpressionUUID->"a0cfa003-1912-489f-ad7b-\
a7e453ea6bf4"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Output state: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.10907461497772233`", 
        RowBox[{"0.06058158467743791`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.03144885091625471`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.05491659072697455`"}], "+", 
         RowBox[{"0.05397023738295622`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.01650137819959005`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.06266662788476952`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.06058158467743793`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.03144885091625471`", " ", "\[ImaginaryI]"}]}], 
        "0.21726901416557357`", 
        RowBox[{
         RowBox[{"-", "0.12019021447680452`"}], "-", 
         RowBox[{"0.08731994653513331`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.07078720722054613`"}], "+", 
         RowBox[{"0.06368278151817837`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.054916590726974565`"}], "-", 
         RowBox[{"0.05397023738295621`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.1201902144768045`"}], "+", 
         RowBox[{"0.08731994653513331`", " ", "\[ImaginaryI]"}]}], 
        "0.33759118726028553`", 
        RowBox[{"0.12633591908365024`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.20074645826246698`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.01650137819959004`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.06266662788476951`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.07078720722054614`"}], "-", 
         RowBox[{"0.06368278151817837`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.12633591908365024`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.20074645826246698`", " ", "\[ImaginaryI]"}]}], 
        "0.3360651835964188`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" with probability: \"\>", "\[InvisibleSpace]", 
   "0.3754309009609257`"}],
  SequenceForm["Output state: ", 
   MatrixForm[{{0.10907461497772233`, 
      Complex[0.06058158467743791, -0.03144885091625471], 
      Complex[-0.05491659072697455, 0.05397023738295622], 
      Complex[0.01650137819959005, 0.06266662788476952]}, {
      Complex[0.06058158467743793, 0.03144885091625471], 0.21726901416557357`, 
      Complex[-0.12019021447680452`, -0.08731994653513331], 
      Complex[-0.07078720722054613, 0.06368278151817837]}, {
      Complex[-0.054916590726974565`, -0.05397023738295621], 
      Complex[-0.1201902144768045, 0.08731994653513331], 0.33759118726028553`, 
      Complex[0.12633591908365024`, -0.20074645826246698`]}, {
      Complex[0.01650137819959004, -0.06266662788476951], 
      Complex[-0.07078720722054614, -0.06368278151817837], 
      Complex[0.12633591908365024`, 0.20074645826246698`], 
      0.3360651835964188}}], " with probability: ", 0.3754309009609257],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7722763808347197`*^9},ExpressionUUID->"815e4945-d1e4-4956-bd1f-\
3696e46139c5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Output state: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.1900849056859264`", 
        RowBox[{
         RowBox[{"-", "0.07670308667892045`"}], "+", 
         RowBox[{"0.11152623457472345`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.05722491719325038`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.05095821401412004`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.00601063705114817`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.16805234575645034`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.07670308667892047`"}], "-", 
         RowBox[{"0.11152623457472345`", " ", "\[ImaginaryI]"}]}], 
        "0.24404948691014744`", 
        RowBox[{"0.0044572967719546325`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.060890890302719505`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.10897961538996764`"}], "+", 
         RowBox[{"0.06347012121351689`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.057224917193250374`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.050958214014120054`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.004457296771954624`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.06089089030271952`", " ", "\[ImaginaryI]"}]}], 
        "0.08744781098495295`", 
        RowBox[{
         RowBox[{"-", "0.027174858897687424`"}], "+", 
         RowBox[{"0.030301199010319184`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.006010637051148181`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.16805234575645034`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.10897961538996764`"}], "-", 
         RowBox[{"0.06347012121351692`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.027174858897687428`"}], "-", 
         RowBox[{"0.03030119901031916`", " ", "\[ImaginaryI]"}]}], 
        "0.47841779641897314`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], 
   "\[InvisibleSpace]", "\<\" with probability: \"\>", "\[InvisibleSpace]", 
   "0.6245690990390754`"}],
  SequenceForm["Output state: ", 
   MatrixForm[{{0.1900849056859264, 
      Complex[-0.07670308667892045, 0.11152623457472345`], 
      Complex[0.05722491719325038, 0.05095821401412004], 
      Complex[0.00601063705114817, -0.16805234575645034`]}, {
      Complex[-0.07670308667892047, -0.11152623457472345`], 
      0.24404948691014744`, 
      Complex[0.0044572967719546325`, -0.060890890302719505`], 
      Complex[-0.10897961538996764`, 0.06347012121351689]}, {
      Complex[0.057224917193250374`, -0.050958214014120054`], 
      Complex[0.004457296771954624, 0.06089089030271952], 0.08744781098495295, 
      Complex[-0.027174858897687424`, 0.030301199010319184`]}, {
      Complex[0.006010637051148181, 0.16805234575645034`], 
      Complex[-0.10897961538996764`, -0.06347012121351692], 
      Complex[-0.027174858897687428`, -0.03030119901031916], 
      0.47841779641897314`}}], " with probability: ", 0.6245690990390754],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.772276380836924*^9},ExpressionUUID->"b1328b7b-c889-4e7d-95e5-\
cd61c033dd10"]
}, Open  ]]
}, Open  ]],

Cell["\<\
To generate an instrument from 1 qubit to 2 comprising three channels with 1, \
2 and 3 Kraus operators, use\
\>", "Text",
 CellChangeTimes->{{3.772444643150165*^9, 
  3.772444673197764*^9}},ExpressionUUID->"5e31c386-0db1-470d-a98d-\
1f972eac40b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"inst", "=", 
  RowBox[{"PickRandomInstrument", "[", 
   RowBox[{
    RowBox[{"2", "^", "1"}], ",", 
    RowBox[{"2", "^", "2"}], ",", "3", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7724446760695*^9, 
  3.772444681069148*^9}},ExpressionUUID->"12b8af5b-536f-41bd-8e1b-\
786e02d89319"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.1404544651156617`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.044118151595412575`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{"0.06559390906110829`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.08179061122591598`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.21758276584454195`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.008541009269815214`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "0.40825796069460096`"}], "+", 
         RowBox[{"0.059292238490387936`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.21737818950741067`"}], "+", 
         RowBox[{"0.03360612249453836`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{"0.014430569859986277`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.14899574704672136`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.005362851672860505`"}], "-", 
         RowBox[{"0.007812885864519004`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "0.21417364920350448`"}], "+", 
         RowBox[{"0.23666772664932004`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
     "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.03472529406912219`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.020025497449840796`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.01536715618700554`"}], "-", 
          RowBox[{"0.029971486177080696`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.03458391801412672`"}], "-", 
          RowBox[{"0.0714902695788607`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.19868588890269587`"}], "-", 
          RowBox[{"0.1589649019703293`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.04854926627928756`"}], "+", 
          RowBox[{"0.13604192256469105`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.1349235688040448`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.10872855960588867`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.019318048676247167`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.08167698434063142`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.12339422421659837`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.0934527684345745`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.014334276251718209`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.031596401201892874`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.09384823435193741`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.09737064978629585`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.1371727474098563`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.2043804345021329`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.14152904119465237`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.16010390936842725`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.09960379054416757`"}], "-", 
          RowBox[{"0.04332459269061528`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.05106805937075799`"}], "+", 
          RowBox[{"0.07261515564940077`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.1501416087496996`"}], "-", 
          RowBox[{"0.12106636384881693`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.17901115613746224`"}], "+", 
          RowBox[{"0.05007372320628127`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.23317374623461956`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.07730650592421974`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.1754730875239821`"}], "-", 
          RowBox[{"0.05966837997020294`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.24422137145145803`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.2948313882063135`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.13069535743030575`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.07276782719503014`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.21122177218547622`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.10318801113488288`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.006145747491593863`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.22130764749126358`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.24080935152069738`"}], "-", 
          RowBox[{"0.12009764642065819`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.012768722718853175`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.06083237911688941`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.39692373869565944`"}], "-", 
          RowBox[{"0.24223495666291206`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.024625137767817468`"}], "-", 
          RowBox[{"0.04876348134494754`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.027301123670016456`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.051455754262105094`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.12080393576309734`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.1461910809282107`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.0033746161774635894`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.047512245969829905`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.15460149026691983`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.10119466784162498`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.08955670738352237`"}], "+", 
          RowBox[{"0.26470353755433873`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.25422284855203925`"}], "+", 
          RowBox[{"0.04033841732665497`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.02591025606676718`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.03470152264635695`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.04254449998883742`"}], "+", 
          RowBox[{"0.015598789420544124`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.09737260500554148`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.16255606335253026`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.010239646000616914`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.14319370898905204`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.045422046265269855`"}], "-", 
          RowBox[{"0.1969120126546936`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.04293533862741927`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.3283875503157578`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.07773626341616988`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.12883206246799375`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.17348110599514371`"}], "-", 
          RowBox[{"0.23849869360939308`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
       "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.772444944093594*^9},ExpressionUUID->"2a77897b-3f82-4a47-b040-\
1e42ec1d6a78"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7722754648992863`*^9, 
  3.7722754652284803`*^9}},ExpressionUUID->"700deee8-4a14-4212-9a43-\
4768e144c8ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conversion to another gate library", "Subsection",
 CellChangeTimes->{{3.759144870438723*^9, 3.75914487477429*^9}, {
  3.7643275991878977`*^9, 
  3.764327604619854*^9}},ExpressionUUID->"cc58800c-d2e6-4ba9-9b25-\
b6294a95bd73"],

Cell["\<\
We can convert to another universal gate library comprising the \
Molmer-Sorensen gate (XX) and a two-parameter single qubit gate (RGate):\
\>", "Text",
 CellChangeTimes->{{3.758172676685297*^9, 3.758172722779386*^9}, {
  3.764327620843363*^9, 3.764327629675152*^9}, {3.764327668026601*^9, 
  3.7643277010260267`*^9}},ExpressionUUID->"4215a611-3e90-477c-877e-\
ef3de95f4075"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gatelist", "=", 
   RowBox[{"DecPOVMInQCM", "[", "POVM", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.825515531972439*^9, 3.8255155385762253`*^9}},
 CellLabel->
  "In[1019]:=",ExpressionUUID->"c3a18004-c15c-4882-9a15-d4a66526d514"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"XXM", "[", "t", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.764327702832716*^9, 3.764327719513566*^9}, {
  3.7643285136679068`*^9, 3.764328522641121*^9}},
 CellLabel->
  "In[1020]:=",ExpressionUUID->"84e473cc-fe05-4694-add2-81039a4c09b1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "t", "]"}], "0", "0", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"Sin", "[", "t", "]"}]}]},
     {"0", 
      RowBox[{"Cos", "[", "t", "]"}], 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], 
      RowBox[{"Cos", "[", "t", "]"}], "0"},
     {
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], "0", "0", 
      RowBox[{"Cos", "[", "t", "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.764328441374868*^9, {3.764328515407353*^9, 3.764328522890855*^9}, 
   3.7647826101738234`*^9, 3.764783538778781*^9, 3.825515552263769*^9},
 CellLabel->
  "Out[1020]//MatrixForm=",ExpressionUUID->"59a8ba55-411a-4b7d-9918-\
3c077a8b8dfc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RGateM", "[", 
   RowBox[{"t", ",", "p"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.764327709615464*^9, 3.7643277224972563`*^9}, {
  3.764328517971599*^9, 3.764328525748275*^9}},
 CellLabel->
  "In[1021]:=",ExpressionUUID->"d9b0051c-355e-498a-a3b4-a25fc0ba7028"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["t", "2"], "]"}], 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "p"}]], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["t", "2"], "]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "p"}]], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["t", "2"], "]"}]}], 
      RowBox[{"Cos", "[", 
       FractionBox["t", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.76432844141348*^9, {3.764328518358721*^9, 3.7643285265384808`*^9}, 
   3.764782610189871*^9, 3.764783538803335*^9, 3.825515552327836*^9},
 CellLabel->
  "Out[1021]//MatrixForm=",ExpressionUUID->"9f1f91fe-220d-4b94-b956-\
5ea0be7f6d07"]
}, Open  ]],

Cell["To convert an existing gatelist to the new gates, use:", "Text",
 CellChangeTimes->{{3.7643283767081747`*^9, 
  3.764328388476055*^9}},ExpressionUUID->"cd9efcbc-7127-44e9-bf66-\
637e75ceccd0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelistXX", "=", 
  RowBox[{"CNOTRotationsToXXRGates", "[", "gatelist", "]"}]}]], "Input",
 CellChangeTimes->{{3.764327742653604*^9, 3.764327773408379*^9}},
 CellLabel->
  "In[1022]:=",ExpressionUUID->"d2d0c1c5-95b2-4c4f-9875-370b7a6cc999"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.5707963267948952`"}], ",", "0"}], "}"}], ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.780368411378612`", ",", 
       RowBox[{"-", "1.5707963267948966`"}]}], "}"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.794213192553684`", ",", "0"}], "}"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.666727960906079`", ",", 
       RowBox[{"-", "2.3028333672778794`"}]}], "}"}], ",", "2"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"6.1019068245291255`", ",", "0"}], "}"}], ",", "3"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.679879760557521`", ",", 
       RowBox[{"-", "1.7491674900052052`"}]}], "}"}], ",", "3"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Pi]", ",", "0"}], "}"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["\[Pi]", "2"], ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}]}], "}"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", 
     FractionBox["\[Pi]", "4"], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.141592653589793`", ",", 
       RowBox[{"-", "1.5707963267948966`"}]}], "}"}], ",", "2"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "\[Pi]"}], ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}]}], "}"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", 
     FractionBox["\[Pi]", "4"], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.6869533265602799`", ",", 
       RowBox[{"-", "1.2426679738118267`"}]}], "}"}], ",", "2"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Pi]", ",", "0"}], "}"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", 
     FractionBox["\[Pi]", "4"], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.71238898038469`", ",", 
       RowBox[{"-", "1.5707963267948966`"}]}], "}"}], ",", "1"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.689621061210106`", ",", 
       RowBox[{"-", "2.31664898756797`"}]}], "}"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", 
     FractionBox["\[Pi]", "4"], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.5448152368004444`", ",", 
       RowBox[{"-", "2.4076563827820068`"}]}], "}"}], ",", "2"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.1415926535897913`", ",", 
       RowBox[{"-", "0.19634954084936332`"}]}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", 
     FractionBox["\[Pi]", "4"], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Pi]", ",", 
       RowBox[{"-", "\[Pi]"}]}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "\[Pi]"}], ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}]}], "}"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", 
     FractionBox["\[Pi]", "4"], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.8049872056277616`", ",", 
       RowBox[{"-", "2.9084104801220976`"}]}], "}"}], ",", "2"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["\[Pi]", "2"], ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}]}], "}"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", 
     FractionBox["\[Pi]", "4"], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Pi]", ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "4"]}]}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "\[Pi]"}], ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}]}], "}"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", 
     FractionBox["\[Pi]", "4"], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"5.497787143782139`", ",", 
       RowBox[{"-", "3.141592653589793`"}]}], "}"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["\[Pi]", "2"], ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}]}], "}"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10"}], ",", 
     FractionBox["\[Pi]", "4"], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.7177715174584023`", ",", 
       RowBox[{"-", "1.9362860827630892`"}]}], "}"}], ",", "2"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["\[Pi]", "2"], ",", 
       RowBox[{"-", 
        FractionBox["\[Pi]", "2"]}]}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.764328447307827*^9, 3.7643285296697197`*^9, 
  3.764782610243643*^9, 3.764783538857438*^9, 3.825515553280938*^9},
 CellLabel->
  "Out[1022]=",ExpressionUUID->"9f93d70c-94a8-4f49-8877-4cb341d3b121"]
}, Open  ]],

Cell["Check that this is the same POVM:", "Text",
 CellChangeTimes->{{3.764328392995805*^9, 
  3.764328399587734*^9}},ExpressionUUID->"49f302f2-913b-4842-8750-\
773969d3ba28"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"POVM2", "=", 
  RowBox[{"Chop", "[", 
   RowBox[{"CreatePOVMFromGateList", "[", "gatelistXX", "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.764327857555464*^9, 3.764327883894383*^9}, {
  3.764328536931583*^9, 3.7643285384271393`*^9}},
 CellLabel->
  "In[1023]:=",ExpressionUUID->"7046162f-5c34-4f33-b049-72f249c9ddf7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.6913417161825436`", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.46193976625564176`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0.30865828381745364`", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.4619397662556417`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0.30865828381745375`", ",", "0", ",", "0", ",", 
       "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.46193976625564204`", " ", "\[ImaginaryI]"}]}], ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0.6913417161825443`", ",", "0", ",", "0",
        ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.4619397662556418`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.46193976625564176`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.3086582838174535`", ",", "0", ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.4619397662556417`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.6913417161825434`", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.46193976625564204`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.691341716182544`", ",", "0"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.4619397662556418`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.3086582838174533`"}], "}"}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.3086582838174535`", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.4619397662556418`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0.6913417161825437`", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.46193976625564187`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0.691341716182544`", ",", "0", ",", "0", ",", "0", 
       ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.4619397662556418`", " ", "\[ImaginaryI]"}]}], ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0.3086582838174535`", ",", "0", ",", "0",
        ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.4619397662556418`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.4619397662556418`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.6913417161825437`", ",", "0", ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.46193976625564187`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.30865828381745364`", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.4619397662556418`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.30865828381745336`", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.4619397662556418`", " ", "\[ImaginaryI]"}]}], ",", "0", 
       ",", "0", ",", "0", ",", "0.6913417161825439`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.764328494060211*^9, {3.764328532230455*^9, 3.764328538725515*^9}, 
   3.764782610272788*^9, 3.764783538888085*^9, 3.825515555666545*^9},
 CellLabel->
  "Out[1023]=",ExpressionUUID->"ee28edc2-1699-49e9-ad71-2ced76f55311"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"Chop", "[", 
   RowBox[{"POVM2", "-", "POVM"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.764327909981744*^9, 3.764327913957563*^9}, {
  3.764328544618805*^9, 3.764328547130732*^9}},
 CellLabel->
  "In[1024]:=",ExpressionUUID->"ab01a3eb-1140-4d71-a258-e6470f6b185a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7643284941243773`*^9, {3.764328541418445*^9, 3.764328547406437*^9}, 
   3.7647826102902603`*^9, 3.764783538913801*^9, 3.82551555723759*^9},
 CellLabel->
  "Out[1024]=",ExpressionUUID->"6b8b736d-3a12-4dc6-b9c2-b2fd22f6ca27"]
}, Open  ]],

Cell["We can also convert back ", "Text",
 CellChangeTimes->{{3.764328403883727*^9, 
  3.764328407196267*^9}},ExpressionUUID->"8438b83f-e21c-4954-a005-\
a3955ac218e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelistback", "=", 
  RowBox[{"XXRGatesToCNOTRotations", "[", "gatelistXX", "]"}]}]], "Input",
 CellChangeTimes->{{3.7643285551393747`*^9, 3.764328580178335*^9}},
 CellLabel->
  "In[1025]:=",ExpressionUUID->"76a8cad4-567d-4e00-993f-35a5d0844b0c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\[Pi]", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\[Pi]", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.3228711362402534`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6.23786568651697`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.9181757878310057`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.712388980384691`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.06797943099392223`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.5707963267948966`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.712388980384688`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\[Pi]", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.935805846143477`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.5254767061322814`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4.712388980384691`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.5707963267948977`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.5707963267948957`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.5707963267948968`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.570796326794898`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.3895178441444365`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.1415926535897922`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.5707963267948966`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5.890486225480858`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.181278482650476`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.1415926535897953`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\[Pi]", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\[Pi]", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["\[Pi]", "2"], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\[Pi]", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.570796326794899`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.3926990816987242`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\[Pi]", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.764328567732373*^9, 3.76432858080221*^9}, 
   3.764782610662716*^9, 3.7647835392739563`*^9, 3.825515559148278*^9},
 CellLabel->
  "Out[1025]=",ExpressionUUID->"c12c409e-3407-4e56-9e3f-54ad9772da7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"CreatePOVMFromGateList", "[", "gatelistback", "]"}], "-", 
   "POVM"}], "]"}]], "Input",
 CellChangeTimes->{{3.764328583850217*^9, 3.764328593617076*^9}},
 CellLabel->
  "In[1026]:=",ExpressionUUID->"49527cc0-2103-469a-8be4-2880e5a5b2ea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.764328585198666*^9, 3.7643285942882013`*^9}, 
   3.764782610679401*^9, 3.7647835392988443`*^9, 3.8255155603585052`*^9},
 CellLabel->
  "Out[1026]=",ExpressionUUID->"41687950-5624-4d67-8b99-7354c8abe12c"]
}, Open  ]],

Cell["\<\
Note that this conversion changes the actual list in general, although the \
operation remains the same:\
\>", "Text",
 CellChangeTimes->{{3.764328651792163*^9, 
  3.764328675415701*^9}},ExpressionUUID->"d4155794-b866-4607-b5aa-\
4ab58e17ac1c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "gatelistback", "]"}]], "Input",
 CellChangeTimes->{{3.764328608273581*^9, 3.764328642017293*^9}},
 CellLabel->
  "In[1027]:=",ExpressionUUID->"0e4d7920-d373-4768-841f-acb74d5e6e5c"],

Cell[BoxData["44"], "Output",
 CellChangeTimes->{{3.7643286145373287`*^9, 3.7643286423944798`*^9}, 
   3.764782610695253*^9, 3.764783539323414*^9, 3.8255155634459257`*^9},
 CellLabel->
  "Out[1027]=",ExpressionUUID->"1f1158e9-e1dd-4a16-9b54-07985cfe10d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "gatelist", "]"}]], "Input",
 CellChangeTimes->{3.764328647088678*^9},
 CellLabel->
  "In[1028]:=",ExpressionUUID->"756aa10c-b67a-4af8-9305-bf8a42fe1026"],

Cell[BoxData["28"], "Output",
 CellChangeTimes->{3.764328647421229*^9, 3.764782610710724*^9, 
  3.76478353934695*^9, 3.8255155647630367`*^9},
 CellLabel->
  "Out[1028]=",ExpressionUUID->"69e8dcf5-4787-487c-afe7-911b0eb66a9e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ordering issues", "Subsection",
 CellChangeTimes->{{3.759144870438723*^9, 
  3.75914487477429*^9}},ExpressionUUID->"8d011033-fc73-4a7b-8081-\
e4bfa35d7494"],

Cell[CellGroupData[{

Cell["Controlled gates", "Subsubsection",
 CellChangeTimes->{{3.759145000235243*^9, 
  3.759145006523197*^9}},ExpressionUUID->"575ad80e-2d28-4e81-9d15-\
ea00f1ed432b"],

Cell["\<\
One has to be careful about gate ordering for controlled gates\
\>", "Text",
 CellChangeTimes->{{3.758172676685297*^9, 
  3.758172722779386*^9}},ExpressionUUID->"de31ad5d-2176-4e95-8c2a-\
31c8ace7fab6"],

Cell["\<\
Let\[CloseCurlyQuote]s create a gate with qubits 1 and 2 as two controls and \
qubit 3 as target.\
\>", "Text",
 CellChangeTimes->{{3.7581727299120893`*^9, 3.758172751125247*^9}, {
  3.758172896395768*^9, 
  3.758172910401566*^9}},ExpressionUUID->"ed459353-329a-4adb-a61a-\
efe874446503"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UCG", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"CreateUCG", "[", 
     RowBox[{
      RowBox[{"ucgates", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RxM", "[", 
          RowBox[{
           RowBox[{"\[Pi]", "/", "2"}], ",", "1"}], "]"}], ",", 
         RowBox[{"RzM", "[", 
          RowBox[{
           RowBox[{"\[Pi]", "/", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{"RyM", "[", 
          RowBox[{
           RowBox[{"\[Pi]", "/", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "3", ",", "3"}], "]"}], "]"}]}], 
  ";", 
  RowBox[{"UCG", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.7581727047429457`*^9, 3.75817270589784*^9}, {
  3.7581727634911537`*^9, 3.7581728878312693`*^9}, {3.7581729316125383`*^9, 
  3.758173030148096*^9}, {3.759144856575536*^9, 3.7591448634309597`*^9}, {
  3.759392576967057*^9, 
  3.759392586251047*^9}},ExpressionUUID->"aa94ecc9-3bb6-4cbd-8fdb-\
2b1d3dddbdd6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "8"}]], "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"7", "/", "8"}]]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Pi]", "8"], "]"}], 
      RowBox[{"Sin", "[", 
       FractionBox["\[Pi]", "8"], "]"}], "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Pi]", "8"], "]"}]}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Pi]", "8"], "]"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.758172806096314*^9, 3.758172888673193*^9, {3.7581729373331213`*^9, 
   3.758173031525128*^9}, 3.75817341208805*^9, {3.758174043967658*^9, 
   3.758174056849739*^9}, 3.758175690190765*^9, 3.759145169147296*^9, 
   3.759148354544793*^9, 3.7592116282381697`*^9, 3.7592959097733717`*^9, 
   3.7592985516681757`*^9, 3.759386885560378*^9, 3.759392231805749*^9, 
   3.75939258791124*^9, 3.759393178830574*^9, 3.7594048664090443`*^9, 
   3.759406017416226*^9, 3.759408372808057*^9, 3.759409572832321*^9, 
   3.7594735208551188`*^9, 3.760692953150078*^9, 3.764328211003418*^9, 
   3.764782610814329*^9, 
   3.7647835394471903`*^9},ExpressionUUID->"daebc121-1845-408b-bcca-\
fba7a184d79a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"UCG", ".", 
   RowBox[{"CT", "[", "UCG", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7591449020449142`*^9, 
  3.759144915973331*^9}},ExpressionUUID->"064025d4-cee5-4626-8b7c-\
9ff75372c0a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.759148357091857*^9, 3.7592116293744583`*^9, 
  3.759298551697254*^9, 3.7593868857296953`*^9, 3.7593922321832943`*^9, 
  3.759393178945882*^9, 3.759404866439376*^9, 3.759406017444228*^9, 
  3.759408372837948*^9, 3.7594095728606358`*^9, 3.759473520890723*^9, 
  3.760692953239998*^9, 3.7643282110411386`*^9, 3.7647826108450403`*^9, 
  3.7647835394766817`*^9},ExpressionUUID->"88ba7270-8a07-4368-bd1b-\
ad6d875444b0"]
}, Open  ]],

Cell["\<\
If the first qubits start in state |1> \[CircleTimes] |0>, the final qubit is \
acted on by RyM[\[Pi]/4,1]:\
\>", "Text",
 CellChangeTimes->{{3.758173047799445*^9, 3.758173077171484*^9}, {
  3.7581733898549967`*^9, 3.758173400896792*^9}, {3.758173509266213*^9, 
  3.7581735189015493`*^9}, {3.7591449257733307`*^9, 3.7591449273414183`*^9}, {
  3.7592117179900217`*^9, 
  3.759211718045669*^9}},ExpressionUUID->"3be70b62-5f89-4bb2-a035-\
879aa031a9b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", "b", "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.758173123318245*^9, 3.758173131923024*^9}, {
  3.758173199789748*^9, 
  3.758173206076496*^9}},ExpressionUUID->"d186b386-167a-408c-9273-\
45c5d48bceb7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"UCG", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"KetV", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[CircleTimes]", 
      RowBox[{"KetV", "[", 
       RowBox[{"0", ",", "2"}], "]"}], "\[CircleTimes]", "psi3"}], ")"}]}]}], 
  ";", 
  RowBox[{"out", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.758173081497863*^9, 3.7581731213322697`*^9}, {
  3.7581731632400703`*^9, 3.758173256817317*^9}, {3.7581734042294817`*^9, 
  3.7581734042918262`*^9}},ExpressionUUID->"aba55acc-99d1-49ec-9648-\
dcb20bb26a1f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"0"},
     {"0"},
     {"0"},
     {
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"Cos", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"b", " ", 
        RowBox[{"Cos", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}], "-", 
       RowBox[{"a", " ", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}]},
     {"0"},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.758173135386532*^9, {3.758173208959598*^9, 3.7581732278914337`*^9}, 
   3.758173258456888*^9, {3.758173404723689*^9, 3.75817341429417*^9}, {
   3.758174046820149*^9, 3.758174062203107*^9}, 3.758175690216641*^9, 
   3.759211631599082*^9, 3.759298551724744*^9, 3.759386886108274*^9, 
   3.759392232293201*^9, 3.75939317906428*^9, 3.759404866473557*^9, 
   3.759406017472825*^9, 3.75940837286644*^9, 3.759409572887727*^9, 
   3.7594735209225883`*^9, 3.760692953323556*^9, 3.7643282110771217`*^9, 
   3.7647826108641033`*^9, 
   3.764783539504221*^9},ExpressionUUID->"2c0a1724-1113-4bbd-8c2f-\
9b76b1bb4bec"]
}, Open  ]],

Cell["The state of the final qubit is ", "Text",
 CellChangeTimes->{{3.758173239893237*^9, 
  3.758173245814891*^9}},ExpressionUUID->"b64bac71-d58e-4457-aa0b-\
d4173493f27a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"BraV", "[", 
      RowBox[{"1", ",", "2"}], "]"}], "\[CircleTimes]", 
     RowBox[{"BraV", "[", 
      RowBox[{"0", ",", "2"}], "]"}], "\[CircleTimes]", 
     RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ")"}], ".", "out"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.758173268906345*^9, 3.758173283635195*^9}, {
  3.758173418385662*^9, 3.758173418467873*^9}, {3.759211646906849*^9, 
  3.759211688038459*^9}},ExpressionUUID->"3e4928f1-e74c-4997-ae99-\
b91f057829f4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"Cos", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"b", " ", 
        RowBox[{"Cos", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}], "-", 
       RowBox[{"a", " ", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.75817327900319*^9, 3.7581732839357357`*^9}, 
   3.758173418715315*^9, {3.75817404878019*^9, 3.758174063646496*^9}, 
   3.7581756902381697`*^9, {3.759211634120729*^9, 3.7592116885047073`*^9}, 
   3.759298551751314*^9, 3.759386886312421*^9, 3.7593922323235083`*^9, 
   3.7593931791646433`*^9, 3.7594048665020742`*^9, 3.759406017498127*^9, 
   3.759408372890723*^9, 3.759409572910288*^9, 3.7594735209509487`*^9, 
   3.76069295340497*^9, 3.7643282111083937`*^9, 3.764782610880101*^9, 
   3.76478353952801*^9},ExpressionUUID->"5c37b2e3-8d02-49c8-aa94-\
f7e4061c8136"]
}, Open  ]],

Cell["This is the same as", "Text",
 CellChangeTimes->{{3.758173292062421*^9, 
  3.758173297729002*^9}},ExpressionUUID->"8e79a6ca-62ca-4577-8187-\
3f7709d761bb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"RyM", "[", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "4"}], ",", "1"}], "]"}], ".", "psi3"}], "]"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7581733051320953`*^9, 3.758173324259955*^9}, {
  3.758173422926203*^9, 3.758173423319707*^9}, {3.759144933693248*^9, 
  3.759144935413435*^9}, {3.7592117226146393`*^9, 
  3.759211722708757*^9}},ExpressionUUID->"86a951e0-0182-4657-854a-\
02fd1a65ce8e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"Cos", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"b", " ", 
        RowBox[{"Cos", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}], "-", 
       RowBox[{"a", " ", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.758173309761154*^9, 3.7581733250535307`*^9}, 
   3.758173423878832*^9, 3.758174065499634*^9, 3.7581756902607327`*^9, 
   3.759211636927361*^9, 3.759211722908965*^9, 3.759298551840502*^9, 
   3.759386886626273*^9, 3.7593922324513474`*^9, 3.75939317926154*^9, 
   3.759404866567444*^9, 3.759406017563263*^9, 3.759408372956588*^9, 
   3.7594095729762278`*^9, 3.7594735210767393`*^9, 3.76069295365256*^9, 
   3.764328211210807*^9, 3.764782610946666*^9, 
   3.764783539592677*^9},ExpressionUUID->"2904261c-521f-4bdb-946e-\
8a2abe71e486"]
}, Open  ]],

Cell["\<\
If we instead apply the same gate with controls {2,1} (in effect relabelling \
the controls)\
\>", "Text",
 CellChangeTimes->{{3.758173350008992*^9, 3.758173369701535*^9}, {
  3.7581735422739277`*^9, 
  3.758173553759177*^9}},ExpressionUUID->"4fa8cb70-aa0b-4423-a5cb-\
3834be784981"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UCG2", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"CreateUCG", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RxM", "[", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"RzM", "[", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"RyM", "[", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], ",", "3", ",", "3"}], "]"}], "]"}]}], 
  ";", 
  RowBox[{"UCG2", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.7581727047429457`*^9, 3.75817270589784*^9}, {
  3.7581727634911537`*^9, 3.7581728878312693`*^9}, {3.7581729316125383`*^9, 
  3.758173030148096*^9}, {3.758173373557468*^9, 3.7581733745883293`*^9}, {
  3.758173434718648*^9, 3.7581734377240067`*^9}, {3.759144946829453*^9, 
  3.7591449533093643`*^9}},ExpressionUUID->"f8baca5e-502e-4c11-be0f-\
182fee1c2371"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], "0", "0", "0", "0", "0", "0"},
     {
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Pi]", "8"], "]"}], 
      RowBox[{"Sin", "[", 
       FractionBox["\[Pi]", "8"], "]"}], "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Pi]", "8"], "]"}]}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Pi]", "8"], "]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "8"}]], "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"7", "/", "8"}]]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.758173374965186*^9, 3.758173438673028*^9, 
  3.75817406691873*^9, 3.758175690327982*^9, 3.7592117315644007`*^9, 
  3.7592959040971727`*^9, 3.7592985519270267`*^9, 3.759386886824554*^9, 
  3.7593922324917603`*^9, 3.7593931793637667`*^9, 3.759404866646223*^9, 
  3.7594060176406612`*^9, 3.7594083730375032`*^9, 3.759409573053897*^9, 
  3.759473521129808*^9, 3.760692953739259*^9, 3.764328211251231*^9, 
  3.7647826110307693`*^9, 
  3.764783539693263*^9},ExpressionUUID->"e4371225-a1db-47f4-bc36-\
a579b1388f6d"]
}, Open  ]],

Cell["\<\
This relabelling is the same as exchanging the first two systems\
\>", "Text",
 CellChangeTimes->{{3.7581737749775143`*^9, 
  3.758173792268277*^9}},ExpressionUUID->"27a1ba0c-7cd1-4933-a0d3-\
8364042149ed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ExchangeSystems", "[", 
   RowBox[{"UCG2", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], "-", "UCG"}]], "Input",\

 CellChangeTimes->{{3.7581737942990303`*^9, 
  3.758173818926612*^9}},ExpressionUUID->"7272ff38-9939-4647-abb4-\
65e5ddd15a4d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.758173814472314*^9, 3.7581738194439287`*^9}, 
   3.758174070277267*^9, 3.758175690351584*^9, 3.75921174097752*^9, {
   3.75929590545611*^9, 3.7592959122507772`*^9}, 3.759298551951417*^9, 
   3.75938688702783*^9, 3.7593922325943203`*^9, 3.7593931795486813`*^9, 
   3.759404866677126*^9, 3.7594060176683273`*^9, 3.7594083730619926`*^9, 
   3.759409573077341*^9, 3.7594735211614723`*^9, 3.760692953823221*^9, 
   3.7643282112867126`*^9, 3.764782611055132*^9, 
   3.764783539719763*^9},ExpressionUUID->"b6d95bf6-db0c-40db-a571-\
b989c4713d40"]
}, Open  ]],

Cell["\<\
Now if the inputs are |1> \[CircleTimes] |0> the action is that of \
RzM[\[Pi]/4,1]\
\>", "Text",
 CellChangeTimes->{{3.7581734720005617`*^9, 3.7581735280189743`*^9}, 
   3.75817362757647*^9, {3.759144962124552*^9, 
   3.759144963236176*^9}},ExpressionUUID->"e869cfbd-8b66-469a-beb0-\
97945d8dba31"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"out2", "=", 
   RowBox[{"UCG2", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"KetV", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[CircleTimes]", 
      RowBox[{"KetV", "[", 
       RowBox[{"0", ",", "2"}], "]"}], "\[CircleTimes]", "psi3"}], ")"}]}]}], 
  ";", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"BraV", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "\[CircleTimes]", 
       RowBox[{"BraV", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "\[CircleTimes]", 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ")"}], ".", "out2"}], "-", 
    RowBox[{
     RowBox[{"RzM", "[", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "4"}], ",", "1"}], "]"}], ".", "psi3"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.758173458571583*^9, {3.758173616852597*^9, 3.7581737060859547`*^9}, {
   3.759144966156801*^9, 
   3.7591449672280207`*^9}},ExpressionUUID->"ecbbfa69-9af1-4beb-bad3-\
69344e8b0797"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.758173461883482*^9, {3.758173617221078*^9, 3.75817362137776*^9}, {
   3.75817368019005*^9, 3.7581737063565063`*^9}, 3.758174071783807*^9, 
   3.758175690373784*^9, 3.759211742785613*^9, {3.759295914112698*^9, 
   3.7592959223792763`*^9}, 3.759298551974969*^9, 3.759386887478396*^9, 
   3.7593922326916122`*^9, 3.759393179715425*^9, 3.759404866707705*^9, 
   3.7594060176951838`*^9, 3.7594083730866203`*^9, 3.75940957310071*^9, 
   3.7594735211888733`*^9, 3.76069295390021*^9, 3.76432821131555*^9, 
   3.7647826110708714`*^9, 
   3.764783539745212*^9},ExpressionUUID->"71c8a1e1-3700-4dcc-84e2-\
d1bfe1fab5a5"]
}, Open  ]],

Cell["We can also get back a gate list", "Text",
 CellChangeTimes->{{3.758173933945342*^9, 3.758173953782889*^9}, {
  3.758174022940674*^9, 3.7581740289993477`*^9}, {3.758174302615903*^9, 
  3.7581743043774652`*^9}},ExpressionUUID->"75307727-dac0-44e0-a9af-\
14f0aa52c552"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist", "=", 
  RowBox[{"DecIsometry", "[", 
   RowBox[{"N", "[", "UCG2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7581739599153557`*^9, 3.758173997049844*^9}, {
  3.758174033403842*^9, 3.758174035949531*^9}, {3.758174307198374*^9, 
  3.7581743501952047`*^9}},ExpressionUUID->"c086d678-cbc3-4676-8492-\
8e7293c40975"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "4.908738521234053`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.5707963267948966`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.71238898038469`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.71238898038469`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.3744467859455343`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.3744467859455343`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.908738521234052`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.7671458676442584`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.1415926535897936`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.19634954084936349`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.19634954084936349`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2.0109675377363145`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.43675884035260853`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5.803836791567845`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.39269908169872547`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.39269908169872547`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4.71238898038469`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.5342917352885173`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4.712388980384689`", ",", "3"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.758173992676032*^9, {3.758174295757848*^9, 3.7581743163473997`*^9}, 
   3.758174351183674*^9, 3.758175690641732*^9, 3.759211745944044*^9, 
   3.7592959252166767`*^9, 3.759298552939097*^9, 3.759386889011904*^9, 
   3.759392234104686*^9, 3.759393181156592*^9, 3.759404867659267*^9, 
   3.759406018641465*^9, 3.759408374038183*^9, 3.759409574121127*^9, 
   3.759473522499792*^9, 3.760692955189229*^9, 3.764328212593219*^9, 
   3.764782612088829*^9, 
   3.764783540751842*^9},ExpressionUUID->"f1d69880-833e-4db5-9275-\
58772bb25511"]
}, Open  ]],

Cell["\<\
This gives the same as making the gate list for UCG and then swapping\
\>", "Text",
 CellChangeTimes->{{3.758175021388578*^9, 3.758175048580607*^9}, {
  3.758175343445665*^9, 
  3.758175345096105*^9}},ExpressionUUID->"ef8b5d04-c350-4599-a121-\
dd7811303486"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gatelist2", "=", 
  RowBox[{"RelabelQubits", "[", 
   RowBox[{
    RowBox[{"DecIsometry", "[", 
     RowBox[{"N", "[", "UCG", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7581750554498367`*^9, 3.758175057224987*^9}, {
  3.758175107353023*^9, 
  3.7581751351368713`*^9}},ExpressionUUID->"ae98d520-70d8-4eca-9c1c-\
9706a89045db"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "3.3379421944391554`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6.283185307179586`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6.283185307179586`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6.086835766330224`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.19634954084936213`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6.086835766330224`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.3744467859455345`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.141592653589793`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.19634954084936349`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3.1415926535897922`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.19634954084936349`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1.1306251158534848`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.4367588403526065`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0.4793485156117381`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.39269908169872547`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0.39269908169872547`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4.71238898038469`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3.5342917352885173`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4.712388980384689`", ",", "3"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7581750578667383`*^9, 3.758175135973914*^9, 
  3.7581756909633217`*^9, 3.759211767037053*^9, 3.7592959283275957`*^9, 
  3.7592985541960487`*^9, 3.759386890816168*^9, 3.75939223604373*^9, 
  3.759392486891374*^9, 3.759393183103982*^9, 3.7593932381868877`*^9, 
  3.75940486893445*^9, 3.759406019911318*^9, 3.7594083753352623`*^9, 
  3.7594095754227858`*^9, 3.759473524107237*^9, 3.760692956882522*^9, 
  3.7643282141979*^9, 3.764782613442368*^9, 
  3.764783542093582*^9},ExpressionUUID->"0038dc04-8910-4836-9532-\
bec989e7aaa4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"isom", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}]}], ";", 
  RowBox[{"isom2", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist2", "]"}]}], ";", 
  RowBox[{"Chop", "[", 
   RowBox[{"isom", "-", 
    RowBox[{
     RowBox[{"isom2", "/", 
      RowBox[{"isom2", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
     RowBox[{"isom", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.758175349357617*^9, 3.758175398920681*^9}, {
  3.761712732314863*^9, 
  3.761712732317752*^9}},ExpressionUUID->"a80a5322-0872-4999-9a6d-\
b50d5c49a556"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7581753992277946`*^9, 3.758175691014248*^9, 
  3.759211780590693*^9, 3.759295929283658*^9, 3.759298554230093*^9, 
  3.759386891026445*^9, 3.7593922361587*^9, 3.7593929174436398`*^9, 
  3.7593931367772923`*^9, 3.759393183914*^9, 3.75940486897782*^9, 
  3.7594060199493732`*^9, 3.759408375367804*^9, 3.7594095754581747`*^9, 
  3.759473524163143*^9, 3.760692957052917*^9, 3.764328214265151*^9, 
  3.764782613474588*^9, 
  3.76478354213266*^9},ExpressionUUID->"45496fdb-948c-4835-b3bb-8ba9f75d9d74"]
}, Open  ]],

Cell["\<\
Note that in the special case of a uniformly controlled gate, we also provide \
an adapted method achieving a slighlty lower CNOT counts than DecIsometry.\
\>", "Text",
 CellChangeTimes->{{3.758175021388578*^9, 3.758175048580607*^9}, {
  3.758175343445665*^9, 3.758175345096105*^9}, {3.759392495828128*^9, 
  3.759392544945915*^9}, {3.759393103685192*^9, 
  3.759393120601425*^9}},ExpressionUUID->"9cb98c97-528e-4053-beb9-\
fb591a3ae840"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", "gatelist2", "]"}]], "Input",
 CellChangeTimes->{{3.759393227664988*^9, 3.759393230499311*^9}, {
  3.7593932857511187`*^9, 
  3.759393292189396*^9}},ExpressionUUID->"7c9a1c39-5b96-4b13-b22c-\
618983e6132d"],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{{3.759393231285406*^9, 3.759393239307884*^9}, {
   3.759393286012478*^9, 3.759393292423148*^9}, 3.759404869009529*^9, 
   3.759406019976851*^9, 3.759408375387904*^9, 3.759409575482633*^9, 
   3.759473524210877*^9, 3.76069295713758*^9, 3.7643282142987022`*^9, 
   3.764782613489976*^9, 
   3.764783542159786*^9},ExpressionUUID->"c1081017-6b14-4d8e-ad6e-\
54ab357fe549"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gateListWithToDiagonal", "=", 
  RowBox[{"DecUCGUpToDiagonal", "[", 
   RowBox[{
    RowBox[{"N", "[", "ucgates", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", "3", ",", "3", ",", 
    RowBox[{"ReturnDiagonal", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.759392549336719*^9, 3.759392555235949*^9}, {
  3.75939259672219*^9, 3.759392671011922*^9}, {3.759392701119466*^9, 
  3.759392711548394*^9}, {3.7593928003022127`*^9, 
  3.7593928021559477`*^9}},ExpressionUUID->"1f2aa35f-604b-4e34-b9c9-\
7dbac3545fd7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "0.2710582062087423`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.763325264746635`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "2.6515817932982353`"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "1.090029901415171`"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.52341142359021`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.7635443306234313`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.3651043100373461`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.6051474544055322`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "1.240959794761603`"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.33700211726036294`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.7763652579560707`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "1.535706080540838`"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.9938025111094674`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.11116010486013853`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.11116010486013832`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.9938025111094675`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.9606929298422987`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.2776132103323258`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.27761321033232633`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.9606929298422986`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.9606929298422987`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.2776132103323258`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.27761321033232633`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.9606929298422986`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.9938025111094674`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.11116010486013853`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.11116010486013832`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.9938025111094675`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.759392615192669*^9, 3.75939267177031*^9}, {
   3.759392702794387*^9, 3.759392712493413*^9}, 3.759392807073676*^9, 
   3.759393183337256*^9, 3.759393293808749*^9, 3.759404869040309*^9, 
   3.759406020003716*^9, 3.759408375408269*^9, 3.759409575506009*^9, 
   3.759473524260273*^9, 3.760692957235301*^9, 3.764328214346686*^9, 
   3.764782613509932*^9, 
   3.7647835421847353`*^9},ExpressionUUID->"7f8b7a17-e4cf-4711-b723-\
1ccee7f6acab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gateListDiag", "=", 
  RowBox[{"DecDiagGate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"gateListWithToDiagonal", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"gateListWithToDiagonal", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7593926905800858`*^9, 
  3.7593928181529093`*^9}},ExpressionUUID->"a39bd374-1d53-4e8c-82e2-\
339742247f5e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "0.`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "0.1699184547270611`"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.718447854656915`*^-16", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "1.1780972450961722`"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.5707963267948963`", ",", "2"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7593927785586557`*^9, 3.759392819303175*^9}, 
   3.759393183448154*^9, 3.759393295488697*^9, 3.759404869071212*^9, 
   3.7594060200305653`*^9, 3.7594083754297867`*^9, 3.759409575531715*^9, 
   3.759473524310268*^9, 3.760692957325796*^9, 3.7643282143834476`*^9, 
   3.764782613525962*^9, 
   3.764783542209743*^9},ExpressionUUID->"cf76578c-f860-4e45-8aa5-\
c96d87a5103b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gateList2", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Drop", "[", 
     RowBox[{"gateListWithToDiagonal", ",", 
      RowBox[{"-", "1"}]}], "]"}], ",", "gateListDiag"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7593928209860992`*^9, 
  3.759392873673321*^9}},ExpressionUUID->"a61f32ef-c255-42fb-b536-\
a6ed73d0bee1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "0.2710582062087423`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.763325264746635`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "2.6515817932982353`"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "1.090029901415171`"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.52341142359021`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.7635443306234313`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.3651043100373461`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.6051474544055322`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "1.240959794761603`"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.33700211726036294`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1.7763652579560707`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "1.535706080540838`"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "0.1699184547270611`"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4.718447854656915`*^-16", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "1.1780972450961722`"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0.`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1.5707963267948963`", ",", "2"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7593928451797037`*^9, 3.759392874374254*^9}, 
   3.759393183565411*^9, 3.759393300320702*^9, 3.7594048691015387`*^9, 
   3.759406020057096*^9, 3.759408375451351*^9, 3.75940957555896*^9, 
   3.7594735243551283`*^9, 3.7606929573854427`*^9, 3.764328214389135*^9, 
   3.764782613542055*^9, 
   3.7647835422347*^9},ExpressionUUID->"eedecc6d-d293-4b9e-90fc-baf3db9a6385"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"iso", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gateList2", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{"UCG2", "-", 
   RowBox[{
    RowBox[{"iso", "/", 
     RowBox[{"iso", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "*", 
    RowBox[{"UCG2", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.759393009833981*^9, 3.759393093409646*^9}, {
   3.7593933204875526`*^9, 3.759393324736486*^9}, {3.7593934099516497`*^9, 
   3.7593934160069933`*^9}, 
   3.761712732330151*^9},ExpressionUUID->"9a23e7ff-0f1e-4902-8f87-\
476d0189acea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7593930548515463`*^9, 3.759393093735363*^9}, 
   3.759393183678198*^9, {3.759393315423567*^9, 3.7593933320930347`*^9}, {
   3.759393410364339*^9, 3.7593934166080627`*^9}, 3.7594048691337233`*^9, 
   3.7594060200845203`*^9, 3.759408375473466*^9, 3.759409575587719*^9, 
   3.759473524385222*^9, 3.760692957425487*^9, 3.764328214424076*^9, 
   3.764782613558674*^9, 
   3.764783542259563*^9},ExpressionUUID->"f21b2c24-8eab-4e1c-92f7-\
ac0b118e7846"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CNOTCount", "[", "gateList2", "]"}]], "Input",
 CellChangeTimes->{{3.759392848914359*^9, 
  3.759392878273506*^9}},ExpressionUUID->"8555fa6b-bb91-4187-a806-\
3128febcad85"],

Cell[BoxData["9"], "Output",
 CellChangeTimes->{{3.759392855236994*^9, 3.7593928785309134`*^9}, 
   3.759393127575164*^9, 3.7593931838028507`*^9, 3.7594048691654177`*^9, 
   3.759406020111561*^9, 3.759408375494308*^9, 3.759409575619836*^9, 
   3.759473524409891*^9, 3.76069295750585*^9, 3.764328214454311*^9, 
   3.764782613574101*^9, 
   3.764783542283538*^9},ExpressionUUID->"b32de994-894f-42e6-a0ca-\
45b716f4ac47"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Channels", "Subsubsection",
 CellChangeTimes->{{3.75914497694053*^9, 
  3.75914497779585*^9}},ExpressionUUID->"c462e833-79ed-41a6-8732-\
9ed02f7c4b15"],

Cell["\<\
We can also do something like this for channels. Take a channel from 2 qubits \
to 3 qubits\
\>", "Text",
 CellChangeTimes->{{3.758175667244821*^9, 3.758175674299201*^9}, {
  3.7581758496221437`*^9, 
  3.758175856587598*^9}},ExpressionUUID->"70351768-b685-4b97-b822-\
82624a34f174"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chan", "=", 
   RowBox[{"RPickRandomChannel", "[", 
    RowBox[{"4", ",", "8", ",", "10"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7581757815187902`*^9, 
  3.758175783783226*^9}},ExpressionUUID->"27085002-7394-4856-84b4-\
bc7ad870077e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gatelist", "=", 
   RowBox[{"DecChannelInQCM", "[", "chan", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.75817570598764*^9, 3.7581757141196613`*^9}, {
  3.758175790475408*^9, 
  3.758175791744809*^9}},ExpressionUUID->"01d24fec-d521-4edc-87fd-\
0ab0420e0b9a"],

Cell["Find the ancilla qubits", "Text",
 CellChangeTimes->{{3.758175959545896*^9, 3.758175964093378*^9}, {
  3.758176016759989*^9, 
  3.7581760179106073`*^9}},ExpressionUUID->"1d4b6cb3-8315-4696-af72-\
0e56c922b068"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sort", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"Cases", "[", 
     RowBox[{"gatelist", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Ancilla", "[", 
          RowBox[{"0", ",", "1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "_"}], "}"}]}], "]"}],
     "]"}], "[", 
   RowBox[{"[", "3", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.758175978666213*^9, 3.758176004420868*^9}, {
  3.764782842851976*^9, 
  3.7647828473071423`*^9}},ExpressionUUID->"2de4f140-2cfd-42b2-bbcd-\
f36f5d69cd55"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]], "Output",
 CellChangeTimes->{{3.758175999189456*^9, 3.75817600468421*^9}, 
   3.758180794592958*^9, 3.759211893407887*^9, 3.75929863318358*^9, 
   3.759299021903244*^9, 3.759386994725786*^9, 3.759392347147966*^9, 
   3.759393586979465*^9, 3.759404948262917*^9, 3.759406104715312*^9, 
   3.759408458524705*^9, 3.759409656388133*^9, 3.759473671510929*^9, 
   3.760693063470376*^9, 3.764328326657063*^9, 3.764782698496215*^9, 
   3.7647836279392443`*^9},ExpressionUUID->"6642aff4-fc09-4943-b7f3-\
07c692edc085"]
}, Open  ]],

Cell["\<\
This is more than the ceiling of the log of the number of Kraus operators\
\>", "Text",
 CellChangeTimes->{{3.7581771749647827`*^9, 
  3.7581772062500668`*^9}},ExpressionUUID->"92415a87-e63a-4d30-bf54-\
93434ef52d57"],

Cell["And the measured qubits", "Text",
 CellChangeTimes->{{3.7581764505488253`*^9, 
  3.758176454468459*^9}},ExpressionUUID->"201f4869-6e24-44d3-b926-\
8eb20363b0b4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sort", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"Cases", "[", 
     RowBox[{"gatelist", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Mmt", "[", "1", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "_"}], "}"}]}], "]"}],
     "]"}], "[", 
   RowBox[{"[", "3", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.764782870482461*^9, 
  3.764782874040452*^9}},ExpressionUUID->"2a984b42-3482-423f-8888-\
fdb4b712808a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.75817645645365*^9, 3.7581807946221848`*^9, 
  3.7592118934393177`*^9, 3.7592986332040567`*^9, 3.759299021938377*^9, 
  3.7593869949314423`*^9, 3.759392347229373*^9, 3.759393589245674*^9, 
  3.7594049482850323`*^9, 3.7594061047426434`*^9, 3.759408458549687*^9, 
  3.759409656409706*^9, 3.759473672866742*^9, 3.760693063508245*^9, 
  3.7643283266841*^9, 3.764782698525338*^9, 
  3.764783627947769*^9},ExpressionUUID->"a3939c99-dc6f-4a20-97dc-\
35808f9f94a1"]
}, Open  ]],

Cell["The total number of qubits is", "Text",
 CellChangeTimes->{{3.758176582985135*^9, 
  3.7581765943044863`*^9}},ExpressionUUID->"a66b94f8-d8b8-4d8c-b399-\
26bff8b88754"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Max", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", "gatelist", "]"}], "[", 
   RowBox[{"[", "3", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.75817655697331*^9, 
  3.758176566699443*^9}},ExpressionUUID->"fb5a8cf3-da62-4896-a5b5-\
933cbb7c12f1"],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{3.75817656753444*^9, 3.758180794652995*^9, 
  3.759211893470216*^9, 3.759298633210244*^9, 3.7592990219739532`*^9, 
  3.7593869951607428`*^9, 3.759392347314416*^9, 3.7593935908326263`*^9, 
  3.759404948307143*^9, 3.75940610477007*^9, 3.759408458572892*^9, 
  3.759409656433112*^9, 3.759473674209304*^9, 3.76069306359086*^9, 
  3.764328326709214*^9, 3.764782698537949*^9, 
  3.764783627956167*^9},ExpressionUUID->"c37f358e-4637-40de-9ade-\
dd5d314cd15d"]
}, Open  ]],

Cell["\<\
Now make qubits {1,3,4,5} the ancilla, with {6,2,7} the output\
\>", "Text",
 CellChangeTimes->{{3.758175830951065*^9, 3.758175896697937*^9}, {
  3.758176600610483*^9, 3.758176648683833*^9}, {3.758176689075733*^9, 
  3.758176689740171*^9}, {3.758180760237295*^9, 3.7581807603112583`*^9}, {
  3.7581807936870527`*^9, 
  3.75818079379386*^9}},ExpressionUUID->"10a46839-f388-4e96-8ca2-\
99a6e2990aca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gatelist2", "=", 
   RowBox[{"DecChannelInQCM", "[", 
    RowBox[{"chan", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "2", ",", "7"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.758175825009348*^9, 3.758175827124352*^9}, {
  3.758175870924397*^9, 3.758175874315873*^9}, {3.758176625552906*^9, 
  3.758176640583218*^9}, {3.7581766850344067`*^9, 3.758176685845436*^9}, {
  3.758176759859765*^9, 3.758176770369422*^9}, {3.758177074172462*^9, 
  3.758177076347741*^9}, {3.758177113343912*^9, 3.758177120414659*^9}, {
  3.758177217441011*^9, 3.758177217982589*^9}, {3.758180761698029*^9, 
  3.758180770376615*^9}},ExpressionUUID->"a25d5e24-6998-4270-b330-\
d1011509405b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chanout1", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.758176701805367*^9, 3.7581767224363613`*^9}, 
   3.761712732341868*^9},ExpressionUUID->"7c408f3b-45d2-491a-870e-\
f0edc33796b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chanout2", "=", 
   RowBox[{"CreateOperationFromGateList", "[", "gatelist2", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.758176728539455*^9, 3.758176729648138*^9}, 
   3.761712732353018*^9},ExpressionUUID->"9f682c7b-2d96-4950-b07d-\
ad07f9b6921f"],

Cell["\<\
Apply channels to an arbitrary 2 qubit state to check they are equal after \
appropriate exchange\
\>", "Text",
 CellChangeTimes->{{3.758180917854748*^9, 3.75818094896496*^9}, {
  3.75818113818696*^9, 
  3.758181169893177*^9}},ExpressionUUID->"bea39aec-b923-4fc9-be65-\
fb18d12c15ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"PickRandomRho", "[", "4", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.758180992794611*^9, 
  3.758181036695614*^9}},ExpressionUUID->"b49c0395-eb6b-490d-a9d8-\
03805f920cfb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"chanout1", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", "rho", ".", 
      RowBox[{"CT", "[", 
       RowBox[{"chanout1", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "chanout1", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "-", 
   RowBox[{"ExchangeSystems", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"chanout2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ".", "rho", ".", 
        RowBox[{"CT", "[", 
         RowBox[{"chanout2", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "chanout2", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.758180976647098*^9, 
  3.758181092569681*^9}},ExpressionUUID->"22d51cee-3e5a-4e61-b569-\
a9bfd4d69f72"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.758181019473242*^9, 3.7581810928478737`*^9}, 
   3.759212005552938*^9, 3.75929871612458*^9, 3.7592990995761538`*^9, 
   3.759387101867897*^9, 3.7593924592664423`*^9, 3.759393705229672*^9, 
   3.759405030627771*^9, 3.7594061876201763`*^9, 3.759408544341197*^9, 
   3.759409739799246*^9, 3.759473785963483*^9, 3.7606931729840937`*^9, 
   3.764328441349145*^9, 
   3.764783718511116*^9},ExpressionUUID->"f567a166-8de1-41a8-a712-\
f6b25274a27b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Random circuits can be constructed for isomteries", "Subsection",
 CellChangeTimes->{{3.7647825296871643`*^9, 
  3.764782557384161*^9}},ExpressionUUID->"a67311d7-3e3d-4f31-b333-\
bb9b3d09300e"],

Cell["\<\
To generate a random circuit for an isometry from 1 qubit to 2 qubits with 4 \
CNOTs.  Note that after each CNOT there are 4 rotations, and at the start of \
the circuit there are also rotations.\
\>", "Text",
 CellChangeTimes->{{3.764782562647442*^9, 3.764782571012837*^9}, {
  3.76478260794818*^9, 3.764782616227337*^9}, {3.76478269383722*^9, 
  3.7647827201925898`*^9}},ExpressionUUID->"db74e77c-7515-4b23-a2d0-\
f47482943d7f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", 
  RowBox[{"PickRandomCircuitIsometry", "[", 
   RowBox[{"1", ",", "2", ",", "4"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7647825448965282`*^9, 3.764782603536189*^9}, {
  3.764782731929522*^9, 
  3.764782735189168*^9}},ExpressionUUID->"f0c2c8c0-cc94-4142-88d2-\
268000b30e03"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -1.}, {7., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -1.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -1.}, {9., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -1.}, {10., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -1.}, {11., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -1.}, {12., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -1.}, {13., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{13., -1.}, {14., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{14., -1.}, {15., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{15., -1.}, {16., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{16., -1.}, {17., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{6., -2.}, {7., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{7., -2.}, {8., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {9., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{8., -2.}, {8., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{9., -2.}, {10., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{10., -2.}, {11., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {12., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{11., -2.}, {11., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{12., -2.}, {13., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{13., -2.}, {14., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{14., -2.}, {15., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{14., -2.}, {14., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{15., -2.}, {16., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{16., -2.}, {17., -2.}}]}}, {
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -1.}]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -1.2}, {2.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {2., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -1.2}, {3.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {3., -1.}]}}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -1.2}, {5., -0.8}}], 
       LineBox[{{4.8, -1.}, {5.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -1.2}, {6.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -1.2}, {7.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {7., -1.}]}}, 
     {GrayLevel[0], DiskBox[{8., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -1.2}, {9.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -1.2}, {10.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {10., -1.}]}}, 
     {GrayLevel[0], DiskBox[{11., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{11.8, -1.2}, {12.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {12., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.8, -1.2}, {13.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {13., -1.}]}}, 
     {GrayLevel[0], DiskBox[{14., -1.}, 0.1]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{14.8, -1.2}, {15.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {15., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{15.8, -1.2}, {16.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {16., -1.}]}}, {}, 
     {GrayLevel[0], DiskBox[{5., -2.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {2., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.8, -2.2}, {3.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {3., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -2.2}, {4.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {4., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{5.8, -2.2}, {6.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {6., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.8, -2.2}, {7.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rz\"\>", {7., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{8., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{8., -2.2}, {8., -1.8}}], 
       LineBox[{{7.8, -2.}, {8.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.8, -2.2}, {9.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {9., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{9.8, -2.2}, {10.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {10., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{11., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{11., -2.2}, {11., -1.8}}], 
       LineBox[{{10.8, -2.}, {11.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{11.8, -2.2}, {12.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {12., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{12.8, -2.2}, {13.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {13., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{14., -2.}, 0.2], 
      {GrayLevel[0], LineBox[{{14., -2.2}, {14., -1.8}}], 
       LineBox[{{13.8, -2.}, {14.2, -2.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{14.8, -2.2}, {15.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Ry\"\>", {15., -2.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{15.8, -2.2}, {16.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {16., -2.}]}}, {}}},
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJx1z7EJgDAQheHDKmUKixQWGkSCBDETxBkcQbB2RB3JEVQMQn7w4Hh876pr
lm1eCxGx9z75zhlT7qmYcitYwyVs4AquYQu3cAc7uIc9PMAjHH7+kSP1Mbfg
rmANG7iCa9jCLdzBDu5hDw/wCIfPF9k7OX8=
     "]]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageSize->{681., Automatic},
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.764783718539145*^9},ExpressionUUID->"7594baa0-bec8-45fd-af24-\
dbd65b0af97b"]
}, Open  ]],

Cell["\<\
With TotGates->True this generates an isometry with the total number of \
gates, rather than the number of CNOTs\
\>", "Text",
 CellChangeTimes->{{3.7647826380085907`*^9, 
  3.764782668224725*^9}},ExpressionUUID->"4439e22c-49f9-46de-93b4-\
2fa5ba8d2b62"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintCircuit", "[", 
  RowBox[{"PickRandomCircuitIsometry", "[", 
   RowBox[{"1", ",", "2", ",", "4", ",", 
    RowBox[{"TotGates", "\[Rule]", "True"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7647826304324636`*^9, 3.764782633987053*^9}, {
  3.764782739542387*^9, 
  3.764782741688595*^9}},ExpressionUUID->"f4475aa4-2d0a-4da3-84bd-\
c01dbf6ee6ed"],

Cell[BoxData[
 GraphicsBox[
  TagBox[{{
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -1.}, {2., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -1.}, {3., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {4., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -1.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -1.}, {5., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {6., -1.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -1.}, {5., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{3., -2.}, {4., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{5., -2.}, {6., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{1., -2.}, {2., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{2., -2.}, {3., -2.}}]}, 
     {GrayLevel[0], Thickness[Large], LineBox[{{4., -2.}, {5., -2.}}]}}, {
     {GrayLevel[0], InsetBox["\<\"|0>\"\>", {0.8, -1.}]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{3., -1.2}, {3., -0.8}}], 
       LineBox[{{2.8, -1.}, {3.2, -1.}}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.8, -1.2}, {4.2, -0.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {4., -1.}]}}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5., -1.}, 0.2], 
      {GrayLevel[0], LineBox[{{5., -1.2}, {5., -0.8}}], 
       LineBox[{{4.8, -1.}, {5.2, -1.}}]}}, {}, 
     {GrayLevel[0], DiskBox[{3., -2.}, 0.1]}, 
     {GrayLevel[0], DiskBox[{5., -2.}, 0.1]}, {}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.8, -2.2}, {2.2, -1.8}], 
      {GrayLevel[0], InsetBox["\<\"Rx\"\>", {2., -2.}]}}, {}, {}}},
   Annotation[#, 
    VertexCoordinateRules -> {{1., -1.}, {2., -1.}, {3., -1.}, {4., -1.}, {
     5., -1.}, {6., -1.}, {3., -2.}, {5., -2.}, {1., -2.}, {2., -2.}, {
     4., -2.}, {6., -2.}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{
  3.7647837185541*^9},ExpressionUUID->"73b6052d-c163-4b35-aed9-2d845c6f293c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{935, 983},
WindowMargins->{{Automatic, 128}, {0, Automatic}},
FrontEndVersion->"12.1 for Linux x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"43a1d333-fd9e-452a-bad0-e67cd548a3bd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 177, 3, 69, "Chapter",ExpressionUUID->"9063663a-367d-44c8-af38-2a5fd81be394"],
Cell[CellGroupData[{
Cell[624, 22, 164, 3, 54, "Subsection",ExpressionUUID->"88dceb0a-7dc2-427b-9785-7fbeb71309c5"],
Cell[791, 27, 409, 8, 58, "Text",ExpressionUUID->"d6619dca-8d9f-461a-b855-1dcd3a5197cc"],
Cell[CellGroupData[{
Cell[1225, 39, 454, 9, 29, "Input",ExpressionUUID->"7487ee14-7d02-4963-a3b0-27ca720f6188"],
Cell[1682, 50, 2470, 50, 78, "Output",ExpressionUUID->"f211be77-3dfd-4fc8-9b54-3c12964fa01d"]
}, Open  ]],
Cell[4167, 103, 169, 3, 35, "Text",ExpressionUUID->"ef020c9f-99e5-4518-9a03-bb15c05509ea"],
Cell[CellGroupData[{
Cell[4361, 110, 315, 7, 29, "Input",ExpressionUUID->"23228d1d-05cd-4c72-82b7-201b5a5b35d3"],
Cell[4679, 119, 2380, 49, 78, "Output",ExpressionUUID->"9b50aaec-8320-4181-ba94-23124ea0be96"]
}, Open  ]],
Cell[7074, 171, 235, 4, 35, "Text",ExpressionUUID->"e565f3ae-8666-4258-a2ce-812a8bae4d07"],
Cell[CellGroupData[{
Cell[7334, 179, 359, 8, 29, "Input",ExpressionUUID->"e853e9ab-c416-4da2-a2c8-75cb38e1e592"],
Cell[7696, 189, 2292, 47, 80, "Output",ExpressionUUID->"3b779d1d-a890-4734-a42f-86985acab3ba"]
}, Open  ]],
Cell[10003, 239, 201, 3, 35, "Text",ExpressionUUID->"8e9913a8-39e6-4979-b871-10085019a5fc"],
Cell[CellGroupData[{
Cell[10229, 246, 315, 7, 29, "Input",ExpressionUUID->"82ff8054-3b7d-4650-877b-e786c92d9425"],
Cell[10547, 255, 1172, 28, 96, "Output",ExpressionUUID->"1122b958-a92c-423c-9406-6f258d567c07"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11756, 288, 308, 5, 46, "Subsubsection",ExpressionUUID->"8694a574-2fa8-4015-ad4a-6f18ac21ea52"],
Cell[12067, 295, 245, 6, 35, "Text",ExpressionUUID->"a42672a6-8629-4eb7-afa4-efcc17a240c5"],
Cell[CellGroupData[{
Cell[12337, 305, 223, 5, 29, "Input",ExpressionUUID->"66dde00c-d6da-4947-84ce-00f1a497a624"],
Cell[12563, 312, 2302, 42, 33, "Output",ExpressionUUID->"7836cb3b-6b43-4103-acb1-c1062959ccc1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14902, 359, 311, 6, 29, "Input",ExpressionUUID->"f15db461-118f-464f-b573-cd29775aaf93"],
Cell[15216, 367, 838, 18, 33, "Output",ExpressionUUID->"9001ee4a-b2bc-487f-9941-93d94ec49824"]
}, Open  ]],
Cell[16069, 388, 646, 11, 58, "Text",ExpressionUUID->"fd029955-edc5-4e5d-96e3-dbc29b14d963"],
Cell[CellGroupData[{
Cell[16740, 403, 112, 1, 29, "Input",ExpressionUUID->"493bdfec-3026-4646-ad01-29f77da02757"],
Cell[CellGroupData[{
Cell[16877, 408, 549, 7, 23, "Print",ExpressionUUID->"e7b8753e-59fe-4981-bfeb-eec277920c03"],
Cell[17429, 417, 833, 17, 23, "Print",ExpressionUUID->"9894b4e4-dace-4400-99e8-3c456a461cb3"],
Cell[18265, 436, 790, 15, 23, "Print",ExpressionUUID->"dcccdd50-9f83-4a55-8ad9-64297dc9ec23"],
Cell[19058, 453, 775, 15, 23, "Print",ExpressionUUID->"61141e5f-b038-4b51-b581-a62ae0a07e57"],
Cell[19836, 470, 744, 13, 23, "Print",ExpressionUUID->"cf0eb9fa-ed25-40d9-a725-9d14e0e8163d"],
Cell[20583, 485, 746, 13, 23, "Print",ExpressionUUID->"28b3083b-bf93-47c4-9e90-694e65ba126e"],
Cell[21332, 500, 744, 13, 23, "Print",ExpressionUUID->"67ce96d7-65f4-4d13-9969-f5d0745578a6"],
Cell[22079, 515, 714, 13, 23, "Print",ExpressionUUID->"a9049cdb-0709-4ab9-9ff3-51b32cda8994"],
Cell[22796, 530, 764, 14, 23, "Print",ExpressionUUID->"f8eae8c6-c79f-4af7-84b9-10ce10fdfc5d"],
Cell[23563, 546, 732, 13, 23, "Print",ExpressionUUID->"092b70c4-5477-46d0-a5df-2d0dc0777e8a"],
Cell[24298, 561, 732, 13, 23, "Print",ExpressionUUID->"61101839-fd08-4b7c-a960-8b9383c81a58"],
Cell[25033, 576, 740, 13, 23, "Print",ExpressionUUID->"bd1be1ca-72b5-4ce2-94cc-2156545e4657"],
Cell[25776, 591, 738, 13, 23, "Print",ExpressionUUID->"ddf07465-abef-40b7-ab4f-46da25e43752"],
Cell[26517, 606, 778, 15, 23, "Print",ExpressionUUID->"9de88cdf-a651-4d26-98ca-096eb5cf8f25"],
Cell[27298, 623, 776, 15, 23, "Print",ExpressionUUID->"e6d4c77d-15e8-4eb5-9871-6d0033207f94"]
}, Open  ]]
}, Open  ]],
Cell[28101, 642, 267, 6, 35, "Text",ExpressionUUID->"dcfced5a-2ebe-4674-b1d0-eda08080a0f4"],
Cell[CellGroupData[{
Cell[28393, 652, 313, 6, 29, "Input",ExpressionUUID->"c16ce974-77ac-4956-b830-0074c6bb9f4e"],
Cell[28709, 660, 1184, 26, 33, "Output",ExpressionUUID->"ff23feca-e738-495f-aad7-3503d3cd5c36"]
}, Open  ]],
Cell[29908, 689, 173, 3, 35, "Text",ExpressionUUID->"461778f3-d9b4-483c-8aa9-56544050c887"],
Cell[CellGroupData[{
Cell[30106, 696, 725, 17, 29, "Input",ExpressionUUID->"40bb3936-4a57-41a1-a306-fdd0b6622e33"],
Cell[30834, 715, 1786, 30, 33, "Output",ExpressionUUID->"19c8a96c-20a5-4855-aace-8e4495f57d7b"]
}, Open  ]],
Cell[32635, 748, 284, 6, 35, "Text",ExpressionUUID->"d6460ef6-1d41-4923-a5cc-34deab81538d"],
Cell[CellGroupData[{
Cell[32944, 758, 313, 6, 29, "Input",ExpressionUUID->"9ca416cb-569d-4b7d-9728-2409ff910bfc"],
Cell[33260, 766, 1936, 34, 33, "Output",ExpressionUUID->"949cc299-8653-4141-8b32-fa5e6047d570"]
}, Open  ]],
Cell[35211, 803, 190, 3, 35, "Text",ExpressionUUID->"2b8fcdf0-8ee4-4124-8f90-3b9c84fdd84c"],
Cell[CellGroupData[{
Cell[35426, 810, 536, 9, 30, "Input",ExpressionUUID->"997ba7b0-c522-4366-bc42-e0cc96be98b4"],
Cell[35965, 821, 1964, 29, 34, "Output",ExpressionUUID->"065844fb-850b-4ffb-bbeb-1de03fdc4e88"]
}, Open  ]],
Cell[37944, 853, 158, 3, 35, "Text",ExpressionUUID->"c790f127-6ad6-4bad-a503-944afc38268f"],
Cell[CellGroupData[{
Cell[38127, 860, 507, 9, 30, "Input",ExpressionUUID->"c6b40152-14b9-48ad-93f8-d346932ec7a8"],
Cell[38637, 871, 4647, 104, 86, "Output",ExpressionUUID->"4e0e64b6-56cb-4f59-92a3-a2100b122b52"]
}, Open  ]],
Cell[43299, 978, 172, 3, 35, "Text",ExpressionUUID->"4b1fc65a-31e2-4056-8e52-efec81a15c27"],
Cell[CellGroupData[{
Cell[43496, 985, 247, 5, 30, "Input",ExpressionUUID->"ea254779-bd6c-4507-8224-41dfbc3f0fec"],
Cell[43746, 992, 2529, 46, 54, "Output",ExpressionUUID->"bf41a3f7-ea71-44f2-b75e-e49a6303b105"]
}, Open  ]],
Cell[46290, 1041, 703, 21, 58, "Text",ExpressionUUID->"46a4089f-8b88-4946-9e1e-b419c4dfad49"],
Cell[CellGroupData[{
Cell[47018, 1066, 199, 4, 30, "Input",ExpressionUUID->"e0f73b9d-3f5c-4a3a-9a64-cdd7a9ecde70"],
Cell[47220, 1072, 587, 9, 79, "Output",ExpressionUUID->"d4ebb54a-83d0-4585-9ac3-e3e65354e85f"]
}, Open  ]],
Cell[47822, 1084, 286, 7, 35, "Text",ExpressionUUID->"9430faff-0882-43bd-9fbe-0237625098cc"],
Cell[CellGroupData[{
Cell[48133, 1095, 315, 7, 30, "Input",ExpressionUUID->"a74a8396-3ab1-4025-867d-2fbd846b1d17"],
Cell[48451, 1104, 2324, 45, 115, "Output",ExpressionUUID->"8a7e24d7-1432-435d-be88-64364c6e8d43"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50812, 1154, 291, 7, 30, "Input",ExpressionUUID->"a695f0fc-d603-45d2-b6ad-b77cfd09a026"],
Cell[51106, 1163, 1233, 17, 101, "Output",ExpressionUUID->"18b977f0-21dc-4b43-97d4-6e6baaf72aea"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52400, 1187, 171, 3, 54, "Subsection",ExpressionUUID->"9dc29c6d-66a4-4478-8474-05d4701629f1"],
Cell[CellGroupData[{
Cell[52596, 1194, 183, 3, 45, "Subsubsection",ExpressionUUID->"2cf0085e-e743-4161-a61b-1a8cf32ee6e3"],
Cell[52782, 1199, 729, 12, 81, "Text",ExpressionUUID->"dd64f436-7974-464e-8280-46fdba8f5e3a"],
Cell[CellGroupData[{
Cell[53536, 1215, 299, 7, 30, "Input",ExpressionUUID->"33374886-02d2-43c7-b1da-acc9ca32dea1"],
Cell[53838, 1224, 2897, 54, 83, "Output",ExpressionUUID->"e5f42b14-09eb-4dce-88fa-29fe1806e579"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56772, 1283, 410, 8, 30, "Input",ExpressionUUID->"130f6fbd-f21e-4ead-84a2-c4ce90a088c1"],
Cell[57185, 1293, 3294, 64, 79, "Output",ExpressionUUID->"590dcc26-da11-4e70-88f5-00e3decc8b59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60516, 1362, 247, 5, 30, "Input",ExpressionUUID->"610d5bb5-8950-41d3-bd59-6f7c8f3d574b"],
Cell[60766, 1369, 7070, 123, 93, "Output",ExpressionUUID->"f383e27c-229f-454b-bcac-9fb5b5abf1df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67873, 1497, 175, 4, 29, "Input",ExpressionUUID->"61c74425-3eaa-4d51-8190-8a2806877f5c"],
Cell[68051, 1503, 742, 11, 137, "Output",ExpressionUUID->"3ba524ff-5d1a-4977-847f-7ba5cf026fd2"]
}, Open  ]],
Cell[68808, 1517, 178, 3, 35, "Text",ExpressionUUID->"0784cfcb-5d1f-4773-aaec-bb0192710ac0"],
Cell[CellGroupData[{
Cell[69011, 1524, 820, 21, 29, "Input",ExpressionUUID->"aea1d9da-abeb-401b-9325-68dec2a50772"],
Cell[69834, 1547, 1952, 33, 33, "Output",ExpressionUUID->"08519deb-dcf2-4dd6-bfc3-4cfc652bde45"]
}, Open  ]],
Cell[71801, 1583, 364, 7, 35, "Text",ExpressionUUID->"2fb105a9-9565-4a01-8033-f84a2fe02675"],
Cell[CellGroupData[{
Cell[72190, 1594, 364, 10, 29, "Input",ExpressionUUID->"31e968a8-d696-485f-9723-4465c9f5b1df"],
Cell[72557, 1606, 2887, 59, 75, "Output",ExpressionUUID->"b5d9dbd3-fb5a-4eb2-a329-a5881f295cc3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75481, 1670, 127, 1, 29, "Input",ExpressionUUID->"6ff5f6fc-34f8-49f5-8ad7-169171d9ccd5"],
Cell[75611, 1673, 8569, 145, 193, "Output",ExpressionUUID->"fb55582b-474d-4af0-9605-9c7c3359ac10"]
}, Open  ]],
Cell[84195, 1821, 199, 3, 35, "Text",ExpressionUUID->"c38843d3-2662-40ca-8e0e-02fb08453f54"],
Cell[CellGroupData[{
Cell[84419, 1828, 296, 8, 29, "Input",ExpressionUUID->"d078974e-4247-4028-90c7-5f1fe1aef2e7"],
Cell[84718, 1838, 7924, 134, 195, "Output",ExpressionUUID->"0dc8262f-2d7e-4b91-8eb5-d1efdb82dc73"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[92691, 1978, 227, 4, 45, "Subsubsection",ExpressionUUID->"2ec2c92d-7436-43d2-bc35-f9be9c400a1d"],
Cell[92921, 1984, 234, 4, 35, "Text",ExpressionUUID->"a979648e-dfee-4742-85dd-05a0e65322ab"],
Cell[CellGroupData[{
Cell[93180, 1992, 294, 6, 30, "Input",ExpressionUUID->"2abad297-5933-44ad-9c2e-dcf87ff2d483"],
Cell[93477, 2000, 5525, 124, 214, "Output",ExpressionUUID->"efbdde25-e7e8-45b0-9445-d27f31c37fb0"]
}, Open  ]],
Cell[99017, 2127, 222, 5, 35, "Text",ExpressionUUID->"844d7ee5-4d84-4fd3-9db8-899e2f29a466"],
Cell[CellGroupData[{
Cell[99264, 2136, 248, 5, 30, "Input",ExpressionUUID->"e5a8ae16-61bf-49bc-9667-3fa2b5881f78"],
Cell[99515, 2143, 1550, 23, 34, "Output",ExpressionUUID->"43244d54-4f23-48de-b210-5434da9dbc93"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101102, 2171, 757, 20, 30, "Input",ExpressionUUID->"c3681e39-c6cc-45c3-b350-69b05c88f021"],
Cell[101862, 2193, 1878, 33, 34, "Output",ExpressionUUID->"e7c1e0d0-f6ce-4a3c-a225-843f547d634e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[103789, 2232, 193, 3, 45, "Subsubsection",ExpressionUUID->"facffd1c-80e0-4c3f-8c8c-e1a80e9cf3c5"],
Cell[103985, 2237, 221, 5, 35, "Text",ExpressionUUID->"b4ca9ea5-7890-4f09-8a16-05f7d718df7f"],
Cell[CellGroupData[{
Cell[104231, 2246, 249, 5, 30, "Input",ExpressionUUID->"a92d04ca-b9b0-44a0-80a3-1e8c39b8b5e2"],
Cell[104483, 2253, 3233, 67, 79, "Output",ExpressionUUID->"42d725e5-e2e5-47e6-aa4b-36c7d3bd7d7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107753, 2325, 171, 4, 30, "Input",ExpressionUUID->"d447028b-20ad-4a47-9211-1e7fac3a2d9e"],
Cell[107927, 2331, 1503, 22, 34, "Output",ExpressionUUID->"1f59a84e-23e6-435b-a10a-dadbc570e767"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109467, 2358, 750, 20, 30, "Input",ExpressionUUID->"0215da3a-e841-40cb-abd9-156bb1cc181f"],
Cell[110220, 2380, 1825, 32, 34, "Output",ExpressionUUID->"9571e67a-1591-40a5-9b7b-a065b0250c0b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112106, 2419, 295, 4, 54, "Subsection",ExpressionUUID->"d9ed62b5-c7b8-43fe-8332-371f660cf1cd"],
Cell[112404, 2425, 522, 9, 58, "Text",ExpressionUUID->"839b682f-b426-442a-b7ad-7f73e328688a"],
Cell[112929, 2436, 540, 10, 58, "Text",ExpressionUUID->"51ace522-1ae5-4666-a664-a9d42dda5367"],
Cell[113472, 2448, 317, 9, 30, "Input",ExpressionUUID->"cecf720f-a8c7-4df0-b233-3598e2af642f"],
Cell[CellGroupData[{
Cell[113814, 2461, 220, 5, 30, "Input",ExpressionUUID->"76b62c6a-be13-45a0-b257-50a2bff735c1"],
Cell[114037, 2468, 3845, 93, 167, "Output",ExpressionUUID->"3ea00fcf-2cd5-4fa8-8bec-cb937e5a1bf8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117919, 2566, 200, 4, 30, "Input",ExpressionUUID->"f25eba4d-1bba-4274-9e9b-8e3dda7e030b"],
Cell[118122, 2572, 15097, 248, 90, "Output",ExpressionUUID->"04036784-5f60-46d0-9b33-ce16c09b84c7"]
}, Open  ]],
Cell[133234, 2823, 662, 14, 58, "Text",ExpressionUUID->"1243321f-ff53-47ad-9d71-5b32271566d4"],
Cell[CellGroupData[{
Cell[133921, 2841, 1352, 39, 97, "Input",ExpressionUUID->"70725ed5-c610-4137-b961-b1005d3124dd"],
Cell[135276, 2882, 8586, 164, 151, "Output",ExpressionUUID->"319f3846-1c4f-4f30-a1ea-1add4374d03f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143899, 3051, 114, 1, 30, "Input",ExpressionUUID->"b5e93143-638f-4417-81b1-9060d3e72248"],
Cell[144016, 3054, 2259, 44, 151, "Output",ExpressionUUID->"8d9eefbd-6c84-44df-833c-4777003d5957"]
}, Open  ]],
Cell[146290, 3101, 300, 6, 35, "Text",ExpressionUUID->"426b4ed2-9f72-4be8-aefd-5e53cc097a94"],
Cell[CellGroupData[{
Cell[146615, 3111, 996, 25, 53, "Input",ExpressionUUID->"02defd4b-819d-431d-82a6-3a3fff8dda67"],
Cell[147614, 3138, 1942, 42, 151, "Output",ExpressionUUID->"441e9a73-dee2-4bb9-8659-07fd66608d29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149593, 3185, 287, 4, 45, "Subsubsection",ExpressionUUID->"8248c181-52f1-4304-9112-3f356503b37f"],
Cell[149883, 3191, 575, 10, 58, "Text",ExpressionUUID->"1adc78f9-f9af-43db-be3d-d4983d365628"],
Cell[150461, 3203, 222, 4, 35, "Text",ExpressionUUID->"c846ee9b-b100-4128-baba-e11a43d42986"],
Cell[150686, 3209, 241, 6, 30, "Input",ExpressionUUID->"ea93d721-0c64-489a-b5b4-b17e19730c76"],
Cell[CellGroupData[{
Cell[150952, 3219, 220, 5, 30, "Input",ExpressionUUID->"b975efc1-5379-4742-b79c-7b5908e65f09"],
Cell[151175, 3226, 1493, 22, 34, "Output",ExpressionUUID->"ace25f21-62b3-497e-b4c2-d60614c4f49a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152705, 3253, 246, 5, 30, "Input",ExpressionUUID->"b213a2a5-87f1-429f-8e76-083b077a36b3"],
Cell[152954, 3260, 1472, 22, 34, "Output",ExpressionUUID->"549ea625-e7be-4ab5-abef-db42722be71d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154463, 3287, 228, 4, 30, "Input",ExpressionUUID->"0d3f0839-bc4c-4f9a-86da-564bff51623d"],
Cell[154694, 3293, 1472, 22, 34, "Output",ExpressionUUID->"fa68ef85-b338-4c42-a52c-68dad38553f9"]
}, Open  ]],
Cell[156181, 3318, 235, 4, 35, "Text",ExpressionUUID->"ca8ebe5c-071c-4c2f-a14b-3b16420a4e82"],
Cell[156419, 3324, 318, 8, 29, "Input",ExpressionUUID->"4abbf7ab-5f81-4355-b10a-47845b224dd5"],
Cell[CellGroupData[{
Cell[156762, 3336, 220, 5, 29, "Input",ExpressionUUID->"37d762ca-1478-4ef1-bf6b-4bc4c0cc156a"],
Cell[156985, 3343, 1577, 23, 33, "Output",ExpressionUUID->"d62ba9f9-49e4-416f-aacc-49fdc0e5df68"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158599, 3371, 246, 5, 29, "Input",ExpressionUUID->"ee3be496-151a-40f6-8812-f67f58c6e0f2"],
Cell[158848, 3378, 1559, 23, 33, "Output",ExpressionUUID->"3bb80638-d847-4dcc-9839-c575e3b5b864"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160444, 3406, 334, 7, 29, "Input",ExpressionUUID->"fec35c68-ac01-4960-8fd9-3eb3f77e78ad"],
Cell[160781, 3415, 1563, 23, 33, "Output",ExpressionUUID->"a8c1f843-68cb-49f6-b199-e514ab415423"]
}, Open  ]],
Cell[162359, 3441, 670, 11, 58, "Text",ExpressionUUID->"f874e417-de6b-40d7-9dd5-e065a432a8fa"],
Cell[CellGroupData[{
Cell[163054, 3456, 289, 7, 29, "Input",ExpressionUUID->"8d738cf0-851d-49e3-a935-8781b8a7e55a"],
Cell[163346, 3465, 388, 6, 33, "Output",ExpressionUUID->"b1adda1e-19b8-42b3-9437-bd094c5c4b47"]
}, Open  ]],
Cell[163749, 3474, 568, 10, 58, "Text",ExpressionUUID->"da36d355-3b4e-4584-8744-13fe188ca18c"],
Cell[CellGroupData[{
Cell[164342, 3488, 296, 7, 29, "Input",ExpressionUUID->"26a0ec5a-b6c3-4f92-9d7c-6845cec7462a"],
Cell[164641, 3497, 387, 6, 33, "Output",ExpressionUUID->"bb5dd553-6736-4ee3-a66c-33d3d547ef0d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165065, 3508, 582, 10, 29, "Input",ExpressionUUID->"87c91cb6-4e7e-4873-bd00-56e1785854b0"],
Cell[165650, 3520, 1412, 21, 33, "Output",ExpressionUUID->"85861a18-81f1-4167-8789-f3dd3423d7cd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167099, 3546, 343, 8, 29, "Input",ExpressionUUID->"f92742e5-6ca2-4f44-be44-bdb4f883b779"],
Cell[167445, 3556, 443, 7, 33, "Output",ExpressionUUID->"49bea0a2-eb1a-445d-9cd5-a4d733665686"]
}, Open  ]],
Cell[167903, 3566, 648, 11, 58, "Text",ExpressionUUID->"ea7ec8f5-a4f9-466f-94d8-8044398979f9"],
Cell[CellGroupData[{
Cell[168576, 3581, 308, 6, 29, "Input",ExpressionUUID->"59e20ce0-7ada-4b6a-8f2b-4bc2320111be"],
Cell[168887, 3589, 1548, 22, 33, "Output",ExpressionUUID->"07e2203d-40c0-436a-84e0-ee849ad62a1f"]
}, Open  ]],
Cell[170450, 3614, 488, 9, 35, "Text",ExpressionUUID->"702ceced-fbcb-47e7-a98d-99932edf260d"],
Cell[170941, 3625, 1634, 45, 147, "Input",ExpressionUUID->"424ab8e9-05c5-4d90-9e3b-d767e9e0203d"],
Cell[CellGroupData[{
Cell[172600, 3674, 218, 5, 29, "Input",ExpressionUUID->"e17878b4-b880-4d9b-9cc8-4e07d81be222"],
Cell[172821, 3681, 589, 9, 33, "Output",ExpressionUUID->"06a0e222-3ce6-4e33-889a-72da491d4e51"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173447, 3695, 201, 5, 30, "Input",ExpressionUUID->"6d7aa686-0e13-4c72-adfb-8873c3cc5d43"],
Cell[173651, 3702, 557, 9, 34, "Output",ExpressionUUID->"17f324e8-dd4d-4f5f-8759-68b4090b7ab6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174245, 3716, 163, 3, 30, "Input",ExpressionUUID->"39bea900-f462-4103-9289-92f3d47447f8"],
Cell[174411, 3721, 545, 9, 34, "Output",ExpressionUUID->"6ef5906f-444a-464d-a228-c8cfef7c1268"]
}, Open  ]],
Cell[174971, 3733, 474, 9, 58, "Text",ExpressionUUID->"d8f91627-a76f-411f-970c-a86d504a8867"],
Cell[CellGroupData[{
Cell[175470, 3746, 255, 5, 30, "Input",ExpressionUUID->"4b7fada7-70e4-4ac8-a512-e1a0ff1accf1"],
Cell[175728, 3753, 1353, 20, 34, "Output",ExpressionUUID->"983ace49-c825-4370-bc92-782b6b1cba2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177118, 3778, 157, 3, 30, "Input",ExpressionUUID->"31f5c59d-f0e4-4fc9-854d-31b2a773ec0d"],
Cell[177278, 3783, 1580, 24, 34, "Output",ExpressionUUID->"2ec7ddaa-939d-4140-8401-d72f27e41778"]
}, Open  ]],
Cell[178873, 3810, 248, 4, 35, "Text",ExpressionUUID->"32fe0a93-619b-4151-a29b-f7270d869a45"],
Cell[179124, 3816, 1338, 33, 53, "Input",ExpressionUUID->"56c8dbde-e44c-4d84-9b6c-08111637c292"],
Cell[CellGroupData[{
Cell[180487, 3853, 220, 5, 30, "Input",ExpressionUUID->"be3821c6-f7f0-44c8-a141-44c7e2d71909"],
Cell[180710, 3860, 1637, 24, 34, "Output",ExpressionUUID->"885b6f0e-2d5f-42ad-a058-34a21ad130ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182384, 3889, 248, 5, 30, "Input",ExpressionUUID->"d3eeccb5-4b23-48fd-9a50-4f9c98785594"],
Cell[182635, 3896, 1417, 21, 34, "Output",ExpressionUUID->"51881320-1312-4489-b842-ef01bcd1e24d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184089, 3922, 228, 4, 30, "Input",ExpressionUUID->"50eac638-3653-4ef8-a270-926a8b17e0d6"],
Cell[184320, 3928, 1412, 20, 34, "Output",ExpressionUUID->"58ab0e29-a5ee-4eac-a5be-451f6992be3c"]
}, Open  ]],
Cell[185747, 3951, 291, 6, 35, "Text",ExpressionUUID->"26940f68-fd94-4106-9376-57ce4a95bb0e"],
Cell[CellGroupData[{
Cell[186063, 3961, 258, 5, 30, "Input",ExpressionUUID->"78dbb129-cd07-4d62-a12d-e27edb33a64f"],
Cell[186324, 3968, 1078, 17, 34, "Output",ExpressionUUID->"aeeb0f21-a3ad-40a2-a065-0ac347691d8c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187439, 3990, 157, 3, 30, "Input",ExpressionUUID->"8c1b8c2e-014d-4b36-b3b4-22dda78cdad1"],
Cell[187599, 3995, 1259, 19, 34, "Output",ExpressionUUID->"b8c3b7b8-490b-48b7-99df-26f1da96d974"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[188919, 4021, 273, 6, 54, "Subsection",ExpressionUUID->"cf195567-654f-48b5-8c83-9e59ad0f4e90"],
Cell[189195, 4029, 251, 4, 35, "Text",ExpressionUUID->"13bbad07-4d05-4bc1-a795-e831258c5f0e"],
Cell[CellGroupData[{
Cell[189471, 4037, 1429, 42, 185, "Input",ExpressionUUID->"25164243-de4b-49fd-a96d-0d1f04de4f82"],
Cell[190903, 4081, 2217, 51, 301, "Output",ExpressionUUID->"a8085176-4035-4a4a-accb-c3ed43363e24"]
}, Open  ]],
Cell[193135, 4135, 2233, 50, 283, "Input",ExpressionUUID->"3ab1a337-8e09-4629-a3ce-4e5f603afd85"],
Cell[CellGroupData[{
Cell[195393, 4189, 468, 9, 30, "Input",ExpressionUUID->"6779d11a-c1f8-4052-9afd-5ed423f59915"],
Cell[195864, 4200, 469, 7, 34, "Output",ExpressionUUID->"c17d8d53-be8d-4979-9983-8ed83def5a81"]
}, Open  ]],
Cell[196348, 4210, 162, 3, 35, "Text",ExpressionUUID->"a254276b-eb32-42e6-b592-23b1f3495e94"],
Cell[CellGroupData[{
Cell[196535, 4217, 470, 12, 30, "Input",ExpressionUUID->"440ee041-3dfd-4a4c-af46-298e3bde41af"],
Cell[197008, 4231, 3658, 85, 189, "Output",ExpressionUUID->"a96250ac-2289-43f5-bd0f-1378b4537706"]
}, Open  ]],
Cell[200681, 4319, 187, 3, 35, "Text",ExpressionUUID->"eefefc46-bff7-4065-bed1-d7b5763b4c8d"],
Cell[CellGroupData[{
Cell[200893, 4326, 435, 8, 30, "Input",ExpressionUUID->"25f979fc-facb-4cc4-ad5d-2d7905b86ff4"],
Cell[201331, 4336, 508, 8, 34, "Output",ExpressionUUID->"fe44da6f-16db-447f-b391-46991ec32fe6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201876, 4349, 326, 7, 30, "Input",ExpressionUUID->"da33745d-f4cb-4cb2-b4f0-e542087046bb"],
Cell[202205, 4358, 370, 6, 34, "Output",ExpressionUUID->"8157e231-f0c1-4711-9675-4edd7cbcd085"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202612, 4369, 323, 7, 30, "Input",ExpressionUUID->"33b76cc6-5036-4137-a1c6-79678d5b89bf"],
Cell[202938, 4378, 400, 7, 34, "Output",ExpressionUUID->"0ec2ce55-2a34-4fd7-bff3-0fb794f10887"]
}, Open  ]],
Cell[203353, 4388, 316, 7, 35, "Text",ExpressionUUID->"1814fdca-4b3e-404c-8691-d52ea6ead541"],
Cell[CellGroupData[{
Cell[203694, 4399, 826, 21, 75, "Input",ExpressionUUID->"e2c54123-c97f-47a9-ba4d-9d38d590bbf0"],
Cell[204523, 4422, 3056, 72, 165, "Output",ExpressionUUID->"f8e04570-9b20-4cc3-9744-fbd84bf51e16"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207616, 4499, 258, 5, 30, "Input",ExpressionUUID->"fda4dc68-8e99-41d3-9052-5f3bf7a60003"],
Cell[207877, 4506, 154, 3, 34, "Output",ExpressionUUID->"90aa5a6c-b9fb-4797-98e2-d42d72f7f102"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208068, 4514, 255, 5, 30, "Input",ExpressionUUID->"40b7d157-1b1b-4465-97ff-c5f454278a16"],
Cell[208326, 4521, 154, 3, 34, "Output",ExpressionUUID->"8d95d5ba-005e-4dfb-970c-173c1a77c4cd"]
}, Open  ]],
Cell[208495, 4527, 172, 3, 35, "Text",ExpressionUUID->"381f6e9b-6792-443d-b72c-c0a763cd58ab"],
Cell[208670, 4532, 410, 11, 30, "Input",ExpressionUUID->"6dfdb2fa-a749-4c59-acc8-2cf5f6828a05"],
Cell[CellGroupData[{
Cell[209105, 4547, 314, 7, 30, "Input",ExpressionUUID->"1813880b-5d65-4d6b-afc2-9c53c1ab5ace"],
Cell[209422, 4556, 179, 3, 34, "Output",ExpressionUUID->"97fe0a1b-59ae-4f09-8d8f-adea7901c850"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209638, 4564, 231, 5, 30, "Input",ExpressionUUID->"5e14cf82-2c3a-4c5c-8d92-771e64e010ea"],
Cell[209872, 4571, 155, 3, 34, "Output",ExpressionUUID->"3b36b593-cb12-47c8-8a42-09b29fdcd9fc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210064, 4579, 869, 25, 53, "Input",ExpressionUUID->"82517269-0365-4872-bc2c-e03d9cb514a6"],
Cell[210936, 4606, 5260, 133, 233, "Output",ExpressionUUID->"724adb33-70c9-40cf-82ca-ea204d3eab95"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[216245, 4745, 165, 3, 54, "Subsection",ExpressionUUID->"dab312b9-c026-4326-b038-64c16427232d"],
Cell[216413, 4750, 435, 8, 58, "Text",ExpressionUUID->"9dfa27fb-c2b1-4374-a068-105bd9041bba"],
Cell[CellGroupData[{
Cell[216873, 4762, 221, 5, 30, "Input",ExpressionUUID->"4d196da3-861b-4523-917b-374487b45ac4"],
Cell[217097, 4769, 2546, 49, 57, "Output",ExpressionUUID->"17abba2a-2bb7-4e1b-ae78-8a3c5ac0ca12"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219680, 4823, 227, 5, 30, "Input",ExpressionUUID->"5bd27100-29a7-4faf-9375-828e175f0fe9"],
Cell[219910, 4830, 3290, 70, 101, "Output",ExpressionUUID->"71b25513-5ff8-463b-9f69-7e75bdcf6c8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[223237, 4905, 195, 4, 30, "Input",ExpressionUUID->"1bd9562e-a9ba-4050-ab3c-d3da09ddda1f"],
Cell[223435, 4911, 389, 6, 34, "Output",ExpressionUUID->"19a095a6-db79-462f-9980-c1e8aa43c3f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[223861, 4922, 198, 4, 30, "Input",ExpressionUUID->"fc9100bb-5704-451b-a600-57d53982a44b"],
Cell[224062, 4928, 7569, 131, 149, "Output",ExpressionUUID->"e62c5d89-2b76-4cd0-8660-cec0ab5c7919"]
}, Open  ]],
Cell[231646, 5062, 433, 9, 35, "Text",ExpressionUUID->"d4f931a3-3ae3-41f5-9f74-7c16d2825e29"],
Cell[CellGroupData[{
Cell[232104, 5075, 271, 6, 30, "Input",ExpressionUUID->"2f30f6e3-3793-4ebf-b276-b8d325f5c9ac"],
Cell[232378, 5083, 388, 6, 34, "Output",ExpressionUUID->"4181143a-8748-46f8-a1bb-ea41b477b915"]
}, Open  ]],
Cell[CellGroupData[{
Cell[232803, 5094, 586, 11, 30, "Input",ExpressionUUID->"58a18459-f356-4218-88ac-648e79dfc1a6"],
Cell[233392, 5107, 2959, 61, 151, "Output",ExpressionUUID->"61c57ea8-1053-4de7-956d-704b568a23f4"]
}, Open  ]],
Cell[236366, 5171, 182, 3, 35, "Text",ExpressionUUID->"49c9afe0-1a50-4fd5-9f74-49a337344be2"],
Cell[CellGroupData[{
Cell[236573, 5178, 546, 15, 30, "Input",ExpressionUUID->"2ec006b1-0a1d-467c-a872-9d3d10a3976f"],
Cell[237122, 5195, 1598, 29, 34, "Output",ExpressionUUID->"86cca4fc-c93b-4e6d-bb93-f82d5713e6e7"]
}, Open  ]],
Cell[238735, 5227, 673, 11, 58, "Text",ExpressionUUID->"401cd3a2-bd13-4896-9644-f541651413c2"],
Cell[CellGroupData[{
Cell[239433, 5242, 230, 5, 30, "Input",ExpressionUUID->"2cac7e6a-b5a4-4bbc-8880-b147e9db1d67"],
Cell[239666, 5249, 2284, 55, 101, "Output",ExpressionUUID->"44572f4f-6fe0-40f7-a4cc-eed23083c01f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241987, 5309, 197, 4, 30, "Input",ExpressionUUID->"6eef6b5c-0464-4c80-aceb-7c46b2afe171"],
Cell[242187, 5315, 391, 6, 34, "Output",ExpressionUUID->"bea73d5c-604b-44d7-9e5b-cf9283cfe657"]
}, Open  ]],
Cell[242593, 5324, 199, 3, 35, "Text",ExpressionUUID->"3972457e-93df-468d-b26b-7a353f4ef487"],
Cell[CellGroupData[{
Cell[242817, 5331, 495, 11, 30, "Input",ExpressionUUID->"5a3c05e7-5546-4635-b085-c0e377c4e406"],
Cell[243315, 5344, 11992, 242, 62, "Output",ExpressionUUID->"518e08ec-f5a9-4fd6-b541-9c59d73fc5b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[255344, 5591, 212, 4, 30, "Input",ExpressionUUID->"1d56cc9c-700d-40b4-b275-8a8ffaa4b0e0"],
Cell[255559, 5597, 5571, 156, 189, "Output",ExpressionUUID->"4431a047-1860-4d81-a3af-6bf6318ac166"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261167, 5758, 292, 6, 30, "Input",ExpressionUUID->"787f29c3-dd77-45d0-9bf9-b8f69cc676db"],
Cell[261462, 5766, 209, 4, 34, "Output",ExpressionUUID->"e4aab031-6813-459c-a0cd-118cbc6365d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261708, 5775, 982, 28, 75, "Input",ExpressionUUID->"84b6c2ba-9899-42dd-878c-6336cbd081b4"],
Cell[262693, 5805, 4630, 134, 167, "Output",ExpressionUUID->"2efb52f2-2e33-498e-a8c3-089375425416"]
}, Open  ]],
Cell[267338, 5942, 177, 3, 35, "Text",ExpressionUUID->"d486fb96-390e-478a-b6c3-8ddeea37be4c"],
Cell[CellGroupData[{
Cell[267540, 5949, 259, 5, 30, "Input",ExpressionUUID->"1a9d2ee1-264f-4def-a027-4f8474061015"],
Cell[267802, 5956, 207, 4, 34, "Output",ExpressionUUID->"ad7986d2-4278-4c27-b02c-90a2fbb10306"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[268058, 5966, 171, 3, 54, "Subsection",ExpressionUUID->"f4aafe88-fa16-45f2-8ba5-fa1d4c77208f"],
Cell[268232, 5971, 176, 3, 35, "Text",ExpressionUUID->"8e6e76b9-188a-4c85-8f60-111065d6cc69"],
Cell[CellGroupData[{
Cell[268433, 5978, 705, 20, 30, "Input",ExpressionUUID->"398ad519-a901-442f-8655-c0df5c52f44c"],
Cell[269141, 6000, 2025, 48, 51, "Output",ExpressionUUID->"56fe248c-64d5-4931-841e-cc1d6d3dc357"]
}, Open  ]],
Cell[CellGroupData[{
Cell[271203, 6053, 235, 5, 29, "Input",ExpressionUUID->"ff0f51f9-ee3f-422f-9e4a-ab500556a69d"],
Cell[271441, 6060, 2462, 58, 81, "Output",ExpressionUUID->"40158e58-014c-485b-84c7-f30e9c64ebb9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273940, 6123, 805, 20, 29, "Input",ExpressionUUID->"fe937f34-29f6-481c-a03b-9f0b129835af"],
Cell[274748, 6145, 1685, 30, 33, "Output",ExpressionUUID->"c49f2f7b-64e2-4892-82f1-8c3bb7cf0c1f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[276470, 6180, 250, 5, 29, "Input",ExpressionUUID->"6a448a75-412f-41ff-9ad5-dbb68656d95f"],
Cell[276723, 6187, 2586, 60, 85, "Output",ExpressionUUID->"52e7a2bf-40c8-455b-8c95-275d0629bf9a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[279346, 6252, 756, 20, 29, "Input",ExpressionUUID->"66a88cc5-7485-49e0-b676-b3546d2e75e2"],
Cell[280105, 6274, 1657, 30, 33, "Output",ExpressionUUID->"66d49c37-9abc-4992-99a1-a0fecb839ed4"]
}, Open  ]],
Cell[281777, 6307, 193, 3, 35, "Text",ExpressionUUID->"52d8537e-671a-4ba5-b29c-ccc2e2369266"],
Cell[CellGroupData[{
Cell[281995, 6314, 198, 4, 29, "Input",ExpressionUUID->"9212425b-c884-4e3e-adb8-3351aad96a52"],
Cell[282196, 6320, 5062, 90, 97, "Output",ExpressionUUID->"5a761a3d-5ee4-4ad5-be45-94ee7704aa35"]
}, Open  ]],
Cell[287273, 6413, 257, 6, 35, "Text",ExpressionUUID->"fbbd3b1c-cdd8-44be-ac02-8977f057bbc6"],
Cell[CellGroupData[{
Cell[287555, 6423, 417, 9, 29, "Input",ExpressionUUID->"ecba03b0-93e7-471e-b130-52c26202be96"],
Cell[287975, 6434, 4467, 79, 228, "Output",ExpressionUUID->"03eec5ea-d1ed-4ca4-8c86-39904bf74289"]
}, Open  ]],
Cell[292457, 6516, 195, 3, 35, "Text",ExpressionUUID->"b572bc16-8648-47d4-aac9-090cf69a9b9d"],
Cell[CellGroupData[{
Cell[292677, 6523, 413, 10, 29, "Input",ExpressionUUID->"35492735-479f-4bd1-b2f4-c3fe80e72c6f"],
Cell[293093, 6535, 4101, 73, 199, "Output",ExpressionUUID->"56df857d-917c-4564-ad7b-025079284081"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297231, 6613, 323, 8, 30, "Input",ExpressionUUID->"0a4ad435-be6c-43ea-be24-b878510e30e0"],
Cell[297557, 6623, 1695, 25, 145, "Output",ExpressionUUID->"acd1e5e6-8393-48bd-9e34-0c51460e9b16"]
}, Open  ]],
Cell[299267, 6651, 194, 3, 35, "Text",ExpressionUUID->"552fcdda-5c39-401b-99d1-a5837a26e4a3"],
Cell[299464, 6656, 1095, 40, 70, "Input",ExpressionUUID->"224f0a17-01b6-4593-a838-7a05718f0c91"],
Cell[CellGroupData[{
Cell[300584, 6700, 206, 5, 30, "Input",ExpressionUUID->"552ea2e1-1bf9-4ed2-a65b-7f99db654217"],
Cell[300793, 6707, 1638, 28, 34, "Output",ExpressionUUID->"a3394e72-dd8b-4cb4-a13f-9fee2827c290"]
}, Open  ]],
Cell[CellGroupData[{
Cell[302468, 6740, 357, 7, 30, "Input",ExpressionUUID->"dfb5e326-e96d-47b4-bd06-a784701653b8"],
Cell[302828, 6749, 4015, 97, 130, "Output",ExpressionUUID->"cb0a5612-ad0d-4c42-aa16-9de7a03d13d4"]
}, Open  ]],
Cell[306858, 6849, 293, 4, 35, "Text",ExpressionUUID->"68189830-ab36-4128-a5de-731b0db19983"],
Cell[CellGroupData[{
Cell[307176, 6857, 299, 7, 30, "Input",ExpressionUUID->"bdc88020-f9c6-42d9-9cd9-f080cb0cbb69"],
Cell[307478, 6866, 2690, 83, 104, "Output",ExpressionUUID->"24c502a1-322c-4b1b-98e8-cf6dad63ef61"]
}, Open  ]],
Cell[CellGroupData[{
Cell[310205, 6954, 414, 13, 30, "Input",ExpressionUUID->"43ddd6db-ec15-46d2-a80f-9b61ad5974a7"],
Cell[310622, 6969, 1188, 28, 83, "Output",ExpressionUUID->"2426087a-7e0b-418a-938b-9be6d3084e61"]
}, Open  ]],
Cell[311825, 7000, 434, 8, 58, "Text",ExpressionUUID->"9dd56372-d0f4-4e5d-8bd0-86ad4bb1c818"],
Cell[CellGroupData[{
Cell[312284, 7012, 807, 15, 30, "Input",ExpressionUUID->"3ec59178-d225-421a-9b38-5c64d13aa439"],
Cell[313094, 7029, 3323, 92, 104, "Output",ExpressionUUID->"de873c4b-59b3-465c-b222-f5a15e231669"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316454, 7126, 485, 15, 30, "Input",ExpressionUUID->"8c171959-ef67-47b9-8dd0-b6154ecb8ac7"],
Cell[316942, 7143, 1190, 28, 83, "Output",ExpressionUUID->"7b8943fd-1abc-44e7-8ace-c6bc82564e7f"]
}, Open  ]],
Cell[318147, 7174, 225, 5, 35, "Text",ExpressionUUID->"e36dfdf6-6bfb-43ab-aa50-7dc5ea635818"],
Cell[CellGroupData[{
Cell[318397, 7183, 324, 8, 30, "Input",ExpressionUUID->"51e0f199-e429-4df8-8464-61d1cdd42eaf"],
Cell[318724, 7193, 3879, 112, 196, "Output",ExpressionUUID->"a250afe4-8616-4c22-ab31-c6c24bc6ff40"]
}, Open  ]],
Cell[322618, 7308, 253, 4, 35, "Text",ExpressionUUID->"6c30a8a5-8126-4490-805a-c3e3cf8eee38"],
Cell[CellGroupData[{
Cell[322896, 7316, 291, 7, 30, "Input",ExpressionUUID->"005494a5-f91b-4946-ad53-80681cb74459"],
Cell[323190, 7325, 1808, 43, 79, "Output",ExpressionUUID->"e842bc6c-bce2-4ddc-be1c-07411f0b6446"]
}, Open  ]],
Cell[325013, 7371, 217, 4, 35, "Text",ExpressionUUID->"509fcb14-ae28-48af-8666-3349f200ef3b"],
Cell[CellGroupData[{
Cell[325255, 7379, 832, 21, 53, "Input",ExpressionUUID->"d5f9cea0-3d19-4461-8f59-4a499e6037de"],
Cell[326090, 7402, 1839, 36, 83, "Output",ExpressionUUID->"0f775a32-2ef8-401d-9814-b7a8a1c9542a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[327966, 7443, 212, 5, 30, "Input",ExpressionUUID->"de9a51f9-57fa-4149-a05b-de70f7d37295"],
Cell[328181, 7450, 1766, 35, 83, "Output",ExpressionUUID->"582d994d-3423-44f1-817b-72287c427001"]
}, Open  ]],
Cell[CellGroupData[{
Cell[329984, 7490, 127, 1, 30, "Input",ExpressionUUID->"b352c0be-600f-4ae3-b9a7-4c56fef915ed"],
Cell[330114, 7493, 4981, 88, 93, "Output",ExpressionUUID->"cf8c8a0a-0318-4236-a64c-dfffa9587243"]
}, Open  ]],
Cell[CellGroupData[{
Cell[335132, 7586, 256, 5, 45, "Subsubsection",ExpressionUUID->"6f886d0a-44f3-4125-9941-8fd2ab433932"],
Cell[335391, 7593, 521, 10, 58, "Text",ExpressionUUID->"887d1e71-2938-4f08-8c0a-cb004cfb5c0f"],
Cell[335915, 7605, 1341, 34, 43, "Input",ExpressionUUID->"f5bc932a-43a4-4412-b9b9-839659f7c478"],
Cell[CellGroupData[{
Cell[337281, 7643, 276, 6, 30, "Input",ExpressionUUID->"0c0aa691-acf5-48c0-a00c-1a3d078a9f41"],
Cell[337560, 7651, 4126, 113, 201, "Output",ExpressionUUID->"98ad346e-2faf-4095-8ca9-66a2dc66bffc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[341735, 7770, 177, 3, 45, "Subsubsection",ExpressionUUID->"552eb4c6-a07c-406d-ac82-6bababe2bc37"],
Cell[341915, 7775, 225, 5, 35, "Text",ExpressionUUID->"17c0145a-4c34-4535-8214-dbb61298c9af"],
Cell[CellGroupData[{
Cell[342165, 7784, 348, 8, 30, "Input",ExpressionUUID->"80b7b5c4-933d-4d4c-88d8-7d1887067ded"],
Cell[342516, 7794, 1504, 47, 107, "Output",ExpressionUUID->"91736a38-b766-4d33-9b4c-461c74ff83ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[344057, 7846, 260, 5, 30, "Input",ExpressionUUID->"10d81b3c-69a6-4b9d-a16d-5af86c9893fb"],
Cell[344320, 7853, 2800, 86, 178, "Output",ExpressionUUID->"093f2587-b236-44be-960a-3034b6283e97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[347157, 7944, 973, 27, 75, "Input",ExpressionUUID->"ac3bebda-cc11-44c7-a3c7-ea8c9705e7f7"],
Cell[348133, 7973, 1290, 37, 55, "Output",ExpressionUUID->"ca464287-8b8d-4663-aa51-b19de878c3f8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[349484, 8017, 190, 3, 54, "Subsection",ExpressionUUID->"6a2b2590-e8d2-4953-be08-7c786bc21851"],
Cell[349677, 8022, 249, 4, 35, "Text",ExpressionUUID->"618f243f-8ad9-4f19-83e8-fcba9a0c0e2b"],
Cell[349929, 8028, 359, 8, 29, "Input",ExpressionUUID->"d82e3224-3869-40dd-a6a0-61d315bc11c5"],
Cell[CellGroupData[{
Cell[350313, 8040, 411, 9, 29, "Input",ExpressionUUID->"649d4cc5-26ec-47e6-81a2-f097d1e4e6ad"],
Cell[350727, 8051, 895, 13, 33, "Output",ExpressionUUID->"7b96daa3-cbf3-41c5-a2e2-4f64909b6920"]
}, Open  ]],
Cell[CellGroupData[{
Cell[351659, 8069, 192, 4, 29, "Input",ExpressionUUID->"259c2137-70df-4849-9c89-c85117e24587"],
Cell[351854, 8075, 849, 13, 33, "Output",ExpressionUUID->"51b0204b-2f79-4476-8e69-85ca071b2810"]
}, Open  ]],
Cell[CellGroupData[{
Cell[352740, 8093, 124, 1, 29, "Input",ExpressionUUID->"99c7f96c-ac09-44b4-8ed5-872e3b324668"],
Cell[352867, 8096, 838, 13, 33, "Output",ExpressionUUID->"97bd5c69-6de8-4ccb-ab66-e098821c0db0"]
}, Open  ]],
Cell[353720, 8112, 457, 9, 35, "Text",ExpressionUUID->"e76b2d28-0899-4691-9c48-825c5094e9bc"],
Cell[CellGroupData[{
Cell[354202, 8125, 309, 8, 29, "Input",ExpressionUUID->"63fcd6ba-42b0-4422-b325-dbe775d6fe74"],
Cell[354514, 8135, 843, 13, 33, "Output",ExpressionUUID->"107a2903-3fa5-46b7-a96b-2eaabe4c4772"]
}, Open  ]],
Cell[CellGroupData[{
Cell[355394, 8153, 192, 4, 29, "Input",ExpressionUUID->"3417cb8e-9ecd-4b98-9abf-79749780c69d"],
Cell[355589, 8159, 771, 12, 33, "Output",ExpressionUUID->"3815311b-8c1b-4a5d-a428-fdacbc481566"]
}, Open  ]],
Cell[CellGroupData[{
Cell[356397, 8176, 225, 5, 29, "Input",ExpressionUUID->"2680aedd-2f83-481f-a134-b661e77f1c84"],
Cell[356625, 8183, 773, 12, 33, "Output",ExpressionUUID->"5e8ef522-62d8-4c2a-a16a-298a53ffddc4"]
}, Open  ]],
Cell[357413, 8198, 526, 9, 58, "Text",ExpressionUUID->"269c8dc1-cfd8-4847-a863-f0b5d7768812"],
Cell[CellGroupData[{
Cell[357964, 8211, 375, 10, 29, "Input",ExpressionUUID->"501ab072-2ee5-4399-964f-7b88997cd6c9"],
Cell[358342, 8223, 370, 6, 33, "Output",ExpressionUUID->"cb4ad6ea-ddc2-45e8-8f65-a50701ce8ebf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[358749, 8234, 121, 1, 29, "Input",ExpressionUUID->"df5e3658-a258-480b-8d99-d69ceb573688"],
Cell[358873, 8237, 347, 6, 33, "Output",ExpressionUUID->"42fc5b5a-f2be-491f-9afb-b9f621577a55"]
}, Open  ]],
Cell[CellGroupData[{
Cell[359257, 8248, 171, 4, 29, "Input",ExpressionUUID->"c96ff858-3aa0-490d-be59-84a41e1d819c"],
Cell[359431, 8254, 365, 6, 33, "Output",ExpressionUUID->"474a9cbb-83e3-41fb-b842-37f02ec0fe65"]
}, Open  ]],
Cell[359811, 8263, 468, 7, 35, "Text",ExpressionUUID->"c3ec02ec-cc44-4bab-a002-da22aab80cf9"],
Cell[360282, 8272, 194, 5, 29, "Input",ExpressionUUID->"50a46953-1be2-4aa6-9894-d7c2440e35a3"],
Cell[CellGroupData[{
Cell[360501, 8281, 245, 6, 29, "Input",ExpressionUUID->"5040d044-5139-4fa9-beba-84dd1f5a137a"],
Cell[360749, 8289, 423, 7, 33, "Output",ExpressionUUID->"d7b99895-75da-4e57-8029-3d8787901aff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[361209, 8301, 121, 1, 29, "Input",ExpressionUUID->"c1e0625f-c740-49de-978a-0a8d85e519a4"],
Cell[361333, 8304, 394, 6, 34, "Output",ExpressionUUID->"a7c42542-a4ad-430a-87ac-849f81accb5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[361764, 8315, 124, 1, 30, "Input",ExpressionUUID->"943b1eb1-dabf-4192-a77c-61f2fd3b5fb7"],
Cell[361891, 8318, 387, 6, 34, "Output",ExpressionUUID->"bbcee5c6-8635-4f08-8028-2d62a8cd1d67"]
}, Open  ]],
Cell[362293, 8327, 361, 8, 30, "Input",ExpressionUUID->"6d74c389-13f3-40cc-a28e-0f82653529a0"],
Cell[CellGroupData[{
Cell[362679, 8339, 365, 9, 30, "Input",ExpressionUUID->"9138623c-06ec-4b55-8a9a-1ab921a3ec21"],
Cell[363047, 8350, 830, 12, 34, "Output",ExpressionUUID->"f0440dbc-78c8-4ba3-aeaa-58c6f944f81e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[363914, 8367, 192, 4, 30, "Input",ExpressionUUID->"bc4d48e6-14ff-415f-9631-69a190243f21"],
Cell[364109, 8373, 767, 12, 34, "Output",ExpressionUUID->"9f6da126-6b4f-4740-87bc-b9074270a162"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364913, 8390, 195, 4, 30, "Input",ExpressionUUID->"dd926822-4e96-4e61-b04c-ac2afe3d93ea"],
Cell[365111, 8396, 741, 11, 34, "Output",ExpressionUUID->"152e922b-6425-4d7e-9b1e-a256a276e164"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[365901, 8413, 168, 3, 54, "Subsection",ExpressionUUID->"220c1b8e-9559-4683-bc61-0d7fcca233c4"],
Cell[366072, 8418, 344, 7, 35, "Text",ExpressionUUID->"c9e8898e-0297-4b76-bdb2-8199d2de0899"],
Cell[366419, 8427, 379, 8, 30, "Input",ExpressionUUID->"ce76813e-a994-4ac6-a879-cc5afeead1d5"],
Cell[366801, 8437, 176, 3, 35, "Text",ExpressionUUID->"0bd3a0ee-3fab-4d0f-91dd-5478e640f017"],
Cell[CellGroupData[{
Cell[367002, 8444, 529, 15, 30, "Input",ExpressionUUID->"eca659d2-f70f-4055-a605-00bc8910012f"],
Cell[367534, 8461, 975, 18, 34, "Output",ExpressionUUID->"9b69aa3f-cde9-414b-8825-306058aff8fc"]
}, Open  ]],
Cell[368524, 8482, 181, 3, 35, "Text",ExpressionUUID->"33a126ac-53de-40e6-994a-db76d5330197"],
Cell[368708, 8487, 239, 6, 30, "Input",ExpressionUUID->"dbabb4a0-93a7-432e-aa9d-a4ae3de8726c"],
Cell[CellGroupData[{
Cell[368972, 8497, 583, 16, 30, "Input",ExpressionUUID->"6f229c0b-6504-4961-a0e9-c1bb48c102d8"],
Cell[369558, 8515, 1638, 35, 57, "Output",ExpressionUUID->"9ea7d5b5-0de0-41b0-b31b-bd0a5c69d3c7"]
}, Open  ]],
Cell[371211, 8553, 287, 6, 58, "Text",ExpressionUUID->"4b10a7ac-4dce-4b45-b70c-0081c3234223"],
Cell[CellGroupData[{
Cell[371523, 8563, 312, 7, 30, "Input",ExpressionUUID->"b83ac6f7-05ec-4495-ab2e-5c923e6a5809"],
Cell[371838, 8572, 777, 12, 34, "Output",ExpressionUUID->"3efa27ec-733d-4a4a-9429-af41e0c77788"]
}, Open  ]],
Cell[372630, 8587, 173, 3, 35, "Text",ExpressionUUID->"72e2b56d-a666-43a3-a0d3-5d51bee8133d"],
Cell[CellGroupData[{
Cell[372828, 8594, 576, 17, 30, "Input",ExpressionUUID->"09e58ba9-00e3-4f34-b5fa-54c9a769705a"],
Cell[373407, 8613, 1087, 21, 34, "Output",ExpressionUUID->"fec0f48d-43d7-464a-88ca-8a47996c31a0"]
}, Open  ]],
Cell[374509, 8637, 247, 6, 30, "Input",ExpressionUUID->"cd96b01f-11db-4ae4-b401-71331329d86c"],
Cell[CellGroupData[{
Cell[374781, 8647, 192, 4, 30, "Input",ExpressionUUID->"cde0741f-aa31-42fe-82e0-844a27646649"],
Cell[374976, 8653, 700, 11, 34, "Output",ExpressionUUID->"def8e7c3-17fa-47be-b9be-4a3218f4e7e9"]
}, Open  ]],
Cell[375691, 8667, 496, 9, 58, "Text",ExpressionUUID->"bb358190-dee5-4e27-9aac-c04afb0c206b"],
Cell[CellGroupData[{
Cell[376212, 8680, 232, 6, 30, "Input",ExpressionUUID->"a41ac9d1-17d1-4a83-88b5-a24bc1d412d2"],
Cell[376447, 8688, 6877, 120, 310, "Output",ExpressionUUID->"6a233814-54d3-4e36-91b4-fdee04715b4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[383361, 8813, 275, 7, 30, "Input",ExpressionUUID->"d7874432-e9fc-4a69-bf40-a394ed813c19"],
Cell[383639, 8822, 9954, 164, 260, "Output",ExpressionUUID->"2ff49722-b8c5-4239-89ff-340a5f8910a9"]
}, Open  ]],
Cell[393608, 8989, 184, 3, 35, "Text",ExpressionUUID->"ca73d366-e7ac-4e75-9b97-2abf3d8a8e73"],
Cell[393795, 8994, 183, 3, 35, "Text",ExpressionUUID->"b40118b4-8957-4589-9c03-7da2f077f735"],
Cell[393981, 8999, 539, 14, 30, "Input",ExpressionUUID->"4310a499-d5d0-415e-820e-00b984fb69e8"],
Cell[CellGroupData[{
Cell[394545, 9017, 192, 4, 30, "Input",ExpressionUUID->"f98e72e7-d0b0-4223-a4cf-9ec4967bec4a"],
Cell[394740, 9023, 641, 10, 34, "Output",ExpressionUUID->"5f5d377f-5d5d-4382-b97d-69e884d8905b"]
}, Open  ]],
Cell[395396, 9036, 409, 8, 58, "Text",ExpressionUUID->"b17f1da4-b11a-44b8-a3a0-8d758723374c"],
Cell[395808, 9046, 981, 25, 97, "Input",ExpressionUUID->"ffbb014f-ddad-4d4e-a20e-6d9c71c90c2e"],
Cell[396792, 9073, 177, 3, 35, "Text",ExpressionUUID->"6efef395-1f52-4f27-97f4-3bc29ddcf579"],
Cell[CellGroupData[{
Cell[396994, 9080, 582, 17, 30, "Input",ExpressionUUID->"75cd1d46-aed9-4690-aead-a6f67f9f2bfe"],
Cell[397579, 9099, 982, 20, 34, "Output",ExpressionUUID->"13529875-e3c9-4507-8284-e39781c50760"]
}, Open  ]],
Cell[398576, 9122, 210, 3, 35, "Text",ExpressionUUID->"3a20c2af-357c-40e3-adf4-efdd04df470e"],
Cell[398789, 9127, 290, 7, 30, "Input",ExpressionUUID->"a246e259-9477-4356-8a8e-ed9f23ab2c44"],
Cell[CellGroupData[{
Cell[399104, 9138, 221, 5, 30, "Input",ExpressionUUID->"845fed52-0ab6-49d8-8266-475f1fa57c40"],
Cell[399328, 9145, 2888, 90, 79, "Output",ExpressionUUID->"89b256ea-af60-413e-9aaa-0d24ca17b949"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[402265, 9241, 167, 3, 54, "Subsection",ExpressionUUID->"d15ae2db-d663-4b27-b7d9-4f8da93f1a46"],
Cell[402435, 9246, 333, 7, 35, "Text",ExpressionUUID->"1661435d-1cc2-4789-a226-14f29912dbd3"],
Cell[CellGroupData[{
Cell[402793, 9257, 301, 7, 30, "Input",ExpressionUUID->"a6acc86e-e869-4de2-bfc1-7b89628cdfa1"],
Cell[403097, 9266, 1700, 40, 57, "Output",ExpressionUUID->"dcf1a11f-632e-4a40-b722-bbc8ec6085bd"]
}, Open  ]],
Cell[404812, 9309, 304, 7, 35, "Text",ExpressionUUID->"c5d5d36e-fd77-49b1-9bd5-f441b82dc9f4"],
Cell[CellGroupData[{
Cell[405141, 9320, 357, 10, 30, "Input",ExpressionUUID->"4f5b3bb6-8f66-438f-b8b3-cd58280b045f"],
Cell[405501, 9332, 952, 18, 34, "Output",ExpressionUUID->"18d6438f-f173-4a7e-87f0-f1d4b89672d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[406490, 9355, 477, 14, 30, "Input",ExpressionUUID->"5451ed0b-b5ee-4cd9-b9aa-2a2f46508fca"],
Cell[CellGroupData[{
Cell[406992, 9373, 828, 12, 24, "Print",ExpressionUUID->"1acc42aa-abcc-45cc-8ae7-9ef3b1e56336"],
Cell[407823, 9387, 828, 12, 24, "Print",ExpressionUUID->"db466d79-31e2-455c-b002-d8dcaf57baed"],
Cell[408654, 9401, 827, 12, 24, "Print",ExpressionUUID->"ddd81631-bc4d-42ee-b2b9-ed821134fd5b"]
}, Open  ]]
}, Open  ]],
Cell[409508, 9417, 184, 3, 35, "Text",ExpressionUUID->"0f81594e-beb8-41c0-9e27-6cd0c4ffd3be"],
Cell[409695, 9422, 245, 6, 30, "Input",ExpressionUUID->"0afa16ff-eb55-4e25-a78a-686ba8f17c30"],
Cell[CellGroupData[{
Cell[409965, 9432, 194, 4, 30, "Input",ExpressionUUID->"9e07807e-8af9-4c00-96c5-e083744ab40c"],
Cell[410162, 9438, 815, 12, 34, "Output",ExpressionUUID->"ca5a1fc4-234c-44aa-a820-22cbab2fa0b1"]
}, Open  ]],
Cell[410992, 9453, 216, 5, 35, "Text",ExpressionUUID->"f86ff5d2-5d1a-464b-91ef-0debc10c8a55"],
Cell[CellGroupData[{
Cell[411233, 9462, 323, 8, 30, "Input",ExpressionUUID->"f5c2cc8c-2c2f-4033-a82e-f85cad5ae313"],
Cell[411559, 9472, 6994, 126, 173, "Output",ExpressionUUID->"dc40b5c3-ce0b-40b1-b90f-89553071338d"]
}, Open  ]],
Cell[418568, 9601, 183, 3, 35, "Text",ExpressionUUID->"2c67deac-b8bd-47f9-9562-4c9838d2881b"],
Cell[418754, 9606, 3310, 85, 174, "Input",ExpressionUUID->"8690df70-b78d-4374-9387-d09c9df64e39"],
Cell[CellGroupData[{
Cell[422089, 9695, 586, 17, 29, "Input",ExpressionUUID->"6ff91d12-f2bd-443c-a20d-d907f3fb5575"],
Cell[422678, 9714, 1840, 46, 55, "Output",ExpressionUUID->"44cb0785-c0df-4652-aa1a-9a32042c7aa4"]
}, Open  ]],
Cell[424533, 9763, 236, 6, 35, "Text",ExpressionUUID->"a4dc0a6a-e1a9-4106-ac52-47d2d2392a1f"],
Cell[CellGroupData[{
Cell[424794, 9773, 445, 10, 29, "Input",ExpressionUUID->"403b7bd8-28c6-4ff9-839c-03466f83c59d"],
Cell[425242, 9785, 1360, 33, 33, "Output",ExpressionUUID->"28471a0f-7387-4dc9-9c92-dcaba6cd7345"]
}, Open  ]],
Cell[426617, 9821, 205, 3, 35, "Text",ExpressionUUID->"03e496d3-5867-4a24-ab16-604beccbff80"],
Cell[CellGroupData[{
Cell[426847, 9828, 364, 8, 29, "Input",ExpressionUUID->"ece1a7c4-2c93-466b-a250-514cfbfbcaa4"],
Cell[427214, 9838, 1121, 29, 33, "Output",ExpressionUUID->"c2643e63-9143-42b4-b741-d932bb6056e3"]
}, Open  ]],
Cell[428350, 9870, 545, 9, 58, "Text",ExpressionUUID->"8bbcfa2f-7412-49a3-b5f5-f263fa9a8af4"],
Cell[CellGroupData[{
Cell[428920, 9883, 413, 9, 29, "Input",ExpressionUUID->"78aea2f4-a1c9-4913-af71-13790053eee2"],
Cell[429336, 9894, 1538, 42, 55, "Output",ExpressionUUID->"5befc15b-2f29-4114-a0e9-e68d61613515"]
}, Open  ]],
Cell[430889, 9939, 417, 8, 58, "Text",ExpressionUUID->"91f55a76-3668-42aa-b465-42d3b6438870"],
Cell[CellGroupData[{
Cell[431331, 9951, 435, 13, 29, "Input",ExpressionUUID->"04c70313-a730-489b-a292-17d135ad29d1"],
Cell[431769, 9966, 1267, 38, 55, "Output",ExpressionUUID->"eef37c81-d36c-4c24-ad6f-552a685c2430"]
}, Open  ]],
Cell[433051, 10007, 438, 9, 29, "Input",ExpressionUUID->"14976b93-1477-4332-9e30-36a0ecc86e29"],
Cell[CellGroupData[{
Cell[433514, 10020, 335, 7, 29, "Input",ExpressionUUID->"b0f73c52-2525-4d6c-a325-821cae2fc26e"],
Cell[433852, 10029, 1124, 32, 55, "Output",ExpressionUUID->"22d92aef-df71-4210-92c8-59863cd56d07"]
}, Open  ]],
Cell[CellGroupData[{
Cell[435013, 10066, 386, 7, 29, "Input",ExpressionUUID->"75ceb39b-b86e-4c97-99d2-c9f7eec1bc7c"],
Cell[435402, 10075, 1459, 40, 55, "Output",ExpressionUUID->"5ecd4a21-7067-485e-a3a4-c599252c5a5f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[436910, 10121, 171, 3, 54, "Subsection",ExpressionUUID->"00be9a5d-6e47-49f4-8c12-dd0ff0fcd6a7"],
Cell[437084, 10126, 218, 5, 35, "Text",ExpressionUUID->"ddd110aa-d3a7-4f4d-9c9d-446a7dbe0470"],
Cell[CellGroupData[{
Cell[437327, 10135, 1583, 43, 51, "Input",ExpressionUUID->"1271d227-cf3d-4583-9b7e-c2dfbe8c0baf"],
Cell[438913, 10180, 2449, 55, 79, "Output",ExpressionUUID->"4d7e16a2-9949-4014-a162-04648744c516"]
}, Open  ]],
Cell[CellGroupData[{
Cell[441399, 10240, 197, 4, 29, "Input",ExpressionUUID->"55104d62-31b1-40c2-84fb-b190f811169e"],
Cell[441599, 10246, 6042, 103, 157, "Output",ExpressionUUID->"f0c958c5-7bca-4d85-889b-5e62e8932a9b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[447678, 10354, 543, 10, 29, "Input",ExpressionUUID->"3c218d11-f03d-413b-813c-8d59fe60c6cf"],
Cell[448224, 10366, 1651, 34, 55, "Output",ExpressionUUID->"fbc32646-aba7-495f-964b-93b7d2ce90a9"]
}, Open  ]],
Cell[449890, 10403, 403, 8, 35, "Text",ExpressionUUID->"163b658f-cb2c-4708-86da-c05a9cd67d87"],
Cell[CellGroupData[{
Cell[450318, 10415, 290, 6, 29, "Input",ExpressionUUID->"676705f2-1aa3-4312-9371-d076804c155a"],
Cell[450611, 10423, 2008, 57, 95, "Output",ExpressionUUID->"2d35d985-de64-4e0b-aa2a-e19a858eed56"]
}, Open  ]],
Cell[CellGroupData[{
Cell[452656, 10485, 252, 5, 29, "Input",ExpressionUUID->"73c5cc67-de14-4add-b14d-a2cc49cfbabf"],
Cell[452911, 10492, 4425, 77, 140, "Output",ExpressionUUID->"78c404e3-c264-4463-9bc0-c2bda65cc265"]
}, Open  ]],
Cell[457351, 10572, 704, 17, 51, "Input",ExpressionUUID->"343fa44a-e15d-467e-91bd-4aba2211b238"],
Cell[CellGroupData[{
Cell[458080, 10593, 485, 14, 29, "Input",ExpressionUUID->"3e9d5ebe-f2a9-4693-8245-ae34df009d80"],
Cell[458568, 10609, 1626, 43, 55, "Output",ExpressionUUID->"14298fbd-806c-4ed0-9de2-75209da14f37"]
}, Open  ]],
Cell[460209, 10655, 198, 3, 35, "Text",ExpressionUUID->"31ef9e26-a2d1-4bf0-9a42-a9a6c35dcfa3"],
Cell[CellGroupData[{
Cell[460432, 10662, 848, 23, 42, "Input",ExpressionUUID->"1ef13335-0561-4670-8cd5-4d560f7c9e82"],
Cell[461283, 10687, 8212, 168, 261, "Output",ExpressionUUID->"cc03cc90-e3bc-4d1a-8e20-0f030f3d70ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[469532, 10860, 234, 5, 29, "Input",ExpressionUUID->"cfa094ca-cee9-4e80-adfa-6969afa25d1d"],
Cell[469769, 10867, 384, 6, 33, "Output",ExpressionUUID->"e125bbc1-e31a-4f89-945b-8c9b9f537f99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[470190, 10878, 218, 5, 29, "Input",ExpressionUUID->"6f7f8f3c-534c-4acd-847d-befd3ad42a51"],
Cell[470411, 10885, 418, 7, 33, "Output",ExpressionUUID->"d43ade35-71e9-494a-b3d5-5334a8dc38ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[470866, 10897, 247, 5, 29, "Input",ExpressionUUID->"5deebde4-b215-4153-8efa-8bb1fbdf6279"],
Cell[471116, 10904, 383, 6, 33, "Output",ExpressionUUID->"fe743e21-6b94-456b-9818-01d48a519370"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[471548, 10916, 190, 3, 54, "Subsection",ExpressionUUID->"6c97637c-6551-4cbf-b3f0-ee541fbdaa9c"],
Cell[471741, 10921, 211, 5, 35, "Text",ExpressionUUID->"85f84324-f7bf-480f-a8a9-6c91d84ad7dc"],
Cell[CellGroupData[{
Cell[471977, 10930, 1684, 47, 71, "Input",ExpressionUUID->"2b2f8276-0446-489d-86e0-057bcfd87ce5"],
Cell[473664, 10979, 1779, 41, 55, "Output",ExpressionUUID->"33d3783e-71e0-473c-8fae-3ffdd0d5cdb9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[475480, 11025, 174, 4, 29, "Input",ExpressionUUID->"306f788b-fb41-47df-a4da-dad4a1e037a1"],
Cell[475657, 11031, 5920, 103, 172, "Output",ExpressionUUID->"fdb1fc1c-50ad-4893-aff2-22f488560fb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[481614, 11139, 525, 10, 29, "Input",ExpressionUUID->"e0bbfba7-de19-46b6-ae12-7ad9d42b6fa5"],
Cell[482142, 11151, 6494, 139, 178, "Output",ExpressionUUID->"f9755b3d-784d-48cf-a4b1-08c2874b55fa"]
}, Open  ]],
Cell[488651, 11293, 375, 7, 35, "Text",ExpressionUUID->"fd628671-bef3-4e40-b23b-1567ed6febb6"],
Cell[489029, 11302, 255, 7, 29, "Input",ExpressionUUID->"cc7d44d6-c315-44bb-8ee2-6406832dcdc6"],
Cell[CellGroupData[{
Cell[489309, 11313, 1004, 29, 51, "Input",ExpressionUUID->"7f95456d-9a0d-41c4-aa0e-4c1a2b2b109e"],
Cell[490316, 11344, 1776, 44, 55, "Output",ExpressionUUID->"e4af81fe-bccf-4c44-8c5b-6b09c4a0d209"]
}, Open  ]],
Cell[492107, 11391, 217, 5, 35, "Text",ExpressionUUID->"5e093caf-a4c8-431f-88a5-d3052438174c"],
Cell[CellGroupData[{
Cell[492349, 11400, 292, 7, 29, "Input",ExpressionUUID->"531b8b99-8008-4e82-8c85-ba9edbfb6ec7"],
Cell[492644, 11409, 4858, 109, 178, "Output",ExpressionUUID->"d0f63aa0-f34e-4ddd-ac64-508733226bf5"]
}, Open  ]],
Cell[497517, 11521, 170, 3, 35, "Text",ExpressionUUID->"282ba5b7-8cc8-48c5-a21c-14d88c65ef65"],
Cell[CellGroupData[{
Cell[497712, 11528, 616, 19, 29, "Input",ExpressionUUID->"038216d1-2671-48e0-814f-dfba8b431d88"],
Cell[498331, 11549, 1543, 42, 55, "Output",ExpressionUUID->"595879e2-dbd7-4d2a-94bb-0bd909fff0fe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[499911, 11596, 615, 19, 29, "Input",ExpressionUUID->"a2fcc405-c97f-49a2-82fc-3716cfe89448"],
Cell[500529, 11617, 1540, 42, 55, "Output",ExpressionUUID->"6144186c-97ff-451d-b753-527683ce58b4"]
}, Open  ]],
Cell[502084, 11662, 237, 6, 35, "Text",ExpressionUUID->"df5b36b0-98a4-445f-b78a-38f813f519ff"],
Cell[502324, 11670, 2168, 52, 174, "Input",ExpressionUUID->"1a11ad10-bf23-4614-9dd1-39d907c783bc"],
Cell[504495, 11724, 261, 7, 29, "Input",ExpressionUUID->"2da782b2-ca78-483e-91b5-af4fd6c36255"],
Cell[CellGroupData[{
Cell[504781, 11735, 230, 5, 29, "Input",ExpressionUUID->"6d9dbed6-64ae-4f0b-941d-8cedaaf22935"],
Cell[CellGroupData[{
Cell[505036, 11744, 1522, 35, 38, "Print",ExpressionUUID->"2a2216e6-c51d-4118-9c94-0891303dd2c7"],
Cell[506561, 11781, 1541, 37, 38, "Print",ExpressionUUID->"8800e53a-9a7c-47aa-9888-e2bfa79e6823"]
}, Open  ]]
}, Open  ]],
Cell[508129, 11822, 449, 8, 58, "Text",ExpressionUUID->"50200bde-217e-482c-bae5-80337ad70cb7"],
Cell[508581, 11832, 442, 10, 29, "Input",ExpressionUUID->"69832550-2c4d-4ef4-9973-e57ca67eec1b"],
Cell[CellGroupData[{
Cell[509048, 11846, 194, 4, 29, "Input",ExpressionUUID->"879f3755-4d14-4cf0-ae68-886c9b23a002"],
Cell[509245, 11852, 236, 4, 33, "Output",ExpressionUUID->"b8d6ad8d-127a-4a37-a32f-737ebc36d0f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[509518, 11861, 230, 4, 29, "Input",ExpressionUUID->"311407b3-a08e-43d8-bda6-2ef83e093ecc"],
Cell[509751, 11867, 16113, 395, 632, "Output",ExpressionUUID->"7207a000-1bb7-4f29-aeee-ae962876a322"]
}, Open  ]],
Cell[525879, 12265, 185, 3, 35, "Text",ExpressionUUID->"c22f08c8-e681-4ed7-98d2-5e45e7922b02"],
Cell[CellGroupData[{
Cell[526089, 12272, 305, 7, 29, "Input",ExpressionUUID->"6a7558c3-054b-4e17-a8a4-613869f35495"],
Cell[526397, 12281, 9122, 156, 235, "Output",ExpressionUUID->"40dc58df-0b11-4b81-afcd-510ffbefffa9"]
}, Open  ]],
Cell[535534, 12440, 178, 3, 35, "Text",ExpressionUUID->"73e441dc-374b-401e-bd9a-d59ebb4bb20f"],
Cell[CellGroupData[{
Cell[535737, 12447, 373, 8, 29, "Input",ExpressionUUID->"980c117e-2904-411a-9aca-cded303f3536"],
Cell[536113, 12457, 4885, 89, 303, "Output",ExpressionUUID->"82f76bdc-0522-4f0a-817b-bc7156cd4699"]
}, Open  ]],
Cell[541013, 12549, 168, 3, 35, "Text",ExpressionUUID->"bf7c4511-8747-463a-bf59-217332110a0e"],
Cell[541184, 12554, 266, 7, 29, "Input",ExpressionUUID->"0849ed08-042c-404e-ac88-addbeac5dfd1"],
Cell[CellGroupData[{
Cell[541475, 12565, 197, 4, 29, "Input",ExpressionUUID->"be8f5b4d-86d4-41eb-ab4b-429579f36a12"],
Cell[541675, 12571, 214, 4, 33, "Output",ExpressionUUID->"79f12447-d235-4988-8884-363f1b132979"]
}, Open  ]],
Cell[541904, 12578, 327, 7, 35, "Text",ExpressionUUID->"1f315442-c8e6-4c6b-b52f-910fd81fcaef"],
Cell[542234, 12587, 358, 11, 29, "Input",ExpressionUUID->"8da1ad8c-5cc8-415a-a2dd-93ce2bb1d9cc"],
Cell[CellGroupData[{
Cell[542617, 12602, 295, 7, 29, "Input",ExpressionUUID->"d065c1e2-9741-47dd-b6f4-7d11380010f5"],
Cell[542915, 12611, 1219, 37, 55, "Output",ExpressionUUID->"ff823c27-e4c2-42c4-860e-40a4347e74e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[544171, 12653, 295, 7, 29, "Input",ExpressionUUID->"38e50b46-df69-4676-aa02-3efe13f3e490"],
Cell[544469, 12662, 1218, 37, 55, "Output",ExpressionUUID->"84c1d7a7-2ea6-45d2-97f6-94d07352eb48"]
}, Open  ]],
Cell[545702, 12702, 212, 5, 35, "Text",ExpressionUUID->"a4601121-e6f4-45ee-94a0-293864477b6b"],
Cell[545917, 12709, 238, 6, 29, "Input",ExpressionUUID->"818fb037-97f6-4cf2-822e-18489a3c399a"],
Cell[CellGroupData[{
Cell[546180, 12719, 159, 3, 29, "Input",ExpressionUUID->"d81ba6f7-8524-415b-bbc1-a7c3425a8e96"],
Cell[CellGroupData[{
Cell[546364, 12726, 3594, 76, 97, "Print",ExpressionUUID->"775199f1-1074-4e56-9ca5-3773b4e5a330"],
Cell[549961, 12804, 3610, 76, 97, "Print",ExpressionUUID->"1b7bfcb0-db95-41f9-a86f-ed18c75dfa7e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[553620, 12886, 233, 5, 29, "Input",ExpressionUUID->"a0cfa003-1912-489f-ad7b-a7e453ea6bf4"],
Cell[CellGroupData[{
Cell[553878, 12895, 3594, 75, 97, "Print",ExpressionUUID->"815e4945-d1e4-4956-bd1f-3696e46139c5"],
Cell[557475, 12972, 3625, 76, 97, "Print",ExpressionUUID->"b1328b7b-c889-4e7d-95e5-cd61c033dd10"]
}, Open  ]]
}, Open  ]],
Cell[561127, 13052, 258, 6, 35, "Text",ExpressionUUID->"5e31c386-0db1-470d-a98d-1f972eac40b2"],
Cell[CellGroupData[{
Cell[561410, 13062, 378, 10, 29, "Input",ExpressionUUID->"12b8af5b-536f-41bd-8e1b-786e02d89319"],
Cell[561791, 13074, 8698, 211, 261, "Output",ExpressionUUID->"2a77897b-3f82-4a47-b040-1e42ec1d6a78"]
}, Open  ]],
Cell[570504, 13288, 236, 5, 92, "Input",ExpressionUUID->"700deee8-4a14-4212-9a43-4768e144c8ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[570777, 13298, 232, 4, 54, "Subsection",ExpressionUUID->"cc58800c-d2e6-4ba9-9b25-b6294a95bd73"],
Cell[571012, 13304, 385, 7, 58, "Text",ExpressionUUID->"4215a611-3e90-477c-877e-ef3de95f4075"],
Cell[571400, 13313, 269, 6, 29, "Input",ExpressionUUID->"c3a18004-c15c-4882-9a15-d4a66526d514"],
Cell[CellGroupData[{
Cell[571694, 13323, 290, 6, 29, "Input",ExpressionUUID->"84e473cc-fe05-4694-add2-81039a4c09b1"],
Cell[571987, 13331, 1341, 39, 96, "Output",ExpressionUUID->"59a8ba55-411a-4b7d-9918-3c077a8b8dfc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[573365, 13375, 317, 7, 29, "Input",ExpressionUUID->"d9b0051c-355e-498a-a3b4-a25fc0ba7028"],
Cell[573685, 13384, 1323, 38, 78, "Output",ExpressionUUID->"9f1f91fe-220d-4b94-b956-5ea0be7f6d07"]
}, Open  ]],
Cell[575023, 13425, 198, 3, 35, "Text",ExpressionUUID->"cd9efcbc-7127-44e9-bf66-637e75ceccd0"],
Cell[CellGroupData[{
Cell[575246, 13432, 265, 5, 29, "Input",ExpressionUUID->"d2d0c1c5-95b2-4c4f-9875-370b7a6cc999"],
Cell[575514, 13439, 7419, 248, 291, "Output",ExpressionUUID->"9f93d70c-94a8-4f49-8877-4cb341d3b121"]
}, Open  ]],
Cell[582948, 13690, 175, 3, 35, "Text",ExpressionUUID->"49f302f2-913b-4842-8750-773969d3ba28"],
Cell[CellGroupData[{
Cell[583148, 13697, 348, 8, 29, "Input",ExpressionUUID->"7046162f-5c34-4f33-b049-72f249c9ddf7"],
Cell[583499, 13707, 4617, 107, 178, "Output",ExpressionUUID->"ee28edc2-1699-49e9-ad71-2ced76f55311"]
}, Open  ]],
Cell[CellGroupData[{
Cell[588153, 13819, 305, 7, 29, "Input",ExpressionUUID->"ab01a3eb-1140-4d71-a258-e6470f6b185a"],
Cell[588461, 13828, 2587, 75, 96, "Output",ExpressionUUID->"6b8b736d-3a12-4dc6-b9c2-b2fd22f6ca27"]
}, Open  ]],
Cell[591063, 13906, 167, 3, 35, "Text",ExpressionUUID->"8438b83f-e21c-4954-a005-a3955ac218e5"],
Cell[CellGroupData[{
Cell[591255, 13913, 271, 5, 29, "Input",ExpressionUUID->"76a8cad4-567d-4e00-993f-35a5d0844b0c"],
Cell[591529, 13920, 3753, 95, 162, "Output",ExpressionUUID->"c12c409e-3407-4e56-9e3f-54ad9772da7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[595319, 14020, 298, 7, 29, "Input",ExpressionUUID->"49527cc0-2103-469a-8be4-2880e5a5b2ea"],
Cell[595620, 14029, 2565, 74, 96, "Output",ExpressionUUID->"41687950-5624-4d67-8b99-7354c8abe12c"]
}, Open  ]],
Cell[598200, 14106, 254, 6, 35, "Text",ExpressionUUID->"d4155794-b866-4607-b5aa-4ab58e17ac1c"],
Cell[CellGroupData[{
Cell[598479, 14116, 220, 4, 29, "Input",ExpressionUUID->"0e4d7920-d373-4768-841f-acb74d5e6e5c"],
Cell[598702, 14122, 255, 4, 33, "Output",ExpressionUUID->"1f1158e9-e1dd-4a16-9b54-07985cfe10d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[598994, 14131, 192, 4, 29, "Input",ExpressionUUID->"756aa10c-b67a-4af8-9305-bf8a42fe1026"],
Cell[599189, 14137, 225, 4, 33, "Output",ExpressionUUID->"69e8dcf5-4787-487c-afe7-911b0eb66a9e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[599463, 14147, 162, 3, 54, "Subsection",ExpressionUUID->"8d011033-fc73-4a7b-8081-e4bfa35d7494"],
Cell[CellGroupData[{
Cell[599650, 14154, 167, 3, 45, "Subsubsection",ExpressionUUID->"575ad80e-2d28-4e81-9d15-ea00f1ed432b"],
Cell[599820, 14159, 212, 5, 35, "Text",ExpressionUUID->"de31ad5d-2176-4e95-8c2a-31c8ace7fab6"],
Cell[600035, 14166, 298, 7, 35, "Text",ExpressionUUID->"ed459353-329a-4adb-a61a-efe874446503"],
Cell[CellGroupData[{
Cell[600358, 14177, 1089, 28, 71, "Input",ExpressionUUID->"aa94ecc9-3bb6-4cbd-8fdb-2b1d3dddbdd6"],
Cell[601450, 14207, 2345, 61, 187, "Output",ExpressionUUID->"daebc121-1845-408b-bcca-fba7a184d79a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[603832, 14273, 250, 6, 29, "Input",ExpressionUUID->"064025d4-cee5-4626-8b7c-9ff75372c0a2"],
Cell[604085, 14281, 1529, 41, 55, "Output",ExpressionUUID->"88ba7270-8a07-4368-bd1b-ad6d875444b0"]
}, Open  ]],
Cell[605629, 14325, 460, 9, 35, "Text",ExpressionUUID->"3be70b62-5f89-4bb2-a035-879aa031a9b2"],
Cell[606092, 14336, 346, 10, 29, "Input",ExpressionUUID->"d186b386-167a-408c-9273-45c5d48bceb7"],
Cell[CellGroupData[{
Cell[606463, 14350, 583, 15, 29, "Input",ExpressionUUID->"aba55acc-99d1-49ec-9648-dcb20bb26a1f"],
Cell[607049, 14367, 1714, 48, 165, "Output",ExpressionUUID->"2c0a1724-1113-4bbd-8c2f-9b76b1bb4bec"]
}, Open  ]],
Cell[608778, 14418, 174, 3, 35, "Text",ExpressionUUID->"b64bac71-d58e-4457-aa0b-d4173493f27a"],
Cell[CellGroupData[{
Cell[608977, 14425, 559, 14, 29, "Input",ExpressionUUID->"3e4928f1-e74c-4997-ae99-b91f057829f4"],
Cell[609539, 14441, 1598, 40, 62, "Output",ExpressionUUID->"5c37b2e3-8d02-49c8-aa94-f7e4061c8136"]
}, Open  ]],
Cell[611152, 14484, 161, 3, 35, "Text",ExpressionUUID->"8e79a6ca-62ca-4577-8187-3f7709d761bb"],
Cell[CellGroupData[{
Cell[611338, 14491, 491, 12, 29, "Input",ExpressionUUID->"86a951e0-0182-4657-854a-02fd1a65ce8e"],
Cell[611832, 14505, 1568, 40, 62, "Output",ExpressionUUID->"2904261c-521f-4bdb-946e-8a2abe71e486"]
}, Open  ]],
Cell[613415, 14548, 293, 7, 35, "Text",ExpressionUUID->"4fa8cb70-aa0b-4423-a5cb-3834be784981"],
Cell[CellGroupData[{
Cell[613733, 14559, 1096, 27, 51, "Input",ExpressionUUID->"f8baca5e-502e-4c11-be0f-182fee1c2371"],
Cell[614832, 14588, 2172, 58, 187, "Output",ExpressionUUID->"e4371225-a1db-47f4-bc36-a579b1388f6d"]
}, Open  ]],
Cell[617019, 14649, 216, 5, 35, "Text",ExpressionUUID->"27a1ba0c-7cd1-4933-a0d3-8364042149ed"],
Cell[CellGroupData[{
Cell[617260, 14658, 382, 11, 29, "Input",ExpressionUUID->"7272ff38-9939-4647-abb4-65e5ddd15a4d"],
Cell[617645, 14671, 1655, 43, 55, "Output",ExpressionUUID->"b6d95bf6-db0c-40db-a571-b989c4713d40"]
}, Open  ]],
Cell[619315, 14717, 309, 7, 35, "Text",ExpressionUUID->"e869cfbd-8b66-469a-beb0-97945d8dba31"],
Cell[CellGroupData[{
Cell[619649, 14728, 1003, 30, 51, "Input",ExpressionUUID->"ecbbfa69-9af1-4beb-bad3-69344e8b0797"],
Cell[620655, 14760, 754, 15, 33, "Output",ExpressionUUID->"71c8a1e1-3700-4dcc-84e2-d1bfe1fab5a5"]
}, Open  ]],
Cell[621424, 14778, 273, 4, 35, "Text",ExpressionUUID->"75307727-dac0-44e0-a9af-14f0aa52c552"],
Cell[CellGroupData[{
Cell[621722, 14786, 351, 7, 29, "Input",ExpressionUUID->"c086d678-cbc3-4676-8492-8e7293c40975"],
Cell[622076, 14795, 3086, 75, 117, "Output",ExpressionUUID->"f1d69880-833e-4db5-9275-58772bb25511"]
}, Open  ]],
Cell[625177, 14873, 268, 6, 35, "Text",ExpressionUUID->"ef8b5d04-c350-4599-a121-dd7811303486"],
Cell[CellGroupData[{
Cell[625470, 14883, 485, 13, 29, "Input",ExpressionUUID->"ae98d520-70d8-4eca-9c1c-9706a89045db"],
Cell[625958, 14898, 3082, 74, 117, "Output",ExpressionUUID->"0038dc04-8910-4836-9532-bec989e7aaa4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[629077, 14977, 707, 19, 73, "Input",ExpressionUUID->"a80a5322-0872-4999-9a6d-b50d5c49a556"],
Cell[629787, 14998, 1610, 42, 55, "Output",ExpressionUUID->"45496fdb-948c-4835-b3bb-8ba9f75d9d74"]
}, Open  ]],
Cell[631412, 15043, 448, 8, 58, "Text",ExpressionUUID->"9cb98c97-528e-4053-beb9-fb591a3ae840"],
Cell[CellGroupData[{
Cell[631885, 15055, 247, 5, 29, "Input",ExpressionUUID->"7c9a1c39-5b96-4b13-b22c-618983e6132d"],
Cell[632135, 15062, 417, 7, 33, "Output",ExpressionUUID->"c1081017-6b14-4d8e-ad6e-54ab357fe549"]
}, Open  ]],
Cell[CellGroupData[{
Cell[632589, 15074, 576, 12, 29, "Input",ExpressionUUID->"1f2aa35f-604b-4e34-b9c9-7dbac3545fd7"],
Cell[633168, 15088, 3113, 67, 117, "Output",ExpressionUUID->"7f8b7a17-e4cf-4711-b723-1ccee7f6acab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[636318, 15160, 568, 16, 36, "Input",ExpressionUUID->"a39bd374-1d53-4e8c-82e2-339742247f5e"],
Cell[636889, 15178, 1470, 38, 71, "Output",ExpressionUUID->"cf76578c-f860-4e45-8aa5-c96d87a5103b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[638396, 15221, 353, 9, 36, "Input",ExpressionUUID->"a61f32ef-c255-42fb-b536-a6ed73d0bee1"],
Cell[638752, 15232, 2795, 71, 146, "Output",ExpressionUUID->"eedecc6d-d293-4b9e-90fc-baf3db9a6385"]
}, Open  ]],
Cell[CellGroupData[{
Cell[641584, 15308, 701, 19, 61, "Input",ExpressionUUID->"9a23e7ff-0f1e-4902-8f87-476d0189acea"],
Cell[642288, 15329, 1562, 42, 55, "Output",ExpressionUUID->"f21b2c24-8eab-4e1c-92f7-ac0b118e7846"]
}, Open  ]],
Cell[CellGroupData[{
Cell[643887, 15376, 196, 4, 36, "Input",ExpressionUUID->"8555fa6b-bb91-4187-a806-3128febcad85"],
Cell[644086, 15382, 418, 7, 32, "Output",ExpressionUUID->"b32de994-894f-42e6-a0ca-45b716f4ac47"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[644553, 15395, 157, 3, 35, "Subsubsection",ExpressionUUID->"c462e833-79ed-41a6-8732-9ed02f7c4b15"],
Cell[644713, 15400, 292, 7, 32, "Text",ExpressionUUID->"70351768-b685-4b97-b822-82624a34f174"],
Cell[645008, 15409, 280, 7, 34, "Input",ExpressionUUID->"27085002-7394-4856-84b4-bc7ad870077e"],
Cell[645291, 15418, 296, 7, 34, "Input",ExpressionUUID->"01d24fec-d521-4edc-87fd-0ab0420e0b9a"],
Cell[645590, 15427, 216, 4, 31, "Text",ExpressionUUID->"1d4b6cb3-8315-4696-af72-0e56c922b068"],
Cell[CellGroupData[{
Cell[645831, 15435, 596, 17, 36, "Input",ExpressionUUID->"2de4f140-2cfd-42b2-bbcd-f36f5d69cd55"],
Cell[646430, 15454, 602, 10, 32, "Output",ExpressionUUID->"6642aff4-fc09-4943-b7f3-07c692edc085"]
}, Open  ]],
Cell[647047, 15467, 227, 5, 32, "Text",ExpressionUUID->"92415a87-e63a-4d30-bf54-93434ef52d57"],
Cell[647277, 15474, 167, 3, 31, "Text",ExpressionUUID->"201f4869-6e24-44d3-b926-8eb20363b0b4"],
Cell[CellGroupData[{
Cell[647469, 15481, 510, 15, 36, "Input",ExpressionUUID->"2a984b42-3482-423f-8888-fdb4b712808a"],
Cell[647982, 15498, 571, 10, 32, "Output",ExpressionUUID->"a3939c99-dc6f-4a20-97dc-35808f9f94a1"]
}, Open  ]],
Cell[648568, 15511, 173, 3, 31, "Text",ExpressionUUID->"a66b94f8-d8b8-4d8c-b399-26bff8b88754"],
Cell[CellGroupData[{
Cell[648766, 15518, 277, 7, 36, "Input",ExpressionUUID->"fb5a8cf3-da62-4896-a5b5-933cbb7c12f1"],
Cell[649046, 15527, 500, 8, 32, "Output",ExpressionUUID->"c37f358e-4637-40de-9ade-dd5d314cd15d"]
}, Open  ]],
Cell[649561, 15538, 408, 8, 32, "Text",ExpressionUUID->"10a46839-f388-4e96-8ca2-99a6e2990aca"],
Cell[649972, 15548, 857, 19, 34, "Input",ExpressionUUID->"a25d5e24-6998-4270-b330-d1011509405b"],
Cell[650832, 15569, 290, 7, 36, "Input",ExpressionUUID->"7c408f3b-45d2-491a-870e-f0edc33796b5"],
Cell[651125, 15578, 289, 7, 36, "Input",ExpressionUUID->"9f682c7b-2d96-4950-b07d-ad07f9b6921f"],
Cell[651417, 15587, 294, 7, 32, "Text",ExpressionUUID->"bea39aec-b923-4fc9-be65-fb18d12c15ed"],
Cell[651714, 15596, 236, 6, 34, "Input",ExpressionUUID->"b49c0395-eb6b-490d-a9d8-03805f920cfb"],
Cell[CellGroupData[{
Cell[651975, 15606, 1312, 37, 86, "Input",ExpressionUUID->"22d51cee-3e5a-4e61-b569-a9bfd4d69f72"],
Cell[653290, 15645, 1557, 42, 55, "Output",ExpressionUUID->"f567a166-8de1-41a8-a712-f6b25274a27b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[654908, 15694, 199, 3, 44, "Subsection",ExpressionUUID->"a67311d7-3e3d-4f31-b333-bb9b3d09300e"],
Cell[655110, 15699, 440, 8, 52, "Text",ExpressionUUID->"db74e77c-7515-4b23-a2d0-f47482943d7f"],
Cell[CellGroupData[{
Cell[655575, 15711, 328, 7, 36, "Input",ExpressionUUID->"f0c2c8c0-cc94-4142-88d2-268000b30e03"],
Cell[655906, 15720, 7342, 131, 75, "Output",ExpressionUUID->"7594baa0-bec8-45fd-af24-dbd65b0af97b"]
}, Open  ]],
Cell[663263, 15854, 264, 6, 32, "Text",ExpressionUUID->"4439e22c-49f9-46de-93b4-2fa5ba8d2b62"],
Cell[CellGroupData[{
Cell[663552, 15864, 379, 8, 36, "Input",ExpressionUUID->"f4475aa4-2d0a-4da3-84bd-c01dbf6ee6ed"],
Cell[663934, 15874, 2141, 39, 113, "Output",ExpressionUUID->"73b6052d-c163-4b35-aed9-2d845c6f293c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

